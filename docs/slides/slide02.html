<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>データ構造と操作</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/mycourse.css"/>
<link rel="stylesheet" href="./reveal.js/plugin/highlight/zenburn.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">データ構造と操作</h1>
</div>
<div class="talk-subtitle">
    <p>第2講 - R言語で扱うデータとその演算</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  </p>
</div>

</section>

<section>
<section id="slide-orge53e0b3">
<h2 id="orge53e0b3">講義概要</h2>
<ul>
<li>R言語のデータ構造</li>
<li>ベクトル・行列・リストの操作</li>
<li>ベクトルと行列のさまざまな計算</li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-org1bf0c9b">
<h2 id="org1bf0c9b">R言語のデータ構造</h2>
<div class="outline-text-2" id="text-org1bf0c9b">
</div>
</section>
<section id="slide-org93f0c5c">
<h3 id="org93f0c5c">基本的なデータ構造</h3>
<ul>
<li>下記は基本的なもので標準環境で利用できる
<ul>
<li>ベクトル (vector)</li>
<li>行列 (matrix)</li>
<li>リスト (list)</li>
<li>データフレーム (data frame)</li>
<li>配列 (array) (今回は扱わない)</li>

</ul></li>
<li><span style="color:gray;">パッケージなどで拡張することができる</span>
<ul>
<li><span style="color:green;">データフレームの拡張</span> (<code>data.table</code> など)</li>
<li><span style="color:green;">時系列の扱い</span> (<code>zoo,xts</code> など)</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>



</section>
</section>
<section>
<section id="slide-org4d288b0">
<h2 id="org4d288b0">ベクトル</h2>
<div class="outline-text-2" id="text-org4d288b0">
</div>
</section>
<section id="slide-org0815aed">
<h3 id="org0815aed">ベクトルとは</h3>
<ul>
<li>スカラー値(単一の値)の集合</li>
<li>スカラー値として扱われる主なデータ型
<ul>
<li>数値 (実数や複素数)</li>
<li>文字列 (&rsquo;や&ldquo;で囲まれた文字．&rdquo;foo&ldquo;，&rdquo;bar&ldquo;など)</li>
<li>論理値 ( <code>TRUE</code> , <code>FALSE</code> )</li>

</ul></li>
<li>Rオブジェクトの多くはベクトルとして扱われる</li>
<li>スカラーは長さ1のベクトルとして扱われる</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org79d7b96">
<h3 id="org79d7b96">ベクトルの生成と操作</h3>
<ul>
<li>基本的には関数 <code>c()</code> を用いて作成する</li>
<li><p>
数値や文字列の要素からなるベクトルの生成
</p>
<div class="org-src-container">

<pre><code class="R" >(x &lt;- c("Alice","Bob","Cathy","David")) # 文字列のベクトル
(y &lt;- c(1,-2,3,-4,5)) # 数値のベクトル
(z &lt;- c("apple","berry","cat","dog","elephant")) # 文字列のベクトル
## 外側の () は代入した結果の表示．print() と同義
</code></pre>
</div>

<pre class="example">
[1] "Alice" "Bob"   "Cathy" "David"
[1]  1 -2  3 -4  5
[1] "apple"    "berry"    "cat"      "dog"     
[5] "elephant"
</pre></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
ベクトルの長さの取得 (関数 <code>length()</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >length(x) # 最後の要素を参照する場合などに利用できる    
</code></pre>
</div>

<pre class="example">
[1] 4
</pre></li>

<li><p>
ベクトルの要素の取得 (演算子 <code>[]</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >x[3] # xの第3要素 (ベクトルの添え字は1から始まる)
y[c(1,3,4)] # 複数の要素 = c(y[1],y[3],y[4])
</code></pre>
</div>

<pre class="example">
[1] "Cathy"
[1]  1  3 -4
</pre></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
<code>a</code> から <code>b</code> まで
1ずつ変化するベクトル (演算子 <code>:</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >a &lt;- 8; b &lt;- 15 # 変数 a,b に値を代入．複数コマンドは ; で区切る
a:b # a &lt; b の場合は1ずつ増加する系列が作成される
a &lt;- 29.5; b &lt;- 24
a:b # 逆の場合は1ずつ減少する系列が作成される
29.5:24 # 直接数値を書いてもよい
</code></pre>
</div>

<pre class="example">
[1]  8  9 10 11 12 13 14 15
[1] 29.5 28.5 27.5 26.5 25.5 24.5
[1] 29.5 28.5 27.5 26.5 25.5 24.5
</pre></li>

<li><p>
<code>a</code> から <code>b</code> まで
<code>c</code> ずつ変化するベクトル (関数 <code>seq()</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >a &lt;- 1; b &lt;- 16; c &lt;- 2 # 変数 a,b,c に値を代入
seq(a,b,by=c) # 明示する場合は seq(from=a,to=b,by=c)
</code></pre>
</div>

<pre class="example">
[1]  1  3  5  7  9 11 13 15
</pre></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
ベクトルの繰り返し (関数 <code>rep()</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >rep(y,3) # 長さは length(y) * 3
rep(y,times=3) # 単純に繰り返す．上記と同様
rep(y,each=3)  # 各要素を繰り返す
rep(y,length.out=12)  # 繰り返した結果の長さを指定する
</code></pre>
</div>

<pre class="example">
[1]  1 -2  3 -4  5  1 -2  3 -4  5  1 -2  3 -4  5
[1]  1 -2  3 -4  5  1 -2  3 -4  5  1 -2  3 -4  5
[1]  1  1  1 -2 -2 -2  3  3  3 -4 -4 -4  5  5  5
[1]  1 -2  3 -4  5  1 -2  3 -4  5  1 -2
</pre></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
ベクトルの反転 (関数 <code>rev()</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >rev(x)
</code></pre>
</div>

<pre class="example">
[1] "David" "Cathy" "Bob"   "Alice"
</pre></li>

<li><p>
ベクトルの結合 (関数 <code>c()</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >c(x,z) # 同じデータ型のもの単純に結合される
c(x,y) # 異なるデータ型のものは結合できないので自動的に書き換えられる
</code></pre>
</div>

<pre class="example">
[1] "Alice"    "Bob"      "Cathy"    "David"   
[5] "apple"    "berry"    "cat"      "dog"     
[9] "elephant"
[1] "Alice" "Bob"   "Cathy" "David" "1"     "-2"   
[7] "3"     "-4"    "5"
</pre></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org8d1ea06" data-background="#fef4f4">
<h2 id="org8d1ea06">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org6ce4865" data-background="#fef4f4">
<h3 id="org6ce4865">練習問題</h3>
<p>
ベクトルの操作に慣れよう
</p>
<ul>
<li>以下に示すベクトルを作成してみよう
<ul>
<li>1から10までの自然数のベクトル</li>
<li>1以上30以下の奇数を昇順に並べたベクトル</li>
<li>すべての要素が1からなる長さ10のベクトル</li>

</ul></li>
<li>作成したベクトルを操作してみよう
<ul>
<li>ベクトルの長さを求める</li>
<li>3番目の要素を取り出す</li>
<li>最後の要素を取り出す</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-orga86cca6">
<h2 id="orga86cca6">行列</h2>
<div class="outline-text-2" id="text-orga86cca6">
</div>
</section>
<section id="slide-org46ce2c5">
<h3 id="org46ce2c5">行列とは</h3>
<ul>
<li>スカラー値を2次元状(縦横)に並べたもの
<ul>
<li>縦(列)ベクトルを列方向に並べて束ねたもの</li>
<li>横(行)ベクトルを行方向に並べて束ねたもの</li>

</ul></li>
<li>データ型は何でもよいが <b>混在はできない</b></li>
<li>データフレームは行列を拡張したもの</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgdd6bc21">
<h3 id="orgdd6bc21">行列の生成と操作</h3>
<ul>
<li><p>
すべての要素が <code>a</code> である \(m\times n\) 行列の生成 <br />
(関数 <code>matrix()</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >a &lt;- 2; m &lt;- 3; n &lt;- 4 # 変数 a,m,n に値を代入
matrix(a,m,n) # 明示する場合は matrix(data=a, nrow=m, ncol=n)
</code></pre>
</div>

<pre class="example">
     [,1] [,2] [,3] [,4]
[1,]    2    2    2    2
[2,]    2    2    2    2
[3,]    2    2    2    2
</pre></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
長さ \(mn\) のベクトル <code>a</code> を \(m\times n\) 行列に変換 <br />
(関数 <code>matrix()</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >a &lt;- 2:13 # 変数 a に値を代入 (m*n = 12 文字用意)
(A &lt;- matrix(a,m,n)) # 並び順を変えるには matrix(a,m,n,byrow=TRUE)
</code></pre>
</div>

<pre class="example">
     [,1] [,2] [,3] [,4]
[1,]    2    5    8   11
[2,]    3    6    9   12
[3,]    4    7   10   13
</pre></li>
<li><p>
行列のベクトル化 (関数 <code>as.vector()</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >as.vector(A) # matrix の逆変換にあたる
</code></pre>
</div>

<pre class="example">
[1]  2  3  4  5  6  7  8  9 10 11 12 13
</pre></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
長さが等しい複数のベクトルの結合 <br />
(関数 <code>rbind(),cbind()</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >a &lt;- 4:7; b &lt;- 10:7; c &lt;- c(2,4,8,16) # 変数 a,b,c に値を代入
rbind(a,b,c) # 行ベクトルとして結合 (row vector bind)
cbind(a,b,c) # 列ベクトルとして結合 (column vector bind)
</code></pre>
</div>

<pre class="example">
  [,1] [,2] [,3] [,4]
a    4    5    6    7
b   10    9    8    7
c    2    4    8   16
     a  b  c
[1,] 4 10  2
[2,] 5  9  4
[3,] 6  8  8
[4,] 7  7 16
</pre></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
行列のサイズの取得 (関数 <code>dim()</code> とその仲間)
</p>
<div class="org-src-container">

<pre><code class="R" >dim(A) # 長さ2のベクトル (行数,列数) となることに注意
nrow(A) # 行数
ncol(A) # 列数
dim(A)[1] # nrow(A) と同値
dim(A)[2] # ncol(A) と同値
</code></pre>
</div>

<pre class="example">
[1] 3 4
[1] 3
[1] 4
[1] 3
[1] 4
</pre></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
行列の成分の取得 (演算子 <code>[]</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >A[3,4] # (3,4)成分
A[3, ] # 第3行のベクトル
A[ ,4] # 第4列のベクトル
A[c(1,3),] # 1,3行からなる部分行列
A[c(1,3),2:4] # 1,3行と，2,3,4列からなる部分行列
</code></pre>
</div>

<pre class="example">
[1] 13
[1]  4  7 10 13
[1] 11 12 13
     [,1] [,2] [,3] [,4]
[1,]    2    5    8   11
[2,]    4    7   10   13
     [,1] [,2] [,3]
[1,]    5    8   11
[2,]    7   10   13
</pre></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgc4ae816">
<h3 id="orgc4ae816">行列の操作に関する補足</h3>
<ul>
<li>関数 <code>cbind()/rbind()</code> は行数・列数が等しい行列も横・縦に結合できる</li>
<li>行列の高次元版として配列(array)が用意されている</li>
<li>関数 <code>rownames()/colnames()</code> を用いると行と列に名前を付けることができる</li>
<li><span style="color:gray;">これらの機能は講義の中で使いながら説明する</span></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org53c1c18" data-background="#fef4f4">
<h2 id="org53c1c18">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org048e281" data-background="#fef4f4">
<h3 id="org048e281">練習問題</h3>
<p>
行列の操作に慣れよう
</p>
<ul>
<li><p>
以下に示す行列を作成してみよう
</p>
<div>
\begin{equation}
  \begin{pmatrix}
    1  & 2  & 3  \\
    4  & 5  & 6 
  \end{pmatrix}
\end{equation}

</div></li>

<li>行列を操作してみよう
<ul>
<li>2行2列成分を取り出す</li>
<li>転置行列を作成する</li>
<li>行名をつける</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-org829496b">
<h2 id="org829496b">その他のデータ構造</h2>
<div class="outline-text-2" id="text-org829496b">
</div>
</section>
<section id="slide-org6751c00">
<h3 id="org6751c00">リストとは</h3>
<ul>
<li>異なる構造のオブジェクトを1つにまとめたもの
<ul>
<li>リストの各要素は異なるデータ型・サイズであって構わない</li>
<li>複数のデータフレームを扱うときなどに応用可能</li>

</ul></li>
<li>本講義のデータ解析ではほとんど用いない
<ul>
<li>Rの関数の操作ではときどき必要</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org9039243">
<h3 id="org9039243">リストの生成と操作</h3>
<ul>
<li><p>
リストの生成 (関数 <code>list()</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >(L &lt;- list(x,y)) # x,yを要素とするリスト
</code></pre>
</div>

<pre class="example">
[[1]]
[1] "Alice" "Bob"   "Cathy" "David"

[[2]]
[1]  1 -2  3 -4  5
</pre></li>

<li><p>
リストの要素の参照 (演算子 <code>[[]]</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >L[[1]] # リストの第1要素
</code></pre>
</div>

<pre class="example">
[1] "Alice" "Bob"   "Cathy" "David"
</pre></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
リストの各要素に名前を付与 (関数 <code>names()</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >## 方法1 (作成時に名前を付与)
(L1 &lt;- list(first=x, second=y))
</code></pre>
</div>

<pre class="example">
$first
[1] "Alice" "Bob"   "Cathy" "David"

$second
[1]  1 -2  3 -4  5
</pre>


<div class="org-src-container">

<pre><code class="R" >## 方法2 (作成後に名前を変更)
L2 &lt;- list(x,y) 
names(L2) &lt;- c("1st","2nd")
L2 # リストを表示
</code></pre>
</div>

<pre class="example">
$`1st`
[1] "Alice" "Bob"   "Cathy" "David"

$`2nd`
[1]  1 -2  3 -4  5
</pre></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
名前によるリストの要素の取得 (演算子 <code>[[]],$</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >## 方法1 (リストの名前で参照)
L2[["1st"]] 
</code></pre>
</div>

<pre class="example">
[1] "Alice" "Bob"   "Cathy" "David"
</pre>


<div class="org-src-container">

<pre><code class="R" >## 方法2 (記号$を用いる場合は""は不要なことに注意)
L1$first      
</code></pre>
</div>

<pre class="example">
[1] "Alice" "Bob"   "Cathy" "David"
</pre></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org447939d">
<h3 id="org447939d">データフレームとは</h3>
<ul>
<li>長さの等しいベクトルを束ねたリスト</li>
<li>複数の属性を持つ実データに則したデータ構造</li>
<li>各列は異なるデータ型でも良い</li>
<li>データフレームは <b>リスト</b> でもある<br />
リストと同様にして各変数を取得できる</li>
<li>データフレームは <b>行列</b> のように扱える<br />
行列と同様にして各変数を取得できる</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org085eaf4">
<h3 id="org085eaf4">データフレームの生成</h3>
<ul>
<li><p>
データフレームの生成 (関数 <code>data.frame()</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >## 前回の練習問題の例
df &lt;- data.frame(
    literature=c(90,80,70,60),
    math=c(25,50,75,100),
    english=c(65,100,70,40))
row.names(df) &lt;- x # 各行の名前を書き換える
df
</code></pre>
</div>

<pre class="example">
      literature math english
Alice         90   25      65
Bob           80   50     100
Cathy         70   75      70
David         60  100      40
</pre></li>

<li><span style="color:gray;">操作については別の講義で詳細に説明する</span></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-orgb08f9f1">
<h2 id="orgb08f9f1">ベクトルの計算</h2>
<div class="outline-text-2" id="text-orgb08f9f1">
</div>
</section>
<section id="slide-org83fcd76">
<h3 id="org83fcd76">ベクトルの表記</h3>
<ul>
<li><p>
ベクトルは太字で，要素は下付き添字で表す
</p>
<div>
\begin{equation}
  \boldsymbol{a}
  =(a_{1},a_{2},\dotsc,a_{k})
\end{equation}

</div></li>

<li><p>
別の書き方
</p>
<div>
\begin{equation}
  (\boldsymbol{a})_{i}
  =\text{(ベクトル \(\boldsymbol{a}\) の第 \(i\) 成分)}  
\end{equation}

</div></li>

<li><p>
Rの書式 (関数 <code>c()</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >a &lt;- c(a1,a2,...,ak) # k次元ベクトルの作成 (擬似コード)
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgbc521f7">
<h3 id="orgbc521f7">ベクトルの加法</h3>
<ul>
<li><p>
<b>同じ長さのベクトル</b> の和および差 <br />
<span style="color:gray;">数値の和と差のように扱うことができる</span>
</p>
<div>
\begin{equation}
  \boldsymbol{a}\pm\boldsymbol{b}
  =(a_{1}\pm b_{1},a_{2}\pm b_{2},\dotsc,a_{k}\pm b_{k})
\end{equation}

</div>
<div>
\begin{equation}
  (\boldsymbol{a}\pm\boldsymbol{b})_{i}
  =a_{i}\pm b_{i}
\end{equation}

</div></li>

<li><p>
Rの書式 (演算子 <code>+,-</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >a + b # 同じ長さのベクトル a,b の和．同じ長さのベクトルが返る
a - b # ベクトルの差
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org4485c41">
<h3 id="org4485c41">ベクトルの乗法</h3>
<ul>
<li><p>
<b>同じ長さの2つのベクトル</b> の乗法
</p>
<ul>
<li>成分ごとの積 (Hadamard 積; 要素積)</li>
<li>ベクトルの内積</li>

</ul>
<p>
<span style="color:gray;">2種類あることに注意する</span>
</p></li>
<li>データ解析ではどちらも良く用いられる</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org8ae20b8">
<h3 id="org8ae20b8">Hadamard 積</h3>
<ul>
<li><p>
<b>同じ長さのベクトル</b> の成分ごとの積
</p>
<div>
\begin{equation}
  \boldsymbol{a}\circ\boldsymbol{b}
  =(a_{1}b_{1},a_{2}b_{2},\dotsc,a_{k}b_{k})
\end{equation}

</div>
<div>
\begin{equation}
  (\boldsymbol{a}\circ\boldsymbol{b})_{i}
  =a_{i}b_{i}
\end{equation}

</div></li>

<li><p>
Rの書式 (演算子 <code>*,/</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >a * b # ベクトルの成分ごとの積．同じ長さのベクトルが返る
a / b # 成分ごとの商も計算可
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org2696d11">
<h3 id="org2696d11">内積</h3>
<ul>
<li><p>
<b>同じ長さのベクトル</b> の内積
</p>
<div>
\begin{align}
  \boldsymbol{a}\cdot\boldsymbol{b}
  &=a_{1}b_{1}+a_{2}b_{2}+\dotsb+a_{k}b_{k}\\
  &=\sum_{i=1}^{k}a_{i}b_{i}
\end{align}

</div></li>

<li><p>
Rの書式 (演算子 <code>%*%</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >a %*% b # ベクトルの内積．1x1型の行列が返る
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-orgcb6f89d">
<h2 id="orgcb6f89d">行列の計算</h2>
<div class="outline-text-2" id="text-orgcb6f89d">
</div>
</section>
<section id="slide-org49ad033">
<h3 id="org49ad033">行列の表記</h3>
<ul>
<li><p>
行列は大文字で，要素は下付き添字で表す
</p>
<div>
\begin{equation}
  A
  =
  \begin{pmatrix}
    a_{11}&\dots&a_{1n}\\
    \vdots&\ddots&\vdots\\
    a_{m1}&\dots&a_{mn}
  \end{pmatrix}
  % \begin{pmatrix}
  %   a_{11}&a_{12}&\dots&a_{1n}\\
  %   a_{21}&a_{22}&\dots&a_{2n}\\
  %   \vdots&&\ddots&\vdots\\
  %   a_{m1}&a_{m2}&\dots&a_{mn}
  % \end{pmatrix}
\end{equation}

</div></li>

<li><p>
別の書き方
</p>
<div>
\begin{equation}
  (A)_{ij}
  =\text{(行列 \(A\) の \(ij\) 成分)}
\end{equation}

</div></li>

<li><p>
Rの書式 (関数 <code>matrix()</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >A &lt;- matrix(c(a11,a21,...,amn),m,n) # m x n 行列の作成 (擬似コード)
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org88d19f5">
<h3 id="org88d19f5">行列の加法</h3>
<ul>
<li><p>
<b>同じ大きさの行列</b> の和および差 <br />
<span style="color:gray;">ベクトルと同じように記述することができる</span>
</p>
<div>
\begin{equation}
  (A\pm B)_{ij}=a_{ij}\pm b_{ij}
\end{equation}

</div></li>

<li><p>
Rの書式
</p>
<div class="org-src-container">

<pre><code class="R" >A + B # 同じサイズの行列の和．同じサイズの行列が返る
A - B # 行列の差
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org08df816">
<h3 id="org08df816">行列の乗法</h3>
<ul>
<li><p>
2つの行列の乗法
</p>
<ul>
<li><b>同じ大きさの行列</b> の成分ごとの積 (Hadamard 積; 要素積)</li>
<li><b>\(n\times m\) 型行列と \(m\times l\) 型行列</b> の積</li>

</ul>
<p>
<span style="color:gray;">2種類あることに注意する</span>
</p></li>
<li>データ解析ではどちらも良く用いられる</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org5c8e737">
<h3 id="org5c8e737">Hadamard 積</h3>
<ul>
<li><p>
<b>同じ大きさの行列</b> の成分ごとの積
</p>
<div>
\begin{equation}
  (A\circ B)_{ij}=a_{ij}b_{ij}
\end{equation}

</div></li>

<li><p>
Rの書式 (演算子 <code>*,/</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >A * B # 行列の成分ごとの積．同じサイズの行列が返る
A / B # 成分ごとの商も計算可
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgcaf493b">
<h3 id="orgcaf493b">行列の積</h3>
<ul>
<li><p>
<b>\(n\times m\) 型行列 \(A\) と \(m\times l\) 型行列 \(B\)</b> の積
</p>
<div>
\begin{equation}
  (AB)_{ij}=\sum_{k=1}^{m}a_{ik}b_{kj}
  \quad\text{(\(AB\)は\(n\times l\)行列)}
\end{equation}

</div></li>

<li><p>
Rの書式 (演算子 <code>%*%</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >A %*% B # 行列の積．n x l 型行列が返る
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org2e6be15">
<h3 id="org2e6be15">行列式</h3>
<ul>
<li><p>
<b>\(n\) 次正方行列</b> \(A\) の行列式
</p>
<div>
\begin{equation}
  \det(A)\quad (=|A|)
\end{equation}

</div>

<p>
<i><span style="color:orange;">正方行列でなければ定義されないことに注意する</span></i>
</p></li>
<li><p>
Rの書式 (関数 <code>det()</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >det(A) # 行列式 
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orga44f548">
<h3 id="orga44f548">トレース</h3>
<ul>
<li><p>
<b>\(n\) 次正方行列</b> \(A\) のトレース(対角成分の総和)
</p>
<div>
\begin{equation}
  \mathrm{trace}(A)=\sum_{i=1}^{n}a_{ii}
\end{equation}

</div></li>

<li><p>
Rの書式 (関数は用意されていないので以下を利用) 
</p>
<div class="org-src-container">

<pre><code class="R" >sum(diag(A)) # 行列のトレース
</code></pre>
</div>
<ul>
<li>関数 <code>diag()</code> : 行列の対角成分を取り出す <br />
(ベクトルを対角行列にすることもできる)</li>
<li>関数 <code>sum()</code> : ベクトルの総和を計算する</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org66632f4" data-background="#fef4f4">
<h2 id="org66632f4">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org5d60804">
<h3 id="org5d60804">例題</h3>
<ul>
<li><p>
適当な2次正方行列 \(A\) で
Hamilton-Cayley の定理
</p>
<div>
\begin{equation}
  A^2-\mathrm{trace}(A)A+\det(A)E_{2}=O_{2}
\end{equation}

</div>

<p>
の成立を確認せよ<br />
ただし \(E_{2}\) は2次単位行列，\(O_{2}\) は2次正方零行列
</p></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org066671c">
<h3 id="org066671c">解答例</h3>
<div class="org-src-container">

<pre><code class="R" >## 行列を作成 (好きに設定してよい)
(A &lt;- matrix(1:4,2,2) - diag(rep(3,2)))
## 左辺を計算 (丸め誤差の範囲で0になる)
A %*% A - sum(diag(A)) * A + det(A) * diag(rep(1,2))
</code></pre>
</div>

<pre class="example">
     [,1] [,2]
[1,]   -2    3
[2,]    2    1
             [,1]         [,2]
[1,] 1.776357e-15 0.000000e+00
[2,] 0.000000e+00 1.776357e-15
</pre>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org63637e6" data-background="#fef4f4">
<h3 id="org63637e6">練習問題</h3>
<ul>
<li>1から10の2乗値からなるベクトルを作成せよ</li>
<li>1から10までの和を計算せよ</li>
<li>行列を用いて九九の表を作成せよ</li>
<li><p>
30度の回転行列を2回乗ずると60度の回転行列となることを確認せよ
</p>
<div>
\begin{equation}
  \text{(回転行列)}
  =
  \begin{pmatrix}
    \cos(\theta)&-\sin(\theta)\\
    \sin(\theta)& \cos(\theta)
  \end{pmatrix}
\end{equation}

</div></li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-org37c2a98">
<h2 id="org37c2a98">ベクトルと行列の計算</h2>
<div class="outline-text-2" id="text-org37c2a98">
</div>
</section>
<section id="slide-org6c83182">
<h3 id="org6c83182">ベクトルと行列の乗法</h3>
<ul>
<li>列(縦)ベクトル・行(横)ベクトルという <b>区別はない</b></li>
<li>行列とベクトルの順序で適切に判断される</li>
<li><p>
計算結果は <b>行列</b> で表現される (演算子 <code>%*%</code>)
</p>
<div class="org-src-container">

<pre><code class="R" >A &lt;- matrix(1:4,2,2); b &lt;- c(5,6) # 行列とベクトルを作成
A %*% b # 行列 x ベクトル = 列ベクトル
</code></pre>
</div>

<pre class="example">
     [,1]
[1,]   23
[2,]   34
</pre>


<div class="org-src-container">

<pre><code class="R" >b %*% A # ベクトル x 行列 = 行ベクトル
</code></pre>
</div>

<pre class="example">
     [,1] [,2]
[1,]   17   39
</pre></li>

</ul>
<div class="slide-footer"><br></div>


</section>
<section id="slide-org69ae012">
<h3 id="org69ae012">連立1次方程式の解法</h3>
<ul>
<li><p>
連立1次方程式
</p>
<ul>
<li>\(A\) : \(n\) 次正則行列</li>
<li>\(\boldsymbol{b},\boldsymbol{x}\) : \(n\) 次元列ベクトル</li>

</ul>
<div>
\begin{align}
  A\boldsymbol{x}&=\boldsymbol{b}
  &&\text{(連立1次方程式)}\\
  \boldsymbol{x}&=A^{-1}\boldsymbol{b}
  &&\text{(\(A\)が正則な場合)}
\end{align}

</div></li>

<li><p>
解を求めるには関数 <code>solve()</code> を利用する
</p>
<div class="org-src-container">

<pre><code class="R" >x &lt;- solve(A, b) 
</code></pre>
</div></li>
<li>ベクトル \(\boldsymbol{b}\) の代わりに行列も扱える</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgf6f1c0b">
<h3 id="orgf6f1c0b">逆行列</h3>
<ul>
<li><p>
正則な \(n\) 次正方行列 \(A\) の逆行列 \(A^{-1}\)
</p>
<div>
\begin{equation}
  AA^{-1}=A^{-1}A=E_{n}
  \quad\text{(\(E_{n}\)は\(n\)次単位行列)}
\end{equation}

</div></li>

<li><p>
関数 <code>solve()</code> を利用して求めることができる
</p>
<div>
\begin{align}
  AX&=E_{n}\\
  X&=A^{-1}E_{n}=A^{-1}
\end{align}

</div>

<div class="org-src-container">

<pre><code class="R" >solve(A,B) # AX=B の解Xを求める
solve(A) # 逆行列 (Bが単位行列の場合省略できる)
</code></pre>
</div></li>
<li><span style="color:gray;">他にもいくつか方法は用意されている</span></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org255a612">
<h3 id="org255a612">関数の適用</h3>
<ul>
<li>ベクトルや行列に関数( \(\sin,\exp,\dots\) など)を適用すると
成分ごとに計算した結果が返される</li>
<li><p>
<span style="color:green;">ベクトル \(\boldsymbol{a}\) ，行列 \(A\) に関数 \(\sin\) を適用する</span>
</p>
<div>
\begin{equation}
  (\sin(\boldsymbol{a}))_{i}=\sin(a_{i})
\end{equation}

</div>

<div class="org-src-container">

<pre><code class="R" >sin(a) # 成分ごとに計算される．sin(a)[i]=sin(a[i])
</code></pre>
</div>
<div>
\begin{equation}
  (\sin(A))_{ij}=\sin(a_{ij})
\end{equation}

</div>

<div class="org-src-container">

<pre><code class="R" >sin(A) # 成分ごとに計算される．sin(A)[i,j]=sin(A[i,j])
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org9b73f2c" data-background="#fef4f4">
<h2 id="org9b73f2c">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org02b80a1">
<h3 id="org02b80a1">例題</h3>
<ul>
<li><p>
適当な3次正方行列 \(A\) と3次元ベクトル \(\boldsymbol{b}\) を作成して
\(\boldsymbol{x}\) に関する以下の連立1次方程式を解きなさい
</p>
<div>
\begin{equation}
  A\boldsymbol{x}=\boldsymbol{b}
\end{equation}

</div></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgda43660">
<h3 id="orgda43660">解答例</h3>
<div class="org-src-container">

<pre><code class="R" >(A &lt;- matrix(rnorm(9),3,3)+diag(rep(1,3))) # 行列とベクトルを作成
## rnorm(9) は正規乱数を9つ作成する(後の講義で詳しく説明)
(b &lt;- 1:3)
</code></pre>
</div>

<pre class="example">
            [,1]        [,2]      [,3]
[1,] -0.06390994 -0.63080373 0.1000254
[2,]  1.44739182  0.52585551 0.1706085
[3,] -1.67386855 -0.02252665 0.9849165
[1] 1 2 3
</pre>


<div class="org-src-container">

<pre><code class="R" >(x &lt;- solve(A,b)) # 解を計算
A %*% x # 結果の確認(b になるはず)
</code></pre>
</div>

<pre class="example">
[1]  1.1311898 -0.9153751  4.9474679
     [,1]
[1,]    1
[2,]    2
[3,]    3
</pre>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgf491c8d" data-background="#fef4f4">
<h3 id="orgf491c8d">練習問題</h3>
<ul>
<li>1から10の2乗値からなるベクトルを作成せよ</li>
<li><p>
例題の \(A\) と \(\boldsymbol{b}\) を用いて
</p>
<div class="org-src-container">

<pre><code class="R" >A %*% b + b %*% A   
</code></pre>
</div>
<p>
を計算するとエラーになるが，何故そうなるか理由を考えよ
</p></li>
<li>2次元ベクトルを回転行列で変換しても長さが変わらないことを確かめよ</li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-orgfbe11c3">
<h2 id="orgfbe11c3">次回の予定</h2>
<ul>
<li>R言語における関数</li>
<li>引数の扱い方 (引数名・順序・既定値)</li>
<li>自作関数の定義</li>
<li>制御構造 (条件分岐・繰り返し)</li>

</ul>
<div class="slide-footer"><br></div>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/highlight/highlight.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,
overview: true,

transition: 'fade',
transitionSpeed: 'default',
spotlight: { size: 90, initialPresentationMode: false }, chalkboard: { toggleChalkboardButton: { left: '80px' }, toggleNotesButton: { left: '130px'}}, keyboard: { 69: function() { RevealChalkboard.toggleNotesCanvas() }, 87: function() { RevealChalkboard.toggleChalkboard() }, 67: function() { RevealChalkboard.clear() }, 82: function() { RevealChalkboard.reset() }, 68: function() { RevealChalkboard.download() }, 88: function() { RevealChalkboard.colorNext() }, 89: function() { RevealChalkboard.colorPrev() }, 84: function() { RevealSpotlight.toggleSpotlight() }, 81: function() { RevealSpotlight.togglePresentationMode()}},

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealHighlight ],

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/menu/menu.js'},
{ src: './reveal.js/plugin/chalkboard/chalkboard.js'},
{ src: './reveal.js/plugin/spotlight/spotlight.js'}]

});
</script>
</body>
</html>
