<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>記述統計量</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/menu/menu.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/menu/font-awesome/css/fontawesome.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/chalkboard/style.css"/>

<link rel="stylesheet" href="./reveal.js/local/mycourse.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">記述統計量</h1>
</div>
<div class="talk-subtitle">
    <p>第9講 - 基礎的な記述統計量とデータの集約</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  </p>
</div>

</section>
<section>
<section id="slide-org390da12">
<h2 id="org390da12">講義概要</h2>
<ul>
<li>基本的な記述統計量</li>
<li>&ldquo;モーメント&rdquo;に基づく記述統計量
<ul>
<li>歪度と尖度</li>
<li>相関と共分散</li>

</ul></li>
<li>&ldquo;順序&rdquo;に基づく統計量</li>
<li>&ldquo;頻度&rdquo;に基づく統計量</li>

</ul>
</section>
</section>
<section>
<section id="slide-org3940aa1">
<h2 id="org3940aa1">基礎的な記述統計量</h2>
<div class="outline-text-2" id="text-org3940aa1">
</div>
</section>
<section id="slide-orgdb3d490">
<h3 id="orgdb3d490">記述統計量とは</h3>
<ul>
<li><b>記述統計量</b> : (または要約統計量・基本統計量)
<ul>
<li>データを簡潔に要約して表すための統計値</li>
<li>その集団全体の特徴を表す重要な指標</li>
<li>ヒストグラム・密度関数・箱ひげ図などのグラフと併用</li>

</ul></li>
<li>比較的良く用いられる統計量を以下の観点で分類
<ul>
<li>モーメント</li>
<li>順序</li>
<li>頻度</li>

</ul></li>

</ul>
</section>
<section id="slide-org7ae29f8">
<h3 id="org7ae29f8">記述統計量の推定</h3>
<ul>
<li>記述統計量は背後の確率分布(集団全体)で決まる量</li>
<li>一般に確率分布は未知</li>
<li>手に入るのは(少数の)サンプル(観測データ) <br />
(観測データを \(X_1,X_2,\dots,X_n\) で表す)</li>
<li><b>推定</b> = 観測データから知りたい量を計算する方法</li>
<li>真の値と観測データによる推定値には差 <b>(誤差)</b> がある</li>

</ul>
</section>
<section id="slide-orgc6334fe">
<h3 id="orgc6334fe">独立同分布性</h3>
<ul>
<li>統計解析における重要な仮定とその帰結
<ul>
<li>確率変数 \(X_{1},X_{2},\dotsc,X_{n}\) が <b>同分布</b> <br />
共通の平均 \(\mu\) および分散 \(\sigma^2\) を考えることができる <br />
(適切な次数のモーメントの存在を仮定)</li>
<li>確率変数 \(X_{1},X_{2},\dotsc,X_{n}\) が <b>独立同分布</b> <br />
標本平均はサンプル数 \(n\to\infty\) のとき確率1で真の平均に収束 
(<b>大数の強法則</b>)</li>

</ul></li>
<li>データは <b>偏っていない</b> ことを仮定している</li>

</ul>
</section>
<section id="slide-orgf3e764e">
<h3 id="orgf3e764e">推定量の一致性</h3>
<ul>
<li>サンプル数が大きい場合に &ldquo;合理的な&rdquo; 推定量となる根拠の1つ</li>
<li><p>
<b>(強)一致性</b> (consistency) 
</p>
<blockquote>
<p>
推定量がサンプル数
\(n\to\infty\) のとき確率1で真の値に収束する性質
</p>
<div>
\begin{equation}
  P\left(|\hat\theta-\theta|<\varepsilon\right)
  \to1\quad
  (\forall\varepsilon,\;
  n\to\infty)
\end{equation}

</div>
</blockquote></li>
<li><b>(強)一致推定量</b> : 一致性をもつ推定量</li>

</ul>
</section>
<section id="slide-org1715e71">
<h3 id="org1715e71">推定量の不偏性</h3>
<ul>
<li>サンプル数が小さい場合の推定量の &ldquo;良さ&rdquo; に関する性質の1つ</li>
<li><p>
<b>不偏性</b> (unbiasedness) 
</p>
<blockquote>
<p>
推定量 \(\hat{\theta}\)
が不偏であるとは,
\(\hat{\theta}\)
の平均が真の値 \(\theta\) となる性質
</p>
<div>
\begin{equation}
  \mathbb{E}[\hat{\theta}]=\theta
\end{equation}

</div>
</blockquote></li>
<li><b>不偏推定量</b> : 不偏性をもつ推定量</li>

</ul>
</section>
</section>
<section>
<section id="slide-org7adc004">
<h2 id="org7adc004">&ldquo;モーメント&rdquo;に基づく記述統計量</h2>
<div class="outline-text-2" id="text-org7adc004">
</div>
</section>
<section id="slide-org426884c">
<h3 id="org426884c">平均</h3>
<ul>
<li><p>
<b>平均</b> (mean)
</p>
<blockquote>
<div>
\begin{equation}
  \mu=\mathbb{E}[X]
\end{equation}

</div>
</blockquote>
<ul>
<li>データの代表値を表す記述統計量</li>

</ul></li>
<li><p>
<b>標本平均</b> (sample mean)
</p>
<blockquote>
<div>
\begin{equation}
  \bar{X}
  =\frac{1}{n}\sum_{i=1}^{n}X_{i}
  =\frac{X_{1}+\dotsb+X_{n}}{n}
  % =\frac{X_1+X_2+\cdots+X_n}{n}
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-orga8ec0b1">
<h3 id="orga8ec0b1">分散・標準偏差</h3>
<ul>
<li><p>
<b>分散</b> (variance)
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{Var}(X)=\sigma^{2}=\mathbb{E}[(X-\mu)^{2}]
\end{equation}

</div>
</blockquote>
<ul>
<li>データのばらつきを表す記述統計量</li>

</ul></li>
<li><p>
<b>標本分散</b> (sample variance)
</p>
<blockquote>
<div>
\begin{equation}
  S^{2}
  =\frac{1}{n}\sum_{i=1}^n(X_{i}-\bar{X})^{2}
  =\frac{(X_{1}-\bar{X})^{2}+\dotsb+(X_{n}-\bar{X})^{2}}{n}
  % =\frac{(X_1-\bar{X})^2+(X_2-\bar{X})^2+\cdots+(X_n-\bar{X})^2}{n}
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-orgac431c2">
<h3 id="orgac431c2">標本平均・分散の不偏性</h3>
<ul>
<li><p>
標本平均は \(\mu\) の <b>不偏推定量である</b>
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}[\bar{X}]=\mu
\end{equation}

</div>
</blockquote></li>
<li><p>
標本分散は \(\sigma^2\) の <b>不偏推定量ではない</b>
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}[S^2]=\frac{n-1}{n}\sigma^2
\end{equation}

</div>
</blockquote>
<ul>
<li>標本分散は平均的には真の分散を <b>過小推定</b> する</li>

</ul></li>

</ul>
</section>
<section id="slide-orgdee78fb">
<h3 id="orgdee78fb">不偏分散</h3>
<ul>
<li>不偏性を担保した分散の推定量</li>
<li><p>
バイアス補正 :
標本分散に \(n/(n-1)\) を乗じたもの
</p>
<blockquote>
<div>
\begin{equation}
  s^2=\frac{n}{n-1}S^2=\frac{1}{n-1}\sum_{i=1}^n(X_i-\bar{X})^2
\end{equation}

</div>
</blockquote>
<ul>
<li>\(\sigma^2\) の <b>不偏推定量</b> となる</li>

</ul></li>

</ul>
</section>
<section id="slide-org3a3dad1">
<h3 id="org3a3dad1">標本標準偏差</h3>
<ul>
<li><b>標本標準偏差</b> (sample standard deviation) : <br />
通常は不偏分散の平方根 \(s\) を指す</li>
<li>一般に \(s\) は標準偏差 \(\sigma\) の <b>不偏推定量ではない</b></li>

</ul>
</section>
<section id="slide-orga93090a">
<h3 id="orga93090a">R : 平均・分散・標準偏差の計算</h3>
<ul>
<li><p>
基本的な使い方
</p>
<div class="org-src-container">

<pre class="src src-R">mean(x, trim = 0, na.rm = <span style="color: #00aa80;">FALSE</span>) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#27161;&#26412;&#24179;&#22343;</span>
var(x, na.rm = <span style="color: #00aa80;">FALSE</span>) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#19981;&#20559;&#20998;&#25955;</span>
sd(x, na.rm = <span style="color: #00aa80;">FALSE</span>) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#27161;&#26412;&#27161;&#28310;&#20559;&#24046;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> x: &#12505;&#12463;&#12488;&#12523;&#65292;&#12487;&#12540;&#12479;&#12501;&#12524;&#12540;&#12512;&#12394;&#12393;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> na.rm: &#27424;&#25613;&#20516;&#12434;&#21462;&#12426;&#38500;&#12367;&#12363;&#21542;&#12363;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> &#35336;&#31639;&#26041;&#27861;&#12395;&#12388;&#12356;&#12390;&#12399; help("mean"), help("var"), help("sd") &#12434;&#21442;&#29031;</span>
</pre>
</div></li>

</ul>
</section>
<section id="slide-org99039e0">
<h3 id="org99039e0">標準化</h3>
<ul>
<li>多次元データの分析のために単位や基準を揃える</li>
<li><p>
データ \(X_{1},X_{2},\dotsc,X_{n}\) の <b>標準化</b>
</p>
<blockquote>
<div>
\begin{equation}
  Z_{i}=\frac{X_i-\bar{X}}{s}\quad(i=1,2,\dotsc,n)
\end{equation}

</div>
</blockquote>
<ul>
<li>\(s\) の代わりに \(S\) で割って定義する文献もある</li>

</ul></li>
<li>定義から \(Z_{1},Z_{2},\dotsc,Z_{n}\) の
標本平均は0, 不偏分散は1 に <b>規格化</b> される</li>
<li>\(Z_{i}\) : <b>標準得点</b> あるいは <b>Zスコア</b></li>

</ul>
</section>
<section id="slide-org32a246e">
<h3 id="org32a246e">偏差値</h3>
<ul>
<li>別の基準での標準化
<ul>
<li>教育学や心理学では, 平均50, 標準偏差10が好まれる</li>

</ul></li>
<li><p>
標本平均50, 標準偏差10に線形変換
</p>
<blockquote>
<div>
\begin{equation}
  T_{i}=10Z_{i}+50\quad(i=1,\dotsc,n)
\end{equation}

</div>
</blockquote></li>
<li>\(T_{i}\) :
<b>偏差値得点</b> あるいは <b>Tスコア</b></li>

</ul>
</section>
<section id="slide-orgdbd8b26">
<h3 id="orgdbd8b26">R : 標準化の計算</h3>
<ul>
<li><p>
基本的な使い方
</p>
<div class="org-src-container">

<pre class="src src-R">scale(x, center = <span style="color: #00aa80;">TRUE</span>, scale = <span style="color: #00aa80;">TRUE</span>) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#27161;&#28310;&#21270;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> x: &#12505;&#12463;&#12488;&#12523;&#65292;&#12487;&#12540;&#12479;&#12501;&#12524;&#12540;&#12512;&#12394;&#12393;&#65294;&#12487;&#12540;&#12479;&#12501;&#12524;&#12540;&#12512;&#12398;&#22580;&#21512;&#12399;&#21015;&#12372;&#12392;&#12395;&#27161;&#28310;&#21270;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> center: &#20013;&#24515;&#21270;(&#24179;&#22343;0)&#12377;&#12427; (TRUE) &#12363;&#21542; (FALSE) &#12363;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> scale: &#27491;&#35215;&#21270;(&#20998;&#25955;1)&#12377;&#12427; (TRUE) &#12363;&#21542; (FALSE) &#12363;</span>
10 * scale(x) + 50 <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#20559;&#24046;&#20516;&#24471;&#28857;&#12408;&#12398;&#22793;&#25563;</span>
</pre>
</div></li>

</ul>
</section>
</section>
<section>
<section id="slide-orgf5a3be1" data-background="#fef4f4">
<h2 id="orgf5a3be1">実習</h2>
</section>
<section id="slide-org83da0d9" data-background="#fef4f4">
<h3 id="org83da0d9">練習問題</h3>
<ul>
<li><p>
東京の気候データ (<code>tokyo_weather.csv</code>) の中の
</p>
<blockquote>
<p>
気温 (<code>temp</code>) ，
日射量 (<code>solar</code>) ，
風速 (<code>wind</code>) 
</p>
</blockquote>
<p>
の項目について以下の問に答えよ．
</p>

<ul>
<li>全てのデータを用いて各項目の平均・分散・標準偏差を求めよ．(データ数365)</li>
<li>毎月5日のデータのみを用いて各項目の平均・分散・標準偏差を求めよ．(データ数12)</li>
<li>5の付く日(各月の5,15,25)のデータを用いて各項目の平均・分散・標準偏差を求めよ．(データ数36)</li>
<li>ランダムに選んだ36日分のデータで各項目の平均・分散・標準偏差を求めたとき，
推定量のばらつきを確認せよ．</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-orgf7f6fb7">
<h2 id="orgf7f6fb7">歪度と尖度</h2>
<div class="outline-text-2" id="text-orgf7f6fb7">
</div>
</section>
<section id="slide-org52fa4a1">
<h3 id="org52fa4a1">歪度と尖度</h3>
<ul>
<li>正規分布からのずれを調べるための統計量</li>
<li>正規分布の特徴 
<ul>
<li>確率分布のうち最も基本的なもの <b>(中心極限定理)</b></li>
<li>平均と分散を決めると完全に決定される</li>

</ul></li>
<li>正規分布に従うデータでは標本平均と標本分散(不偏分散)を考えれば十分</li>
<li>現実には正規分布では捉えきれない特徴をもつデータも多い</li>

</ul>
</section>
<section id="slide-org7c5bd47">
<h3 id="org7c5bd47">歪度</h3>
<ul>
<li>分布の非対称性を表す統計量</li>
<li><p>
<b>歪度</b> (skewness)
</p>
<blockquote>
<p>
平均 \(\mu\) , 分散 \(\sigma^2\) で
3次モーメントをもつ確率変数 \(X\) 
</p>
<div>
\begin{equation}
  \mathrm{skewness}=\frac{\mathbb{E}[(X-\mu)^3]}{\sigma^3}
\end{equation}

</div>
</blockquote></li>
<li>左右に対称的な分布の歪度は0 (正規分布の歪度は0)
<ul>
<li>歪度が正の場合 : 分布の右の裾の方が重い</li>
<li>歪度が負の場合 : 分布の左の裾の方が重い</li>

</ul></li>
<li><span style="color:green;">正の歪度をもつ分布の例</span>
<ul>
<li>ガンマ分布 \(\Gamma(\nu,\alpha)\) の歪度は \(2/\sqrt{\nu}\)</li>

</ul></li>

</ul>
</section>
<section id="slide-org6495a07">
<h3 id="org6495a07">尖度</h3>
<ul>
<li>平均の周囲の分布の尖り具合を表す統計量</li>
<li><p>
<b>尖度</b> (kurtosis)
</p>
<blockquote>
<p>
4次のモーメントをもつ確率変数 \(X\)
</p>
<div>
\begin{equation}
  \mathrm{kurtosis}=\frac{\mathbb{E}[(X-\mu)^4]}{\sigma^4}
\end{equation}

</div>
</blockquote></li>
<li><p>
<b>超過尖度</b> (excess kurtosis) :
</p>
<blockquote>
<div>
\begin{equation}
  % \mathrm{excess\ kurtosis}=\frac{\mathbb{E}[(X-\mu)^4]}{\sigma^4}-3
  \mathrm{excess\ kurtosis}
  =
  \mathrm{kurtosis}-3
\end{equation}

</div>
</blockquote>
<ul>
<li>正規分布との比較のため正規分布の尖度3を引いた量</li>
<li>こちらを単に尖度と呼ぶ文献もあるので注意</li>

</ul></li>

</ul>
</section>
<section id="slide-org1121bf5">
<h3 id="org1121bf5">超過尖度</h3>
<ul>
<li>正規分布と比較して
<ul>
<li>超過尖度が正の場合 : 平均の周囲の分布の形状が尖っている</li>
<li><p>
超過尖度が負の場合 : 分布の形状は丸みを帯びている
</p>
<blockquote>
<p>
正の場合，正規分布に比べて平均まわりの密度が
分布の裾の方にまわっていることが多いため,
正規分布より裾が重いと解釈されることが多い
</p>
</blockquote></li>

</ul></li>
<li><span style="color:green;">正の超過尖度をもつ分布の例</span>
<ul>
<li>自由度 \(\nu>4\) をもつ \(t\)-分布 \(t(\nu)\) の超過尖度は \(6/(\nu-4)\) <br />
(\(\nu\leq 4\) のときは \(t(\nu)\) は4次モーメントをもたない)</li>
<li>ガンマ分布 \(\Gamma(\nu,\alpha)\) の超過尖度は \(6/\nu\)</li>

</ul></li>

</ul>

</section>
<section>
<div class="leftcol" id="org3382cdc">

<div id="orgbf2c3f5" class="figure">
<p><img src="figs/sk_tdist.png" alt="sk_tdist.png" width="100%" />
</p>
</div>

</div>
<div class="rightcol" id="org47677c1">

<div id="org5a843c5" class="figure">
<p><img src="figs/sk_gamma.png" alt="sk_gamma.png" width="100%" />
</p>
</div>

</div>
</section>
<section id="slide-orgb8d6bfd">
<h3 id="orgb8d6bfd">標本歪度と標本尖度</h3>
<ul>
<li>観測データ \(X_{1},X_{2},\dotsc,X_{n}\) による推定</li>
<li><p>
<b>標本歪度</b> (sample skewness)
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{skewness}=\frac{\frac{1}{n}\sum_{i=1}^n(X_i-\bar{X})^3}{s^3}
\end{equation}

</div>
</blockquote></li>
<li><p>
<b>標本尖度</b> (sample kurtosis)
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{kurtosis}=\frac{\frac{1}{n}\sum_{i=1}^n(X_i-\bar{X})^4}{s^4}
\end{equation}

</div>
</blockquote>
<ul>
<li>分子の計算は \(1/n\) としているが，別の場合もあるので注意</li>

</ul></li>

</ul>
</section>
<section id="slide-org085cb25">
<h3 id="org085cb25">R : 歪度と尖度の計算</h3>
<ul>
<li><p>
歪度・尖度を計算する関数はRの標準機能にはないので
<code>package::e1071</code> を利用 (自作してもよい)
</p>
<blockquote>
<p>
標本歪度・標本尖度の値は標本平均・分散に比べて
<b>ばらつきが大きい</b> ので，
サンプル数が少ない場合の計算結果の解釈には注意が必要
</p>
</blockquote></li>
<li><p>
基本的な使い方
</p>
<div class="org-src-container">

<pre class="src src-R"><span style="color: #60aa00;">library</span>(<span style="color: #d08928;">"e1071"</span>) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">package::e1071 &#12398;&#35501;&#12415;&#36796;&#12415;&#65294;&#24517;&#35201;&#12394;&#12425; install &#12377;&#12427;</span>
skewness(x, na.rm = <span style="color: #00aa80;">FALSE</span>, type = 3) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#27161;&#26412;&#27498;&#24230;</span>
kurtosis(x, na.rm = <span style="color: #00aa80;">FALSE</span>, type = 3) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#27161;&#26412;&#36229;&#36942;&#23574;&#24230; (&#23574;&#24230;&#12391;&#12399;&#12394;&#12356;)</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> x: &#12505;&#12463;&#12488;&#12523;&#65292;&#12487;&#12540;&#12479;&#12501;&#12524;&#12540;&#12512;&#12394;&#12393;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> na.rm: &#27424;&#25613;&#20516;&#12434;&#21462;&#12426;&#38500;&#12367;&#12363;&#21542;&#12363;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> type: &#35336;&#31639;&#27861;&#12398;&#25351;&#23450;(&#36890;&#24120;&#12399;&#26082;&#23450;&#20516;&#12391;&#12424;&#12356;)</span>
</pre>
</div></li>

</ul>
</section>
</section>
<section>
<section id="slide-orga12ec89" data-background="#fef4f4">
<h2 id="orga12ec89">実習</h2>
</section>
<section id="slide-org589b2e1" data-background="#fef4f4">
<h3 id="org589b2e1">練習問題</h3>
<ul>
<li><p>
東京の気候データ (<code>tokyo_weather.csv</code>) の中の
</p>
<blockquote>
<p>
気温 (<code>temp</code>) ，
日射量 (<code>solar</code>) ，
風速 (<code>wind</code>) 
</p>
</blockquote>
<p>
の項目について以下の問に答えよ．
</p>
<ul>
<li>全てのデータを用いて各項目の歪度と超過尖度を求めよ．(データ数365)</li>
<li>5のつく日のデータのみを用いて各項目の歪度と超過尖度を求めよ．(データ数36)</li>
<li>それぞれの値から正規分布から逸脱していると思われる項目はいずれか考察せよ．</li>
<li>各データのヒストグラムを描き，データから計算される平均と分散を持つ正規分布と比較せよ．</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-org8589789">
<h2 id="org8589789">相関と共分散</h2>
<div class="outline-text-2" id="text-org8589789">
</div>
</section>
<section id="slide-org122416c">
<h3 id="org122416c">共分散</h3>
<ul>
<li>複数のデータ間の関係を知るための記述統計量</li>
<li><p>
<b>共分散</b> (covariance) 
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{Cov}(X,Y)=\mathbb{E}[(X-\mathbb{E}[X])(Y-\mathbb{E}[Y])]
\end{equation}

</div>
</blockquote></li>
<li>直感的には2種類のデータ間の比例関係の大きさ</li>

</ul>
</section>
<section id="slide-orgc83b925">
<h3 id="orgc83b925">標本共分散</h3>
<ul>
<li>観測データ \(X_1,X_2,\dots,X_n\) および \(Y_1,Y_2,\dots,Y_n\) による推定</li>
<li><p>
<b>標本共分散</b> (sample covariance)
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{Cov}(X,Y)=\frac{\sum_{i=1}^n(X_i-\bar{X})(Y_i-\bar{Y})}{n-1}
\end{equation}

</div>
</blockquote>
<ul>
<li>ただし\(\bar{X},\bar{Y}\)は
\(X_1,X_2,\dotsc,X_N\) および \(Y_1,Y_2,\dotsc,Y_N\) の平均</li>

</ul></li>

</ul>
</section>
<section id="slide-org4f37126">
<h3 id="org4f37126">相関</h3>
<ul>
<li>複数のデータ間の正規化した記述統計量</li>
<li><p>
<b>相関</b> (correlation) 
</p>
<blockquote>
<div>
\begin{equation}
  \rho=\frac{\mathrm{Cov}(X,Y)}{\sqrt{\mathrm{Var}(X)\mathrm{Var}(Y)}}
\end{equation}

</div>
</blockquote></li>
<li>相関の値は \(-1\) 以上 \(1\) 以下
<ul>
<li>\(1\) に近いほど正の比例関係が強い</li>
<li>\(-1\) に近いほど負の比例関係が強い</li>

</ul></li>

</ul>
</section>
<section id="slide-org1031222">
<h3 id="org1031222">標本相関</h3>
<ul>
<li>観測データ \(X_1,X_2,\dots,X_n\) および \(Y_1,Y_2,\dots,Y_n\) による推定</li>
<li><p>
<b>標本相関</b> (sample correlation)
</p>
<blockquote>
<div>
\begin{equation}
  \rho=\frac{\sum_{i=1}^n(X_i-\bar{X})(Y_i-\bar{Y})}
  {\sqrt{\sum_{i=1}^n(X_i-\bar{X})^2}\sqrt{\sum_{i=1}^n(Y_i-\bar{Y})^2}}
\end{equation}

</div>
</blockquote>
<ul>
<li>ただし\(\bar{X},\bar{Y}\)は
\(X_1,X_2,\dotsc,X_N\) および \(Y_1,Y_2,\dotsc,Y_N\) の平均</li>

</ul></li>

</ul>
</section>
<section id="slide-org1055a67">
<h3 id="org1055a67">R : 相関と共分散の計算</h3>
<ul>
<li><p>
基本的な使い方
</p>
<div class="org-src-container">

<pre class="src src-R">cov(x, y = <span style="color: #00aa80;">NULL</span>, use = <span style="color: #d08928;">"everything"</span>, 
    method = c(<span style="color: #d08928;">"pearson"</span>, <span style="color: #d08928;">"kendall"</span>, <span style="color: #d08928;">"spearman"</span>)) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#20849;&#20998;&#25955;</span>
cor(x, y = <span style="color: #00aa80;">NULL</span>, use = <span style="color: #d08928;">"everything"</span>, 
    method = c(<span style="color: #d08928;">"pearson"</span>, <span style="color: #d08928;">"kendall"</span>, <span style="color: #d08928;">"spearman"</span>)) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#30456;&#38306;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> x,y: &#12505;&#12463;&#12488;&#12523;&#65292;&#12487;&#12540;&#12479;&#12501;&#12524;&#12540;&#12512;&#12394;&#12393; (&#12487;&#12540;&#12479;&#12501;&#12524;&#12540;&#12512;&#12398;&#26178;&#12399;&#21015;&#38291;&#12398;&#38306;&#20418;&#12434;&#35336;&#31639;)</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> use: &#27424;&#25613;&#20516;&#12394;&#12393;&#12398;&#25201;&#12356;&#12395;&#38306;&#12377;&#12427;&#25351;&#23450;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> method: &#35336;&#31639;&#27861;&#12398;&#25351;&#23450;(&#36890;&#24120;&#12399;&#26082;&#23450;&#20516; pearson &#12391;&#12424;&#12356;)</span>
</pre>
</div></li>

</ul>
</section>
</section>
<section>
<section id="slide-org0022bef" data-background="#fef4f4">
<h2 id="org0022bef">実習</h2>
</section>
<section id="slide-org9641341" data-background="#fef4f4">
<h3 id="org9641341">練習問題</h3>
<ul>
<li><p>
東京の気候データ (<code>tokyo_weather.csv</code>) の中の
</p>
<blockquote>
<p>
気温 (<code>temp</code>), 降水量 (<code>rain</code>), 日射量 (<code>solar</code>), 
風速 (<code>wind</code>), 気圧 (<code>press</code>), 湿度 (<code>humid</code>)
</p>
</blockquote>
<p>
(いずれも数値データ)
の項目について以下の問に答えよ．
</p>
<ul>
<li>それぞれの項目間の共分散，および相関を求めよ．</li>
<li>相関の高い項目の組(絶対値が大きい)，および相関の低い項目の組(0に近い)を求めよ．</li>
<li>その項目同士の散布図を描け．</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-org666df74">
<h2 id="org666df74">&ldquo;順序&rdquo;に基づく統計量</h2>
<div class="outline-text-2" id="text-org666df74">
</div>
</section>
<section id="slide-orga142c10">
<h3 id="orga142c10">中央値</h3>
<ul>
<li><p>
データの順序にもとづく記述統計量
</p>
<blockquote>
<div>
\begin{equation}
  X_{(1)}\leq X_{(2)}\leq\cdots\leq X_{(n)}
\end{equation}

</div>
</blockquote></li>
<li><p>
<b>中央値</b> もしくは <b>メディアン</b> (median)
</p>
<blockquote>
<p>
データを昇順に並べ替えたとき中央にくる値
</p>
<ul>
<li>\(n\) が奇数の場合 : \(X_{((n+1)/2)}\)</li>
<li>\(n\) が偶数の場合 : \((X_{(n/2)}+X_{(n/2+1)})/2\)</li>

</ul>
</blockquote></li>
<li>中央値は平均と同様にデータを代表する値</li>
<li>データ中の <b>外れ値</b> (異常な値)の影響を受けにくい</li>

</ul>
</section>
<section id="slide-org0b05c0b">
<h3 id="org0b05c0b">分位点</h3>
<ul>
<li>メディアンの一般化</li>
<li><p>
\(100\alpha\) % <b>分位点</b> (percentile/quantile)
</p>
<blockquote>
<p>
\(\alpha\in[0,1]\) に対して,
その点以下のデータの個数が全体の約 \(100\alpha\) % になるような点
</p>
<ul>
<li><b>第1四分位点</b> : 25%分位点</li>
<li><b>第2四分位点</b> : 50%分位点 (中央値と等価)</li>
<li><b>第3四分位点</b> : 75%分位点</li>

</ul>
</blockquote></li>

</ul>
</section>
<section id="slide-org21cbd00">
<h3 id="org21cbd00">中央値・分位点の計算</h3>
<ul>
<li><p>
基本的な使い方
</p>
<div class="org-src-container">

<pre class="src src-R">median(x, na.rm = <span style="color: #00aa80;">FALSE</span>) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#20013;&#22830;&#20516;</span>
quantile(x, probs = seq(0, 1, 0.25), na.rm = <span style="color: #00aa80;">FALSE</span>,
         names = <span style="color: #00aa80;">TRUE</span>, type = 7) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#20998;&#20301;&#28857;</span>
summary(x) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#26368;&#22823;&#65292;&#26368;&#23567;&#65292;&#22235;&#20998;&#20301;&#28857;&#65292;&#24179;&#22343;&#12434;&#35336;&#31639;&#12377;&#12427;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> x: &#12505;&#12463;&#12488;&#12523;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> na.rm: &#27424;&#25613;&#20516;&#12434;&#21462;&#12426;&#38500;&#12367;&#12363;&#21542;&#12363;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> probs: &#35336;&#31639;&#12377;&#12427;&#20998;&#20301;&#28857;&#12398;&#20516;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> names: &#20986;&#21147;&#12395;&#38306;&#12377;&#12427;&#25351;&#23450;&#65292;&#22810;&#25968;&#12398;&#20998;&#20301;&#28857;&#12434;&#35336;&#31639;&#12377;&#12427;&#22580;&#21512;&#12399; FALSE &#12392;&#12375;&#12383;&#26041;&#12364;&#12424;&#12356;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> type: &#35336;&#31639;&#27861;&#12398;&#25351;&#23450;(help(quantile) &#12434;&#21442;&#29031;)</span>
</pre>
</div></li>

</ul>
</section>
<section id="slide-orgd47f151">
<h3 id="orgd47f151">連続分布の分位点</h3>
<ul>
<li>分位点は推定や検定において重要な役割を果たす</li>
<li><p>
連続分布の \(100\alpha\) % <b>分位点</b>
</p>
<blockquote>
<p>
\(0<\alpha<1\) に対して，その分布に従う確率変数を \(X\) としたとき，
不等式
</p>
<div>
\begin{equation}
  P(X\leq x)\geq\alpha
\end{equation}

</div>
<p>
を満たす実数 \(x\) のうち最小のもの
</p>
</blockquote>
<ul>
<li><p>
そのような実数 \(q_\alpha\) は常に存在し, 以下が成り立つ．
</p>
<blockquote>
<div>
\begin{equation}
  P(X\leq q_\alpha)=\alpha
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>

</section>
<section>
<ul>
<li><p>
分位点の性質
</p>
<blockquote>
<p>
\(X_1,X_2,\dots,X_n\) が独立同分布な確率変数の列のとき,
\(X_1,X_2,\dots,X_n\) の \(100\alpha\) %分位点は，
\(n\to\infty\) のとき \(X_1,X_2,\dots,X_n\) の従う
分布の \(100\alpha\) %分位点の <b>一致推定量</b> となる．
</p>
</blockquote></li>

</ul>
</section>
<section id="slide-orgd7a6e9e">
<h3 id="orgd7a6e9e">分布の分位点の計算</h3>
<ul>
<li><p>
基本的な使い方
</p>
<div class="org-src-container">

<pre class="src src-R"><span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> &#20197;&#19979;&#12399;&#27491;&#35215;&#20998;&#24067;&#12391;&#12398;&#35336;&#31639;&#20363;</span>
qnorm(p, mean = 0, sd = 1, lower.tail = <span style="color: #00aa80;">TRUE</span>, log.p = <span style="color: #00aa80;">FALSE</span>)
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> p: &#20998;&#20301;&#28857; (100p%)</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> mean, sd: &#27491;&#35215;&#20998;&#24067;&#12398;&#29305;&#24615;&#12434;&#27770;&#12417;&#12427;option</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> lower.tail: TRUE &#12394;&#12425; P(X&lt;x) &#12434;&#35336;&#31639;&#65294;FALSE &#12394;&#12425;&#36870;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> log.p: &#30906;&#29575;&#12434;&#23550;&#25968;&#12392;&#12377;&#12427;&#12363;&#21542;&#12363; (&#20516;&#12364;&#23567;&#12373;&#12356;&#22580;&#21512;&#12395;&#21033;&#29992;)</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> xxx&#20998;&#24067;&#12398;&#22580;&#21512;&#12399;&#20197;&#19979;&#12398;&#24418;&#24335;</span>
qxxx(p, <span style="color: #d08928;">"&#20998;&#24067;&#12398;&#29305;&#24615;&#12434;&#27770;&#12417;&#12427; option &#12398;&#25351;&#23450;"</span>) 
</pre>
</div></li>

</ul>
</section>
<section id="slide-org9d7a162">
<h3 id="org9d7a162">ばらつきの指標</h3>
<ul>
<li>分位点を利用したデータのばらつきの指標</li>
<li><p>
<b>範囲</b> (range)
</p>
<blockquote>
<p>
最大値と最小値の差 (外れ値の影響を大きく受ける)
</p>
</blockquote></li>
<li><p>
<b>四分位範囲</b> (interquantile range)
</p>
<blockquote>
<p>
第3四分位点と第1四分位点の差
</p>
</blockquote></li>
<li><p>
<b>中央絶対偏差</b> (median absolute deviation)
</p>
<blockquote>
<p>
\(X_1,X_2,\dots,X_n\) の中央値を \(m\) としたとき,
\(|X_1-m|,|X_2-m|,\dots,|X_n-m|\) の中央値
</p>
</blockquote></li>

</ul>
</section>
<section id="slide-org43dc005">
<h3 id="org43dc005">ばらつきの指標の計算</h3>
<ul>
<li><p>
基本的な使い方
</p>
<div class="org-src-container">

<pre class="src src-R"><span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> &#31684;&#22258;</span>
range(..., na.rm = <span style="color: #00aa80;">FALSE</span>, finite = <span style="color: #00aa80;">FALSE</span>)
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> &#22235;&#20998;&#20301;&#31684;&#22258;</span>
IQR(x, na.rm = <span style="color: #00aa80;">FALSE</span>, type = 7)
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> &#20013;&#22830;&#32118;&#23550;&#20559;&#24046;</span>
mad(x, center = median(x), constant = 1.4826, na.rm = <span style="color: #00aa80;">FALSE</span>,
    low = <span style="color: #00aa80;">FALSE</span>, high = <span style="color: #00aa80;">FALSE</span>)
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> ...: &#12487;&#12540;&#12479; (&#35079;&#25968;&#28193;&#12377;&#12371;&#12392;&#12364;&#12391;&#12365;&#12427;)</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> x: &#25968;&#20516;&#12505;&#12463;&#12488;&#12523;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> na.rm: &#27424;&#25613;(NA)&#12398;&#21066;&#38500; (&#26082;&#23450;&#20516;&#12399;&#21066;&#38500;&#12375;&#12394;&#12356;)</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> constant: mad&#12398;&#35036;&#27491;&#20516; (&#26082;&#23450;&#20516;&#12399;&#27491;&#35215;&#20998;&#24067;&#12434;&#20206;&#23450;&#12375;&#12390;&#27161;&#28310;&#20559;&#24046;&#12395;&#25563;&#31639;)</span>
</pre>
</div></li>

</ul>
</section>
</section>
<section>
<section id="slide-org639ac34">
<h2 id="org639ac34">&ldquo;頻度&rdquo;に基づく統計量</h2>
<div class="outline-text-2" id="text-org639ac34">
</div>
</section>
<section id="slide-orgb78a53e">
<h3 id="orgb78a53e">頻度に基づく統計量</h3>
<ul>
<li><p>
<b>最頻値</b> もしくは <b>モード</b> (mode)
</p>
<blockquote>
<p>
データの中で最も頻度が高く現れる値
</p>
</blockquote></li>
<li>データが有限個の値を取る場合に特に有効</li>
<li>データが連続で無限に多くの値を取ることができる場合には
注意が必要
<ul>
<li>連続なデータの場合でも有限個の観測データに対してモードは定義できる</li>
<li>ただし，偶々観測値として現れた値なのでその意味はよく考えなくてはならない</li>
<li>必要に応じて, 例えば区分的に集計するなどの工夫をすることもある</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-orgeac9242" data-background="#fef4f4">
<h2 id="orgeac9242">実習</h2>
</section>
<section id="slide-orgef9693c" data-background="#fef4f4">
<h3 id="orgef9693c">練習問題</h3>
<ul>
<li><p>
東京の気候データ (<code>tokyo_weather.csv</code>) の中の
</p>
<blockquote>
<p>
気温 (<code>temp</code>; 数値データ)と最多風向 (<code>wdir</code>; ラベルデータ)
</p>
</blockquote>
<p>
を用いて
以下の問に答えよ．
</p>
<ul>
<li>全てのデータを用いて気温の四分位点を求めよ．(データ数365)</li>
<li>5の付く日(各月の5,15,25)の気温の四分位点を求めよ．(データ数36)</li>
<li>ランダムに選んだ36日分のデータで気温の四分位点がどのくらいばらつくか確認せよ．</li>
<li>風向の最頻値を求めよ．</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-org7559143">
<h2 id="org7559143">次回の予定</h2>
<ul>
<li>点推定
<ul>
<li>不偏推定量</li>
<li>Cramér-Raoの不等式</li>

</ul></li>
<li>最尤推定量</li>
<li>区間推定
<ul>
<li>信頼区間</li>
<li>正規母集団の区間推定</li>
<li>漸近正規性にもとづく区間推定</li>

</ul></li>

</ul>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/menu/menu.js"></script>
<script src="./reveal.js/plugin/spotlight/spotlight.js"></script>
<script src="./reveal.js/plugin/chalkboard/plugin.js"></script>
<script src="./reveal.js/dist/theme/hidelinks.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,
overview: true,

transition: 'fade',
transitionSpeed: 'default',
showNotes: window.location.search.match( /print-pdf/gi ) ? 'separate-page' : false,
spotlight: { size: 80, initialPresentationMode: false, }, keyboard: { 81: function() { RevealSpotlight.toggleSpotlight()}, 87: function() { RevealSpotlight.togglePresentationMode();}, },

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealMenu, RevealSpotlight, RevealChalkboard ],

// Optional libraries used to extend reveal.js
dependencies: [
]

});
</script>
</body>
</html>
