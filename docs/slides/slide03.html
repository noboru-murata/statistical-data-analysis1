<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>関数と制御構造</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/mycourse.css"/>
<link rel="stylesheet" href="./reveal.js/plugin/highlight/zenburn.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">関数と制御構造</h1>
</div>
<div class="talk-subtitle">
    <p>関数の定義とプログラムの作成</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  </p>
</div>

</section>

<section>
<section id="slide-org534b362">
<h2 id="org534b362">講義の内容</h2>
<ul>
<li>R言語における関数</li>
<li>引数の扱い方 (引数名・順序・既定値)</li>
<li>自作関数の定義</li>
<li>制御構造 (条件分岐・繰り返し)</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgbb69fc7">
<h2 id="orgbb69fc7">R言語における関数</h2>
<div class="outline-text-2" id="text-orgbb69fc7">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org9de20c1">
<h3 id="org9de20c1">関数</h3>
<ul>
<li>関数の取り扱いは一般的な計算機言語とほぼ同様</li>
<li>関数は引数とその値を指定して実行 (引数がない場合もある)</li>
<li>引数名は順序を守れば省略可能</li>
<li><p>
<span style="color:darkgreen;">関数の呼び出し方</span>
</p>
<div class="org-src-container">

<pre><code class=" R" >f(arg1=value1, arg2=value2) 
## arg1, arg2 は引数の名前，value1, value2 は引数に渡す値を表す
f(value1, value2) # 上と同値．順序に注意
</code></pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgb10918c">
<h3 id="orgb10918c">関数の実行例</h3>
<ul>
<li><p>
<span style="color:darkgreen;">正弦関数の計算</span>
</p>
<div class="org-src-container">

<pre><code class=" R" >sin(x = pi/2) 
sin(pi/2) # 上と同値
</code></pre>
</div>

<pre class="example">
[1] 1
[1] 1
</pre></li>

<li><p>
<span style="color:darkgreen;">対数関数の計算</span> (xやbに適当な数値を代入せよ)
</p>
<div class="org-src-container">

<pre><code class=" R" >log(x, b) # 底をbとする対数
log(x=x, base=b) #上と同値
log(base=b, x=x) #上と同値
log(b,x) # = log(x=b,base=x) 
log(x) # 自然対数 =log(x,base=exp(1))
</code></pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org714535e">
<h3 id="org714535e">引数</h3>
<ul>
<li>関数の引数および返値を確認する help
<ul>
<li>引数 Arguments</li>
<li>返値 Values</li>

</ul></li>
<li>引数の省略すると既定値が用いられる</li>
<li>例は何が良い?練習でも使うので2つくらい欲しい</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org7c80289">
<h3 id="org7c80289">既定値を持つ関数の実行例</h3>
<ul>
<li><p>
<span style="color:darkgreen;">対数関数の計算</span> (xやbに適当な数値を代入せよ)
</p>
<div class="org-src-container">

<pre><code class=" R" >log(x, b) # 底をbとする対数
log(x=x, base=b) #上と同値
log(base=b, x=x) #上と同値
log(b,x) # = log(x=b,base=x) 
log(x) # 自然対数 =log(x,base=exp(1))
</code></pre>
</div></li>

</ul>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org3837f27" data-background="#fef4f4">
<h2 id="org3837f27">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org2a853f9" data-background="#fef4f4">
<h3 id="org2a853f9">練習問題</h3>
<p>
何かの関数を調べさせる
計算させる
2つくらい組み合わせて計算してもらう
</p>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org6405136">
<h2 id="org6405136">関数の定義</h2>
<div class="outline-text-2" id="text-org6405136">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgea03c65">
<h3 id="orgea03c65">自作関数</h3>
<ul>
<li>他の言語と同様にRでも関数を定義できる</li>
<li>関数の定義には関数 <code>function()</code> を利用する 
functionの記法を書く</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org6044ea2">
<h3 id="org6044ea2">自作関数の例</h3>
<ul>
<li><p>
<span style="color:darkgreen;">半径 r から球の体積と表面積を求める関数</span>
</p>
<div class="org-src-container">

<pre><code class=" R" >myfunc &lt;- function(r){
    V &lt;- (4/3) * pi * r^3 # 球の体積
    S &lt;- 4 * pi * r^2     # 球の表面積
    out &lt;- c(V,S) # 返り値のベクトルを作る
    names(out) &lt;- c("volume", "area") # 返り値の要素に名前を付ける
    return(out) # 値を返す
}
myfunc(1) # 実行
</code></pre>
</div>

<pre class="example">
 volume     area 
4.18879 12.56637
</pre></li>

</ul>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgd9cc90a" data-background="#fef4f4">
<h2 id="orgd9cc90a">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org1f42341" data-background="#fef4f4">
<h3 id="org1f42341">例題</h3>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org04470d3" data-background="#fef4f4">
<h3 id="org04470d3">解答例</h3>
<div class="org-src-container">

<pre><code class=" R" >
</code></pre>
</div>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org97e816a" data-background="#fef4f4">
<h3 id="org97e816a">練習問題</h3>
<ul>
<li>非負の整数 \(n\) の階乗 \(n!\) を求める関数を作成せよ．
prodを使えばよいか</li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org2ccab87">
<h2 id="org2ccab87">制御構造</h2>
<div class="outline-text-2" id="text-org2ccab87">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgac41a18">
<h3 id="orgac41a18">制御文</h3>
<ul>
<li>最適化や数値計算などを行うためには，
条件分岐や繰り返しを行うための仕組みが必要となる</li>
<li>R言語を含む多くの計算機言語では
<ul>
<li><code>if</code>  (条件分岐)</li>
<li><code>for</code>  (繰り返し・回数指定)</li>
<li><code>while</code>  (繰り返し・条件指定)</li>

</ul></li>
<li>これを <b>制御文</b> と言う</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org7e99ce9">
<h3 id="org7e99ce9"><code>if</code> 文</h3>
<ul>
<li><p>
条件Aが <b>真</b> のときプログラムXを実行する
</p>
<div class="org-src-container">

<pre><code class=" R" >if(条件A) プログラムX
</code></pre>
</div></li>
<li><p>
上記の <code>if</code> 文に条件Aが <b>偽</b> のときプログラムYを実行することを追加する
</p>
<div class="org-src-container">

<pre><code class=" R" >if(条件A) プログラムX else プログラムY    
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org1d17310">
<h3 id="org1d17310"><code>if</code> 文の例</h3>
<ul>
<li><p>
<span style="color:darkgreen;">20200724が19で割り切れるか?</span>
</p>
<div class="org-src-container">

<pre><code class=" R" >if(20200724 %% 19 == 0) {# %% は余りを計算
    print("割り切れます")
    print(20200724 %/% 19) # 商を表示
} else { # {}で囲まれたブロックが1つのプログラム
    print("割り切れません")
    print(20200724 %% 19) # 余りを表示
} 
</code></pre>
</div>

<pre class="example">
[1] "割り切れます"
[1] 1063196
</pre></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgce32f8e">
<h3 id="orgce32f8e"><code>for</code> 文</h3>
<ul>
<li><p>
ベクトル <code>V</code> の要素を <b>順に</b> 変数 <code>i</code> に代入して
プログラムXを繰り返し実行する
</p>
<div class="org-src-container">

<pre><code class=" R" >for(i in V) プログラムX
</code></pre>
</div></li>
<li>プログラムXは変数 <code>i</code> によって実行内容が変わる</li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org19cde8d">
<h3 id="org19cde8d"><code>for</code> 文の例</h3>
<ul>
<li><p>
<span style="color:darkgreen;">アルファベットの20,15,11,25,15番目を表示</span>
</p>
<div class="org-src-container">

<pre><code class=" R" >print(LETTERS) # LETTERS ベクトルの内容を表示
for(i in c(20,15,11,25,15)) {
    print(LETTERS[i]) # 順番に表示
}
</code></pre>
</div>

<pre class="example">
 [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L" "M" "N" "O" "P" "Q" "R" "S"
[20] "T" "U" "V" "W" "X" "Y" "Z"
[1] "T"
[1] "O"
[1] "K"
[1] "Y"
[1] "O"
</pre></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org539c7bc">
<h3 id="org539c7bc"><code>while</code> 文</h3>
<ul>
<li><p>
条件Aが <b>真</b> である限りプログラムXを繰り返す
</p>
<div class="org-src-container">

<pre><code class=" R" >while(条件A) プログラムX
</code></pre>
</div></li>
<li>プログラムXは実行するたびに実行内容が変わり，
いつか条件Aが満たされなくなるように書く</li>
<li><i>(<code>repeat</code> 文というものもある)</i></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org9608e82">
<h3 id="org9608e82"><code>while</code> 文の例</h3>
<ul>
<li><p>
<span style="color:darkgreen;">20200809を素因数分解する</span>
</p>
<div class="org-src-container">

<pre><code class=" R" >n &lt;- 20200809 # 分解の対象
p &lt;- 2 # 最初に調べる数
while(n != 1){ # 商が1になるまで計算する
    for(i in p:n){ # pからnまで順に調べる
	if(n%%i == 0) { # 余りが0か確認
	    print(i) # 割り切った数を表示
	    n &lt;- n/i # 商を計算して分解の対象を更新
	    p &lt;- i # 最初に調べる数を更新
	    break # for文を途中で終了
	}  
    }
}
</code></pre>
</div>

<pre class="example">
[1] 3
[1] 31
[1] 281
[1] 773
</pre></li>

</ul>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgc47b463" data-background="#fef4f4">
<h2 id="orgc47b463">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org13f6fb9" data-background="#fef4f4">
<h3 id="org13f6fb9">例題</h3>
<ul>
<li>三角形の3辺の長さ \(x,y,z\) を与えると
面積 \(S\) を計算する関数を作成せよ．</li>
<li><p>
参考: <b>ヘロンの公式</b> より
</p>

<div>
\begin{equation}
  S=\sqrt{s(s-x)(s-y)(s-z)},\qquad
  s=\frac{x+y+z}{2}
\end{equation}

</div>

<p>
が成り立つ．
</p></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org9050c74" data-background="#fef4f4">
<h3 id="org9050c74">解答例</h3>
<div class="org-src-container">

<pre><code class=" R" >area &lt;- function(x,y,z){
    s &lt;- (x+y+z)/2
    S &lt;- (s*(s-x)*(s-y)*(s-z))^(1/2)
    ## S &lt;- sqrt(s*(s-x)*(s-y)*(s-z)) # 平方根を求める関数を用いても良い
  return(S)
}
area(3,4,5) # 直角三角形で検算
area(12,13,5)
</code></pre>
</div>

<pre class="example">
[1] 6
[1] 30
</pre>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgf7a5314" data-background="#fef4f4">
<h3 id="orgf7a5314">練習問題</h3>
<ul>
<li>非負の整数 \(n\) の階乗 \(n!\) を求める関数を作成せよ．</li>
<li><p>
整数 \(n\) の Fibonacci数を求める関数を作成せよ．
</p>

<div>
\begin{align}
  F_{0}&=0\\
  F_{1}&=1\\
  F_{n}&=F_{n-1}+F_{n-2}
\end{align}

</div></li>
<li>行列 \(X\) が与えられたとき，各列の平均を計算する関数を作成せよ．</li>
<li>前問で \(X\) がベクトルの場合にはその平均を計算するように修正せよ．<br />
<i>(関数 <code>is.vector()</code> が利用できる)</i></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/highlight/highlight.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,

overview: true,

transition: 'fade',
transitionSpeed: 'default',
spotlight: { size: 90, initialPresentationMode: false }, chalkboard: { toggleChalkboardButton: { left: '80px' }, toggleNotesButton: { left: '130px'}}, keyboard: { 69: function() { RevealChalkboard.toggleNotesCanvas() }, 87: function() { RevealChalkboard.toggleChalkboard() }, 67: function() { RevealChalkboard.clear() }, 82: function() { RevealChalkboard.reset() }, 68: function() { RevealChalkboard.download() }, 88: function() { RevealChalkboard.colorNext() }, 89: function() { RevealChalkboard.colorPrev() }, 84: function() { RevealSpotlight.toggleSpotlight() }, 81: function() { RevealSpotlight.togglePresentationMode()}},

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealHighlight ],

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/menu/menu.js'},
{ src: './reveal.js/plugin/chalkboard/chalkboard.js'},
{ src: './reveal.js/plugin/spotlight/spotlight.js'}]

});
</script>
</body>
</html>
