<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>検定</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/mycourse.css"/>
<link rel="stylesheet" href="./reveal.js/plugin/highlight/zenburn.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">検定</h1>
</div>
<div class="talk-subtitle">
    <p>仮説の正当性をデータから検証する</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  </p>
</div>

</section>

<section>
<section id="slide-org5eb721c">
<h2 id="org5eb721c">講義の内容</h2>
<ul>
<li>検定
<ul>
<li>帰無仮説と対立仮説</li>
<li>棄却域</li>
<li>\(p\)-値</li>

</ul></li>
<li>平均の検定</li>
<li>分散の検定</li>
<li>平均の差の検定</li>
<li>分散の比の検定</li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-org5b78ad2">
<h2 id="org5b78ad2">検定とは</h2>
<div class="outline-text-2" id="text-org5b78ad2">
</div>
</section>
<section id="slide-org5f2103d">
<h3 id="org5f2103d">統計的仮説検定</h3>
<ul>
<li>ある現象・母集団に対して仮定された仮説の真偽を
データに基づいて統計的に検証する方法</li>
<li><p>
<span style="color:green;">薬の治験の例</span>
</p>
<blockquote>
<p>
新しい薬の効能が古い薬よりも優れていること(仮説)を
薬の治験結果(データ)から検証したい
</p>
</blockquote></li>
<li>推定と大きく異なるのは，
母集団の分布に対して何らかの <b>仮説</b> を考えるところ</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org7c25046">
<h3 id="org7c25046">検定の基本的手続き</h3>
<ol>
<li><b>仮説</b> を立てる</li>
<li>仮説のもとで <b>検定統計量</b> が従う標本分布を調べる</li>
<li>実際のデータから検定統計量の値を計算する</li>
<li>計算された検定統計量の値が
仮説が正しいときに十分高い確率で
得られるかどうかを判断する</li>

</ol>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgb2eed90">
<h3 id="orgb2eed90">検定における仮説</h3>
<ul>
<li><p>
<b>帰無仮説</b>
</p>
<blockquote>
<p>
検定統計量の分布を予想するために立てる仮説
</p>
</blockquote></li>
<li><p>
<b>対立仮説</b>
</p>
<blockquote>
<p>
&ldquo;帰無仮説が誤っているときに起こりうるシナリオ&rdquo;として想定する仮説
</p>
</blockquote>
<ul>
<li>慣習として
帰無仮説を <b>\(H_0\)</b>, 
対立仮説を <b>\(H_1\)</b> で表す</li>
<li>&ldquo;帰無仮説を捨てて無に帰する&rdquo;ことを期待する場合が多い</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org4a3813f">
<h3 id="org4a3813f">帰無仮説と対立仮説</h3>
<ul>
<li><span style="color:green;">薬の治験の例</span> (単純な場合)
<ul>
<li>帰無仮説 \(H_0\) : 新しい薬も古い薬も効能は同じ</li>
<li>対立仮説 \(H_1\) : 新しい薬と古い薬の効能は異なる</li>

</ul></li>
<li><span style="color:green;">薬の治験の例</span> (新薬がより良いことを期待する場合)
<ul>
<li>帰無仮説 \(H_0\) : 新しい薬も古い薬も効能は同じ</li>
<li>対立仮説 \(H_1\) : 新しい薬の方が古い薬より効能が高い</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org9e4e5ed">
<h3 id="org9e4e5ed">検定の用語</h3>
<ul>
<li><p>
<b>帰無分布</b>
</p>
<blockquote>
<p>
帰無仮説が正しい場合に検定統計量が従う分布
</p>
</blockquote></li>
<li><p>
<b>棄却域</b>
</p>
<blockquote>
<p>
帰無仮説の下で統計量の取り得るべき範囲の外の領域
</p>
</blockquote></li>
<li>仮説検定
<ul>
<li>帰無仮説を <b>棄却</b> : 帰無仮説は誤っていると判断すること</li>
<li>帰無仮説を <b>受容</b> : 帰無仮説を積極的に棄却できないこと</li>

</ul></li>
<li>検定の誤り
<ul>
<li><b>第一種過誤</b> : &ldquo;正しい帰無仮説を棄却する&rdquo;誤り</li>
<li><b>第二種過誤</b> : &ldquo;誤った帰無仮説を受容する&rdquo;誤り</li>

</ul></li>

</ul>


<div class="slide-footer"><br></div>
</section>
<section>

<div id="orgbdfa861" class="figure">
<p><img src="figs/test1.png" alt="test1.png" height="100%" />
</p>
<p><span class="figure-number">Figure 1: </span>検定の考え方</p>
</div>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="orge9df7c5" class="figure">
<p><img src="figs/test2.png" alt="test2.png" height="100%" />
</p>
<p><span class="figure-number">Figure 2: </span>棄却と受容</p>
</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org56cec3d">
<h3 id="org56cec3d">検定の設計指針</h3>
<ul>
<li>検定統計量 \(T\) に対して棄却域 \(R\) を設計
<ul>
<li><p>
<b>サイズ</b>: 第一種過誤が <b>起きる確率</b>
</p>
<blockquote>
<div>
\begin{equation}
  \text{(サイズ)}
  =P(\text{\(T\) が\(R\)に含まれる}|\text{帰無仮説が正しい})
\end{equation}

</div>
</blockquote></li>
<li><p>
<b>検出力</b> : 第二種過誤が <b>起きない確率</b>
</p>
<blockquote>
<div>
\begin{equation}
  \text{(検出力)}
  =P(\text{\(T\) が\(R\)に含まれる}|\text{対立仮説が正しい})
\end{equation}

</div>
</blockquote></li>

</ul></li>
<li><p>
<b>有意水準</b>
</p>
<blockquote>
<p>
第一種過誤が起きる確率(サイズ)として許容する上限
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="orgbc9c49c" class="figure">
<p><img src="figs/test3.png" alt="test3.png" height="100%" />
</p>
<p><span class="figure-number">Figure 3: </span>検定の設計</p>
</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orga7c0e59">
<h3 id="orga7c0e59">棄却域の決め方</h3>
<ul>
<li>検定を構成する場合の一般的な戦略 : <br />
棄却域 \(R_{\alpha}\) は以下のように設定する
<ul>
<li><b>サイズを小さく</b> (有意水準 \(\alpha\) 以下に) 抑える</li>
<li><p>
可能な限り <b>検出力を大きく</b> する
</p>
<blockquote>
<div>
\begin{align}
  P(T \in R_{\alpha}|\text{帰無仮説が正しい})
  &\le\alpha\\
  P(T \in R_{\alpha}|\text{対立仮説が正しい})
  &\to\text{最大化}
\end{align}

</div>
</blockquote></li>

</ul></li>
<li>対立仮説によって棄却域の形は変わりうる</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org88f43c7">
<h3 id="org88f43c7">\(p\)-値 (有意確率)</h3>
<ul>
<li><p>
帰無分布における検定統計量の評価
</p>
<blockquote>
<p>
検定統計量の値が棄却域に含まれる有意水準の最小値を考える
</p>
</blockquote></li>
<li><p>
<b>\(p\)-値 (有意確率)</b> : (検定統計量 \(T\), 棄却域 \(R_{\alpha}\))
</p>
<blockquote>
<div>
\begin{equation}
  \text{(\(p\)-値)}
  =\min\{\alpha\in(0,1)|\text{\(T\) が\(R_{\alpha}\)に含まれる}\}
\end{equation}

</div>
</blockquote></li>
<li>\(p\)-値が有意水準未満のときに帰無仮説を棄却する</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgabf8354">
<h3 id="orgabf8354">検定に関する注意</h3>
<ul>
<li><p>
帰無仮説の受容の意味
</p>
<blockquote>
<p>
帰無仮説が正しいと仮定しても矛盾は生じない
</p>

<p>
帰無仮説の正しさを積極的に支持する結果ではない
</p>
</blockquote></li>
<li><p>
第二種過誤
</p>
<blockquote>
<p>
一般に第二種過誤の起こる確率については何ら仮定がないため，
その確率は非常に大きい可能性がある
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-orgd53add7">
<h2 id="orgd53add7">1標本正規母集団に対する検定</h2>
<div class="outline-text-2" id="text-orgd53add7">
</div>
</section>
<section id="slide-org93bf1c6">
<h3 id="org93bf1c6">1標本データに対する仮定</h3>
<ul>
<li><p>
観測データは独立同分布な確率変数列
</p>
<blockquote>
<div>
\begin{equation}
  X_1,X_2,\dotsc,X_n
\end{equation}

</div>
</blockquote></li>
<li>\(X_{i}\) は平均 \(\mu\), 分散 \(\sigma^2\) の正規分布に従う</li>
<li>以下では平均 \(\mu\) および分散 \(\sigma^2\) に対する検定を説明</li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org62bab7f">
<h2 id="org62bab7f">平均の検定</h2>
<div class="outline-text-2" id="text-org62bab7f">
</div>
</section>
<section id="slide-org94c2639">
<h3 id="org94c2639">平均の検定</h3>
<ul>
<li><p>
両側検定
</p>
<blockquote>
<p>
\(\mu_0\) を既知の定数として，
観測データを生成している分布の平均 \(\mu\) が
\(\mu_0\) であるか否かを検定する
</p>
</blockquote>
<ul>
<li><p>
帰無仮説と対立仮説
</p>
<blockquote>
<div>
\begin{equation}
  H_0:\mu=\mu_0\quad\text{vs}\quad H_1:\mu\neq\mu_0.
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgaf8d13a">
<h3 id="orgaf8d13a">考え方</h3>
<ul>
<li>標本平均 \(\bar{X}\) (推定量) が
帰無仮説のもとでの真の平均 \(\mu_0\) とどの程度離れているかを検証</li>
<li>平均と分散の推定量を用いて検定統計量を構成
<ul>
<li><p>
標本平均 : (正規分布に従う)
</p>
<blockquote>
<div>
\begin{equation}
  \bar{X}=\frac{1}{n}\sum_{i=1}^nX_i
\end{equation}

</div>
</blockquote></li>
<li><p>
不偏分散 : (\(\chi^2\)-分布に従う)
</p>
<blockquote>
<div>
\begin{equation}
  s^2=\frac{1}{n{-}1}\sum_{i=1}^n(X_i-\bar{X})^2
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
検定統計量
</p>
<blockquote>
<div>
\begin{equation}
  t=\frac{\sqrt{n}(\bar{X}-\mu_0)}{s}
\end{equation}

</div>
</blockquote>
<ul>
<li>帰無分布は自由度 \(n{-}1\) の \(t\)-分布 <br />
(帰無仮説 \(H_0\) のもとでの検定統計量 \(t\) の分布)</li>

</ul></li>

<li><b>Studentの \(t\)-検定</b></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>\(t\)-分布</li>

</ul>
<div class="leftcol" id="orga6f61eb">

<div id="orgaca2ff4" class="figure">
<p><img src="figs/pdf_t.png" alt="pdf_t.png" width="100%" />
</p>
<p><span class="figure-number">Figure 4: </span>\(t\)-分布 (自由度\(3\))</p>
</div>

</div>
<div class="rightcol" id="org432735f">
<blockquote>
<ul>
<li>見本空間 : \((-\infty,\infty)\)</li>
<li>母数 : 自由度 \(\nu\)</li>
<li><p>
密度関数 :
</p>
<div>
\begin{equation}
  f(x)=
  \frac{\Gamma\left(\frac{\nu+1}{2}\right)}
  {\sqrt{\nu\pi}\;\Gamma\left(\frac{\nu}{2}\right)}
  \left(1+\frac{x^{2}}{\nu}\right)^{-\frac{1}{2}(\nu+1)}
\end{equation}

</div>

<ul>
<li>備考 : 標準正規分布と
自由度 \(\nu\) の \(\chi^{2}\)-分布
に従う独立な確率変数の比に関する分布で，
検定に利用される．</li>

</ul></li>

</ul>
</blockquote>

</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org5774bcb">
<h3 id="org5774bcb">棄却域を用いる場合</h3>
<ul>
<li>有意水準を選択 : \(\alpha\in(0,1)\)</li>
<li><p>
\(H_0\) の下で以下が成立
</p>
<blockquote>
<div>
\begin{equation}
  P(|t|>t_{1{-}\alpha/2}(n{-}1))=\alpha
\end{equation}

</div>
</blockquote>
<ul>
<li>\(t_{1{-}\alpha/2}(n{-}1)\) :
自由度 \(n{-}1\) の \(t\)-分布の \(1{-}\alpha/2\) 分位点</li>

</ul></li>
<li><p>
第一種過誤の上限が \(\alpha\) の棄却域
</p>
<blockquote>
<div>
\begin{equation}
  R_{\alpha}=
  \left(-\infty,-t_{1{-}\alpha/2}(n{-}1)\right)
  \cup\left(t_{1{-}\alpha/2}(n{-}1),\infty\right)
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>データから検定統計量 \(t\) の値を計算</li>
<li><p>
以下の場合，帰無仮説を棄却
</p>
<blockquote>
<div>
\begin{equation}
  |t|>t_{1{-}\alpha/2}(n{-}1),\quad
  (t\in R_{\alpha})
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org804a80c">
<h3 id="org804a80c">\(p\)-値を用いる場合</h3>
<ul>
<li><p>
\(p\)-値を計算 ( \(f(x)\) : 自由度 \(n{-}1\) の \(t\)-分布の密度)
</p>
<blockquote>
<div>
\begin{equation}
  \text{(\(p\)-値)}
  =2\int_{|t|}^\infty f(x)dx
\end{equation}

</div>
</blockquote></li>
<li><p>
\(p\)-値が \(\alpha\) 未満なら帰無仮説を棄却
</p>
<blockquote>
<div>
\begin{align}
  |t|>t_{1{-}\alpha/2}(n{-}1)
  &\Leftrightarrow
    \int_{-\infty}^{|t|}f(x)dx>
    \int_{-\infty}^{t_{1{-}\alpha/2}(n{-}1)}f(x)dx=1{-}\alpha/2\\
  &\Leftrightarrow
    \int_{|t|}^\infty f(x)dx < \alpha/2
    \Leftrightarrow
    2\int_{|t|}^\infty f(x)dx < \alpha
\end{align}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org9756bb1">
<h3 id="org9756bb1">対立仮説の違い</h3>
<ul>
<li><p>
<span style="color:green;">薬の治験例</span>
</p>
<blockquote>
<p>
観測データ \(X_1,X_2,\dotsc,X_n\) (\(n\) 人の被験者の治験結果)
に対する仮説:
</p>
<ul>
<li>古い薬(高価)と新しい薬(安価)の効能が変わらない (両側検定)</li>
<li>古い薬に比べて新しい薬の効能が改善した</li>

</ul>
</blockquote></li>
<li>対立仮説によって棄却域の形は変わりうる</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org07d3f48">
<h3 id="org07d3f48">平均の検定</h3>
<ul>
<li><p>
右片側検定
</p>
<blockquote>
<p>
\(\mu_0\) を既知の定数として，
観測データを生成している分布の平均 \(\mu\) が
\(\mu_0\) より大きいかを検定する
</p>
</blockquote>
<ul>
<li><p>
帰無仮説と対立仮説
</p>
<blockquote>
<div>
\begin{equation}
  H_0:\mu=\mu_0\quad\text{vs}\quad H_1:\mu>\mu_0.
\end{equation}

</div>
</blockquote></li>

</ul></li>
<li>検定統計量の標本分布 : 
<ul>
<li>帰無仮説は同一なので検定統計量 \(t\) の帰無分布も同一となる</li>
<li>対立仮説の下で \(t\) の値は正の方向に大きくなると期待される</li>

</ul></li>
<li>棄却域 &ldquo;\(t>c\)&rdquo; (\(c\) は正の数) を考えるのが自然</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orge9197f5">
<h3 id="orge9197f5">棄却域を用いる場合</h3>
<ul>
<li>有意水準を選択 : \(\alpha\in(0,1)\)</li>
<li><p>
\(H_0\) の下で以下が成立
</p>
<blockquote>
<div>
\begin{equation}
  P(t>t_{1{-}\alpha}(n{-}1))=\alpha
\end{equation}

</div>
</blockquote>
<ul>
<li>\(t_{1{-}\alpha}(n{-}1)\):
自由度 \(n{-}1\) の \(t\)-分布の \(1{-}\alpha\) 分位点</li>

</ul></li>
<li><p>
第一種過誤の上限が \(\alpha\) の棄却域
</p>
<blockquote>
<div>
\begin{equation}
  R_{\alpha}=
  \left(t_{1{-}\alpha}(n{-}1),\infty\right)
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>データから検定統計量 \(t\) の値を計算</li>
<li><p>
以下の場合，帰無仮説を棄却
</p>
<blockquote>
<div>
\begin{equation}
  t>t_{1{-}\alpha}(n{-}1)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgc5a63eb">
<h3 id="orgc5a63eb">\(p\)-値を用いる場合</h3>
<ul>
<li><p>
\(p\)-値を計算 ( \(f(x)\):自由度 \(n{-}1\) の \(t\)-分布の密度)
</p>
<blockquote>
<div>
\begin{equation}
  \text{(\(p\)-値)}=
  \int_{t}^\infty f(x)dx
\end{equation}

</div>
</blockquote></li>
<li>\(p\)-値が \(\alpha\) 未満なら帰無仮説を棄却</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org595656e">
<h3 id="org595656e">平均の検定</h3>
<ul>
<li><p>
左片側検定
</p>
<ul>
<li><p>
反対向きの対立仮説 \(\mu < \mu_0\) を考えた検定
</p>
<blockquote>
<div>
\begin{equation}
  H_0:\mu=\mu_0\quad\text{vs}\quad H_1:\mu < \mu_0.
\end{equation}

</div>
</blockquote></li>
<li><p>
以下の場合，帰無仮説を棄却
</p>
<blockquote>
<div>
\begin{equation}
  t < t_{\alpha}(n{-}1)
  \quad
  \text{(自由度 \(n{-}1\) の \(t\)-分布の \(\alpha\) 分位点)}
\end{equation}

</div>
</blockquote></li>

</ul>

<ul>
<li><p>
以下の \(p\)-値が \(\alpha\) 未満なら帰無仮説を棄却
</p>
<blockquote>
<div>
\begin{equation}
  \text{(\(p\)-値)}
  =\int_{-\infty}^t f(x)dx
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org9c286c8">
<h3 id="org9c286c8">両側検定と片側検定</h3>
<ul>
<li><b>右片側検定</b> : 棄却域がある定数 \(a\) によって \((a,\infty)\)</li>
<li><b>左片側検定</b> : 棄却域がある定数 \(a\) によって \((-\infty,a)\)
<ul>
<li>右片側検定と左片側検定を合わせて <b>片側検定</b> と呼ぶ</li>

</ul></li>
<li><b>両側検定</b> : 棄却域がある定数 \(a < b\) によって \((-\infty,a)\cup(b,\infty)\)</li>
<li>平均の検定の場合:
<ul>
<li>対立仮説を \(H_1:\mu\neq\mu_0\) にとった場合は両側検定</li>
<li>対立仮説を \(H_1:\mu>\mu_0\) にとった場合は右片側検定</li>
<li>対立仮説を \(H_1:\mu<\mu_0\) にとった場合は左片側検定</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<div class="leftcol" id="org0d6ba41">

<div id="org9ee4084" class="figure">
<p><img src="figs/cr_two.png" alt="cr_two.png" width="100%" />
</p>
</div>

</div>
<div class="rightcol" id="org57df30e">

<div id="org285a9fd" class="figure">
<p><img src="figs/cr_one.png" alt="cr_one.png" width="100%" />
</p>
</div>

</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org3a8408f">
<h3 id="org3a8408f">R : \(t\)-検定の関数</h3>
<ul>
<li><p>
使い方
</p>
<div class="org-src-container">

<pre><code class="R" >t.test(x, # 1標本の場合
       alternative = c("two.sided", "less", "greater"),
       mu = 0, conf.level = 0.95, ...)
## x : ベクトル． 
## alternative: 対立仮説 (両側，左片側，右片側)
## mu: 検定対象の平均値
## conf.level: 信頼区間の水準 (点推定・区間推定も行ってくれる)
## ...: 他のオプション．詳細は help(t.test) を参照
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org33ad40b" data-background="#fef4f4">
<h2 id="org33ad40b">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org7ea6abe" data-background="#fef4f4">
<h3 id="org7ea6abe">練習問題</h3>
<ul>
<li><p>
適当な正規乱数を用いてMonte-Carlo実験を考案し，
\(t\)-検定の過誤について調べなさい．
</p>
<div class="org-src-container">

<pre><code class="R" >## 例えば適当な数値を指定して以下のような実験を行えばよい
myTrial &lt;- function(n){ 
    result &lt;- t.test(rnorm(n,mean=mu0,sd=sd0),mu=mu0)
    return(result$p.value)}
myData &lt;- replicate(mc, myTrial(n))
hist(myData) # p.valueの分布を見る
table(myData&lt;alpha)/mc # alpha以下のデータの数を調べる
</code></pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
ある番組の視聴率が2桁に達したかどうか知るために
\(n\) 人にその番組を観たかどうか確認したところ
</p>
<blockquote>
<div>
\begin{equation}
  X_{i}=
  \begin{cases}
    1,&\text{番組を観た}\\
    0,&\text{番組を観ていない}
  \end{cases},\;
  i=1,2,\dotsc,n
\end{equation}

</div>
</blockquote>
<p>
となった．
これを用いた検定を考えてみよ．
</p>
<div class="org-src-container">

<pre><code class="R" >## Xの生成は例えば mu1 を真の視聴率として以下のようにすればよい
x &lt;- sample(0:1, n, replace=TRUE, prob=c(1-mu1,mu1))
## n 人分の視聴結果 {1,0} のベクトルが得られる
</code></pre>
</div>
<ul>
<li>ヒント : \(X\) は正規分布には従わないが，
\(\bar{X}\) は正規分布で近似できることが利用できる</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-org8097243">
<h2 id="org8097243">分散の検定</h2>
<div class="outline-text-2" id="text-org8097243">
</div>
</section>
<section id="slide-org8eb6a01">
<h3 id="org8eb6a01">分散の検定</h3>
<ul>
<li><p>
両側検定
</p>
<blockquote>
<p>
\(\sigma_0^2\) を既知の定数として，
観測データを生成している分布の分散 \(\sigma^2\) が
\(\sigma_0^2\) であるか否かを検定する
</p>
</blockquote>
<ul>
<li><p>
帰無仮説と対立仮説
</p>
<blockquote>
<div>
\begin{equation}
  H_0:\sigma^2=\sigma_0^2\quad\text{vs}\quad H_1:\sigma^2\neq\sigma_0^2
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org3d8adee">
<h3 id="org3d8adee">考え方</h3>
<ul>
<li>不偏分散 \(s^2\) が
真の分散 \(\sigma_{0}^{2}\) とどの程度離れているかを検証</li>
<li>分散の推定量の性質を用いて検定統計量を構成
<ul>
<li><p>
不偏分散 : (\(\chi^2\)-分布に従う)
</p>
<blockquote>
<div>
\begin{equation}
  s^2=\frac{1}{n{-}1}\sum_{i=1}^n(X_i-\bar{X})^2 
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
検定統計量
</p>
<blockquote>
<div>
\begin{equation}
  \chi^2=\frac{(n{-}1)s^2}{\sigma_0^2}
\end{equation}

</div>
</blockquote>
<ul>
<li>帰無分布は自由度 \(n{-}1\) の \(\chi^2\)-分布</li>

</ul></li>
<li><b>\(\chi^2\)-検定</b></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>\(\chi^{2}\)-分布</li>

</ul>
<div class="leftcol" id="org9dc074e">

<div id="org9872aaf" class="figure">
<p><img src="figs/pdf_chisq.png" alt="pdf_chisq.png" width="100%" />
</p>
<p><span class="figure-number">Figure 5: </span>\(\chi^{2}\)-分布 (自由度\(3\))</p>
</div>

</div>
<div class="rightcol" id="org232b650">
<blockquote>
<ul>
<li>見本空間 : \([0,\infty)\)</li>
<li>母数 : 自由度 \(\nu\)</li>
<li><p>
密度関数 :
</p>
<div>
\begin{align}
  f(x)=&
  \frac{1}{2^{\nu/2}\Gamma(\frac{\nu}{2})}x^{\nu/2-1}e^{-x/2}\\
  &\Gamma(z)=\int_0^\infty e^{-t}t^{z-1}dt
\end{align}

</div>

<ul>
<li>備考 : \(\nu\) 個の標準正規分布に従う確率変数の2乗和の分布で，
検定に利用される．</li>

</ul></li>

</ul>
</blockquote>

</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orga559fff">
<h3 id="orga559fff">棄却域を用いる場合</h3>
<ul>
<li>有意水準を選択 : \(\alpha\in(0,1)\)</li>
<li><p>
\(H_0\) の下で以下が成立
</p>
<blockquote>
<div>
\begin{equation}
  P(\chi^2 < \chi^2_{\alpha/2}(n{-}1)
  \text{ または }\chi^2>\chi^2_{1{-}\alpha/2}(n{-}1))
  =\alpha
\end{equation}

</div>
</blockquote>
<ul>
<li>\(\chi^2_{\alpha/2}(n{-}1)\):
自由度 \(n{-}1\) の \(\chi^2\)-分布の \(\alpha/2\) 分位点</li>
<li>\(\chi^2_{1{-}\alpha/2}(n{-}1)\):
自由度 \(n{-}1\) の \(\chi^2\)-分布の \(1{-}\alpha/2\) 分位点</li>

</ul></li>
<li><p>
第一種過誤の上限が \(\alpha\) となる棄却域
</p>
<blockquote>
<div>
\begin{equation}
  R_{\alpha}=
  \left(-\infty,\chi^2_{\alpha/2}(n{-}1)\right)
  \cup\left(\chi^2_{1{-}\alpha/2}(n{-}1),\infty\right)
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>データから検定統計量 \(\chi^2\) の値を計算</li>
<li><p>
以下の場合，帰無仮説を棄却
</p>
<blockquote>
<div>
\begin{equation}
  \chi^2 < \chi^2_{\alpha/2}(n{-}1)
  \text{ または }\chi^2>\chi^2_{1{-}\alpha/2}(n{-}1)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgbcc7a7f">
<h3 id="orgbcc7a7f">\(p\)-値を用いる場合</h3>
<ul>
<li><p>
\(p\)-値を計算 ( \(f(x)\): 自由度 \(n{-}1\) の \(\chi^2\)-分布の密度)
</p>
<blockquote>
<div>
\begin{equation}
  \text{(\(p\)-値)}
  =2\min\left\{\int_0^{\chi^2}f(x)dx,\int_{\chi^2}^\infty f(x)dx\right\}
\end{equation}

</div>
</blockquote></li>
<li>\(p\)-値が \(\alpha\) 未満なら帰無仮説を棄却</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org241ad96">
<h3 id="org241ad96">片側検定</h3>
<ul>
<li>対立仮説が片側 (右側対立仮説) の場合
<ul>
<li><p>
帰無仮説と対立仮説
</p>
<blockquote>
<div>
\begin{equation}%\label{two-side}
  H_0:\sigma^2=\sigma_0^2\quad
  \text{vs}\quad H_1:\sigma^2>\sigma_0^2
\end{equation}

</div>
</blockquote></li>

</ul></li>
<li>左側対立仮説 \(H_1:\sigma^2 < \sigma_0^2\) も以下の議論は同様</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org845dbac">
<h3 id="org845dbac">棄却域を用いる場合</h3>
<ul>
<li>自由度 \(n{-}1\) の \(\chi^2\)-分布の \(1{-}\alpha\) 分位点 :
\(\chi^2_{1{-}\alpha}(n{-}1)\)</li>
<li><p>
以下の場合，帰無仮説を棄却
</p>
<blockquote>
<div>
\begin{equation}
  \chi^2>\chi^2_{1{-}\alpha}(n{-}1)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org192f0a8">
<h3 id="org192f0a8">\(p\)-値を用いる場合</h3>
<ul>
<li><p>
\(p\)-値を計算 ( \(f(x)\):自由度 \(n{-}1\) の \(\chi^2\) 分布の密度)
</p>
<blockquote>
<div>
\begin{equation}
  \text{(\(p\)-値)}
  =\int_{\chi^2}^\infty f(x)dx
\end{equation}

</div>
</blockquote></li>
<li>\(p\)-値が \(\alpha\) 未満なら帰無仮説を棄却</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgca7fd6b">
<h3 id="orgca7fd6b">R : \(\chi^2\)-検定の関数</h3>
<ul>
<li>関数 <code>chisq.test</code> はあるが目的が違うので注意 (適合度検定・独立性検定)</li>
<li><p>
\(\chi^2\) 分布に関する関数を用いて直接計算することができる
</p>
<div class="org-src-container">

<pre><code class="R" >x # 観測データ
sigma0 # 帰無仮説で用いる標準偏差
n &lt;- length(x) # データ数
chi2 &lt;- (n-1)*var(x)/sigma0^2 # 検定統計量を計算する
p0 &lt;- pchisq(chi2, df=n-1)
2*min(p0, 1-p0) # p値 (両側検定の場合)
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-orgdec8f97" data-background="#fef4f4">
<h2 id="orgdec8f97">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgdbac6db" data-background="#fef4f4">
<h3 id="orgdbac6db">練習問題</h3>
<ul>
<li><p>
東京の気象データの気温の項目を用いて，
6月の気温の分散が，
月毎に計算した気温の分散の平均値より大きいかどうか検定せよ．
</p>
<div class="org-src-container">

<pre><code class="R" >TW.data &lt;- read.csv("data/tokyo_weather.csv")
## 月毎の気温の分散は以下で計算できる
aggregate(temp ~ month, data=TW.data, FUN=var)
## この平均値は以下のように計算される
mean(aggregate(temp ~ month, data=TW.data, FUN=var)$temp)
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-orgb0aac28">
<h2 id="orgb0aac28">2標本正規母集団に対する検定</h2>
<div class="outline-text-2" id="text-orgb0aac28">
</div>
</section>
<section id="slide-orgaa9aa2b">
<h3 id="orgaa9aa2b">2標本データに対する仮定</h3>
<ul>
<li><p>
2種類の観測データ :
</p>
<blockquote>
<div>
\begin{align}
  &X_1,X_2,\dotsc,X_m\\
  &Y_1,Y_2,\dotsc,Y_n
\end{align}

</div>
</blockquote></li>
<li>3つの条件を仮定 :
<ul>
<li>\(X_1,X_2,\dotsc,X_m,Y_1,Y_2,\dotsc,Y_n\) は
独立な確率変数列</li>
<li>\(X_1,\dotsc,X_m\) は同分布で
平均 \(\mu_1\) 分散 \(\sigma_1^2\) の正規分布に従う</li>
<li>\(Y_1,\dotsc,Y_n\) は同分布で
平均 \(\mu_2\) 分散 \(\sigma_2^2\) の正規分布に従う</li>

</ul></li>
<li>両者の平均や分散が一致するかどうかを検定する問題を考える</li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org11175d9">
<h2 id="org11175d9">平均の差の検定</h2>
<div class="outline-text-2" id="text-org11175d9">
</div>
</section>
<section id="slide-orge7f59d6">
<h3 id="orge7f59d6">平均の差の検定</h3>
<ul>
<li><p>
両側検定
</p>
<blockquote>
<p>
2種類のデータの平均が等しいか否かを検定する
</p>
</blockquote>
<ul>
<li><p>
帰無仮説と対立仮説
</p>
<blockquote>
<div>
\begin{equation}%\label{mean-equal}
  H_0:\mu_1=\mu_2\quad\text{vs}\quad H_1:\mu_1\neq\mu_2
\end{equation}

</div>
</blockquote></li>

</ul></li>
<li><b>Behrens-Fisher問題</b> 
<ul>
<li>正確かつ適切な検定を導出することは難しい</li>

</ul></li>
<li><b>Welch(またはSatterthwaite)の近似法</b>
<ul>
<li>\(\chi^2\)-分布に従う独立確率変数列の一次結合の分布を，
1つの \(\chi^2\)-分布に従う確率変数の定数倍の分布で近似する方法</li>
<li>平均と分散が元の確率変数と一致するように近似</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgf17d9d7">
<h3 id="orgf17d9d7">考え方</h3>
<ul>
<li><p>
\(X_1,\dotsc,X_m\) および \(Y_1,\dotsc,Y_m\) の不偏分散 :
\(s_1^2\),\(s_2^2\)
</p>
<blockquote>
<div>
\begin{equation}
  s_1^2=\frac{1}{m{-}1}\sum_{i=1}^m(X_i-\bar{X})^2,\quad
  s_2^2=\frac{1}{n{-}1}\sum_{i=1}^n(Y_i-\bar{Y})^2.
\end{equation}

</div>
</blockquote></li>
<li>標本平均と不偏分散の性質 :
<ul>
<li>\(\bar{X}-\bar{Y},s_1^2,s_2^2\) は独立となる</li>
<li>\((m{-}1)s_1^2/\sigma_1^2\)
は自由度 \(m{-}1\) の \(\chi^2\)-分布に従う</li>
<li>\((n{-}1)s_2^2/\sigma_2^2\)
は自由度 \(n{-}1\) の \(\chi^2\)-分布に従う</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org53f9250">
<h3 id="org53f9250">Welchの近似法</h3>
<ul>
<li><b>詳細は資料を参照</b></li>
<li>確率変数 \(s_1^2/m+s_2^2/n\) の分布を \(c\chi^2_\nu\) の分布で近似</li>
<li><p>
\(\chi^2_\nu\) は自由度 \(\nu\) の \(\chi^2\)-分布に従う確率変数
</p>
<blockquote>
<div>
\begin{equation}
  c=\frac{\frac{(\sigma_1^2/m)^2}{m{-}1}
    +\frac{(\sigma_2^2/n)^2}{n{-}1}}{\sigma_1^2/m+\sigma_2^2/n},\quad
  \nu=\frac{(\sigma_1^2/m+\sigma_2^2/n)^2}{\frac{(\sigma_1^2/m)^2}{m{-}1}
    +\frac{(\sigma_2^2/n)^2}{n{-}1}}
\end{equation}

</div>
</blockquote>
<ul>
<li>平均と分散を合わせる</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
検定統計量
</p>
<blockquote>
<div>
\begin{equation}
  t=\frac{\bar{X}-\bar{Y}}{\sqrt{s_1^2/m+s_2^2/n}}
  \simeq\frac{\bar{X}-\bar{Y}}{\sqrt{c\chi^2_\nu}}
\end{equation}

</div>
</blockquote>
<ul>
<li>\(\bar{X}-\bar{Y},s_1^2/m+s_2^2/n\) は独立</li>
<li>\(\bar{X}-\bar{Y},c\chi^2_\nu\) も独立と考える</li>
<li>\(t\) の分布は \((\bar{X}-\bar{Y})/\sqrt{c\chi^2_\nu}\) で近似できる</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org98fee95">
<h3 id="org98fee95">帰無分布の近似</h3>
<ul>
<li><p>
データの正規性から以下は標準正規分布に従う
</p>
<blockquote>
<div>
\begin{equation}
  \frac{(\bar{X}-\bar{Y})-(\mu_1{-}\mu_2)}
  {\sqrt{\sigma_1^2/m+\sigma_2^2/n}}
\end{equation}

</div>
</blockquote></li>
<li><p>
\(H_0\) の下で以下は自由度 \(\nu\) の \(t\)-分布に従う
</p>
<blockquote>
<div>
\begin{equation}
  t\simeq
  \frac{\bar{X}-\bar{Y}}{\sqrt{c\chi^2_\nu}}
  =\frac{(\bar{X}-\bar{Y})/\sqrt{\sigma_1^2/m+\sigma_2^2/n}}
  {\sqrt{\frac{c}{\sigma_1^2/m+\sigma_2^2/n}\chi^2_\nu}}
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>検定統計量 \(t\) の帰無分布は自由度 \(\nu\) の \(t\)-分布で近似できる</li>
<li><p>
\(\nu\) は未知の分散 \(\sigma_1^2,\sigma_2^2\) を含むので
不偏推定量 \(s_1^2,s_2^2\) で代用し，
自由度 \(\hat{\nu}\) は次式を用いる
</p>
<blockquote>
<div>
\begin{equation}
  \hat{\nu}
  =\frac{(s_1^2/m+s_2^2/n)^2}
  {\frac{(s_1^2/m)^2}{m{-}1}+\frac{(s_2^2/n)^2}{n{-}1}}.
\end{equation}

</div>
</blockquote></li>
<li><b>Welchの \(t\)-検定</b></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgdb90c70">
<h3 id="orgdb90c70">棄却域を用いる場合</h3>
<ul>
<li>有意水準を選択 : \(\alpha\in(0,1)\)</li>
<li><p>
棄却域
</p>
<blockquote>
<div>
\begin{equation}
  \left(-\infty,-t_{1{-}\alpha/2}(\hat{\nu})\right)
  \cup\left(t_{1{-}\alpha/2}(\hat{\nu}),\infty\right)
\end{equation}

</div>
</blockquote>
<ul>
<li>\(t_{1{-}\alpha/2}(\hat{\nu})\) :
自由度 \(\hat{\nu}\) の \(t\)-分布の \(1{-}\alpha/2\) 分位点</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>検定統計量 \(t\) の値を計算</li>
<li><p>
以下の場合は帰無仮説を棄却
</p>
<blockquote>
<div>
\begin{equation}
  |t|>t_{1{-}\alpha/2}(\hat{\nu})
\end{equation}

</div>
</blockquote>
<ul>
<li><i><span style="color:gray;">\(p\)-値の計算や片側対立仮説への対応は前と同様</span></i></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgdc11d7b">
<h3 id="orgdc11d7b">対応がある場合の平均の差の検定</h3>
<ul>
<li>対応がある観測データの平均の差の検定では
2種類のデータ間の自然な対応を考慮することがある</li>
<li><p>
<span style="color:green;">薬の投薬の例</span>
</p>
<blockquote>
<ul>
<li>2種類の薬の効能を比較するために被験者に両方の薬を投与</li>
<li>被験者 \(i\) にそれぞれの薬を投与した場合の治験結果: \(X_i,Y_i\)</li>
<li>\(X_i\) と \(Y_i\) には&ldquo;同一の被験者に対する治験結果&rdquo;という意味で対応がある</li>

</ul>
</blockquote></li>
<li>&ldquo;対応がある観測値の差の平均が0&rdquo;
という帰無仮説を考える</li>
<li>\(Z_i=X_i-Y_i\) \((i=1,\dotsc,n)\) として，
\(Z_1,\dotsc,Z_n\) の平均が0か否かを検定すれば良い</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgda7c8ce">
<h3 id="orgda7c8ce">R : \(t\)-検定の関数</h3>
<ul>
<li><p>
使い方
</p>
<div class="org-src-container">

<pre><code class="R" >t.test(x, y = NULL, # 2標本の場合
       alternative = c("two.sided", "less", "greater"),
       mu = 0, paired = FALSE, var.equal = FALSE,
       conf.level = 0.95, ...)
## x,y: ベクトル．2標本の場合はyを指定する
## alternative: 対立仮説 (両側，左片側，右片側)
## mu: 検定対象の平均値
## paired: 対応ありの場合は TRUE
## var.equal: 2標本の分散を同じとして良い場合は TRUE
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org183d504">
<h2 id="org183d504">分散の比の検定</h2>
<div class="outline-text-2" id="text-org183d504">
</div>
</section>
<section id="slide-orgf97c938">
<h3 id="orgf97c938">分散の比の検定</h3>
<ul>
<li><p>
両側検定
</p>
<blockquote>
<p>
2種類のデータの分散が等しいか否かを検定する
</p>
</blockquote>
<ul>
<li><p>
帰無仮説と対立仮説
</p>
<blockquote>
<div>
\begin{equation}
  H_0:\sigma_1^2=\sigma_2^2\quad\text{vs}\quad H_1:\sigma_1^2\neq\sigma_2^2
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org6518fd2">
<h3 id="org6518fd2">考え方</h3>
<ul>
<li>\(X_1,\dotsc,X_m\) および \(Y_1,\dotsc,Y_n\)
の不偏分散: \(s_1^2\), \(s_2^2\)

<ul>
<li>このとき \(s_1^2,s_2^2\) は独立 :
<ul>
<li>\((m{-}1)s_1^2/\sigma_1^2\)
自由度 \(m{-}1\) の \(\chi^2\)-分布に従う</li>
<li>\((n{-}1)s_2^2/\sigma_2^2\)
は自由度 \(n{-}1\) の \(\chi^2\)-分布に従う</li>

</ul></li>

</ul></li>
<li><p>
検定統計量
</p>
<blockquote>
<div>
\begin{equation}
  F=\frac{s_1^2}{s_2^2}
\end{equation}

</div>
</blockquote>
<ul>
<li>帰無分布は自由度 \(m{-}1,n{-}1\) の \(F\)-分布</li>

</ul></li>
<li><b>\(F\)-検定</b></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>\(F\)-分布</li>

</ul>
<div class="leftcol" id="orgdd745b7">

<div id="org62926a2" class="figure">
<p><img src="figs/pdf_f.png" alt="pdf_f.png" width="100%" />
</p>
<p><span class="figure-number">Figure 6: </span>\(F\)-分布 (自由度\(3,5\))</p>
</div>

</div>
<div class="rightcol" id="org18045a2">
<blockquote>
<ul>
<li>標本空間: \([0,\infty)\)</li>
<li>母数: 自由度 \(\nu_{1},\nu_{2}\)</li>
<li><p>
密度関数:
</p>
<div>
\begin{equation}
  f(x)
  =
  \frac{(\nu_{1}/\nu_{2})^{\nu_{1}/2}}{B(\nu_{1}/2,\nu_{2}/2)}
  \frac{x^{\nu_{1}/2-1}}{(1+\nu_{1}x/\nu_{2})^{(\nu_{1}+\nu_{2})/2}}
\end{equation}

</div></li>

<li>備考 :
自由度 \(k_{1},k_{2}\) の \(\chi^2\) 分布に従う
独立な確率変数の比の分布で，
分散の検定に利用される．</li>

</ul>
</blockquote>

</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org494bcac">
<h3 id="org494bcac">棄却域を用いる場合</h3>
<ul>
<li>有意水準を選択 : \(\alpha\in(0,1)\)</li>
<li><p>
\(H_0\) の下では以下が成立
</p>
<blockquote>
<div>
\begin{equation}
  P(F < F_{\alpha/2}(m{-}1,n{-}1)
  \text{ または }F > F_{1{-}\alpha/2}(m{-}1,n{-}1))=\alpha
\end{equation}

</div>
</blockquote>
<ul>
<li>\(F_{\alpha/2}(m{-}1,n{-}1)\):
自由度 \(m{-}1,n{-}1\) の \(F\) 分布の \(\alpha/2\) 分位点</li>
<li>\(F_{1{-}\alpha/2}(m{-}1,n{-}1)\):
自由度 \(m{-}1,n{-}1\) の \(F\) 分布の \(1{-}\alpha/2\) 分位点</li>

</ul></li>
<li><p>
第一種過誤の上限が \(\alpha\) の棄却域
</p>
<blockquote>
<div>
\begin{equation}
  R_{\alpha}=
  \left(-\infty,F_{\alpha/2}(m{-}1,n{-}1)\right)
  \cup\left(F_{1{-}\alpha/2}(m{-}1,n{-}1),\infty\right)
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>データから検定統計量 \(F\) の値を計算</li>
<li><p>
以下の場合，帰無仮説を棄却
</p>
<blockquote>
<div>
\begin{equation}
  F < F_{\alpha/2}(m{-}1,n{-}1)
  \text{ または }F>F_{1{-}\alpha/2}(m{-}1,n{-}1)
\end{equation}

</div>
</blockquote>
<ul>
<li><i><span style="color:gray;">\(p\)-値の計算や片側対立仮説への対応は前と同様</span></i></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org8e4a897">
<h3 id="org8e4a897">R : \(F\)-検定の関数</h3>
<ul>
<li><p>
使い方
</p>
<div class="org-src-container">

<pre><code class="R" >var.test(x, y, ratio = 1,
	 alternative = c("two.sided", "less", "greater"),
	 conf.level = 0.95, ...)
## x,y: ベクトル． 
## ratio: 検定する比率(1は同じかどうか)
## alternative: 対立仮説 (両側，左片側，右片側)
## conf.level: 信頼区間の水準 (点推定・区間推定も行ってくれる)
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org6ece094" data-background="#fef4f4">
<h2 id="org6ece094">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgf63aa85" data-background="#fef4f4">
<h3 id="orgf63aa85">練習問題</h3>
<ul>
<li>東京の気象データの気温の項目を用いて，
7月と8月の気温の平均が同じかどうか検定しなさい．</li>
<li>同様に3月と6月の気温の分散が同じかどうか検定しなさい．</li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-orgb881d04">
<h2 id="orgb881d04">次回の予定</h2>
<ul>
<li>分散分析とは</li>
<li>一元配置
<ul>
<li>一元配置のモデル</li>
<li>検定の構成</li>

</ul></li>
<li>二元配置
<ul>
<li>二元配置のモデル</li>
<li>検定の構成</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/highlight/highlight.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,
overview: true,

transition: 'fade',
transitionSpeed: 'default',
spotlight: { size: 90, initialPresentationMode: false }, chalkboard: { toggleChalkboardButton: { left: '80px' }, toggleNotesButton: { left: '130px'}}, keyboard: { 69: function() { RevealChalkboard.toggleNotesCanvas() }, 87: function() { RevealChalkboard.toggleChalkboard() }, 67: function() { RevealChalkboard.clear() }, 82: function() { RevealChalkboard.reset() }, 68: function() { RevealChalkboard.download() }, 88: function() { RevealChalkboard.colorNext() }, 89: function() { RevealChalkboard.colorPrev() }, 84: function() { RevealSpotlight.toggleSpotlight() }, 81: function() { RevealSpotlight.togglePresentationMode()}},

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealHighlight ],

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/menu/menu.js'},
{ src: './reveal.js/plugin/chalkboard/chalkboard.js'},
{ src: './reveal.js/plugin/spotlight/spotlight.js'}]

});
</script>
</body>
</html>
