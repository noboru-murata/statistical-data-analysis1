<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>推定</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/menu/menu.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/menu/font-awesome/css/fontawesome.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/chalkboard/style.css"/>

<link rel="stylesheet" href="./reveal.js/local/mycourse.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">推定</h1>
</div>
<div class="talk-subtitle">
    <p>第10講 - 確率分布を特徴づけるパラメタを推測する</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  </p>
</div>

</section>
<section>
<section id="slide-org84a5ae9">
<h2 id="org84a5ae9">講義概要</h2>
<ul>
<li>点推定
<ul>
<li>不偏推定量</li>
<li>Cramér-Raoの不等式</li>

</ul></li>
<li>最尤推定量</li>
<li>区間推定
<ul>
<li>信頼区間</li>
<li>正規母集団の区間推定</li>
<li>漸近正規性にもとづく区間推定</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-org5b56d9c">
<h2 id="org5b56d9c">推定とは</h2>
<div class="outline-text-2" id="text-org5b56d9c">
</div>
</section>
<section id="slide-org75895cd">
<h3 id="org75895cd">統計解析の目的</h3>
<ul>
<li>観測データを確率変数の実現値と考えてモデル化</li>
<li>観測データの背後の確率分布を <b>推定</b>
<ul>
<li>分布のもつ特性量(平均や分散など)を評価する</li>
<li>分布そのもの(確率関数や確率密度)を決定する</li>

</ul></li>
<li>統計学で広く利用されている推定方法を説明
<ul>
<li><b>点推定</b></li>
<li><b>区間推定</b></li>

</ul></li>

</ul>
</section>
<section id="slide-orge70cd0e">
<h3 id="orge70cd0e">推定の標準的な枠組</h3>
<ul>
<li>観測データは独立同分布な確率変数列 \(X_1,X_2,\dots,X_n\)</li>
<li>\(X_i\) の従う共通の法則 \(\mathcal{L}\) を想定
<ul>
<li>\(\mathcal{L}\) として全ての分布を考察対象とすることは困難
<ul>
<li>対象とする範囲が広くなりすぎる</li>
<li>データ数 \(n\) が大きくないと意味のある結論を導き出せない</li>

</ul></li>
<li>確率分布 \(\mathcal{L}\) を特徴づけるパラメタ \(\theta\) を考察対象
<ul>
<li>\(\mathcal{L}\) の平均・分散・歪度・尖度など</li>
<li>\(\mathcal{L}\) の確率関数・確率密度関数のパラメタ</li>

</ul></li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-org1495836">
<h2 id="org1495836">点推定</h2>
<div class="outline-text-2" id="text-org1495836">
</div>
</section>
<section id="slide-org069a6e5">
<h3 id="org069a6e5">点推定</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
\(\mathcal{L}\) 
に含まれるパラメタ \(\theta\) を \(X_1,\dotsc,X_n\) の関数
</p>
<div>
\begin{equation}
  \hat{\theta}=\hat{\theta}(X_1,\dots,X_n)
\end{equation}

</div>
<p>
で推定することで，
\(\hat{\theta}\) を \(\theta\) の <b>推定量</b> と呼ぶ．
</p>
</blockquote></li>
<li>記述統計量は分布のパラメタの1つ</li>
<li><p>
<span style="color:green;">推定量の例</span>
</p>
<blockquote>
<p>
\(\mathcal{L}\) の平均 \(\mu\) を
標本平均 \(\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i\) によって
推定することが点推定であり,
\(\bar{X}\) は \(\mu\) の推定量となる．
</p>
</blockquote></li>

</ul>
</section>
<section id="slide-org264d2c5">
<h3 id="org264d2c5">良い推定量</h3>
<ul>
<li>一般に1つのパラメタの推定量は無数に存在</li>
<li>推定量の良さの代表的な基準 : <b>不偏性・一致性</b>
<ul>
<li><p>
\(\hat{\theta}\) が \(\theta\) の不偏推定量
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}[\hat{\theta}]=\theta
\end{equation}

</div>
</blockquote></li>
<li><p>
\(\hat{\theta}\) が \(\theta\) の(強)一致推定量
</p>
<blockquote>
<div>
\begin{equation}
  \text{\(\hat{\theta}\) が \(\theta\) に収束する確率が1}\quad (n\to\infty)
\end{equation}

</div>
</blockquote></li>
<li><p>
<span style="color:green;">良い推定量の例</span>
</p>
<blockquote>
<p>
標本平均, 不偏分散はそれぞれ
\(\mathcal{L}\) の平均, 分散の不偏かつ一致性をもつ推定量
</p>
</blockquote></li>

</ul></li>

</ul>
</section>
<section id="slide-org8eaf7eb">
<h3 id="org8eaf7eb">良い不偏推定量</h3>
<ul>
<li><p>
一般に不偏推定量も複数存在
</p>
<blockquote>
<p>
<span style="color:green;">例: \(\mathcal{L}\) の平均 \(\mu\) の不偏推定量</span>
</p>
<ul>
<li>標本平均 \(\bar{X}\)</li>
<li>\(X_1,\dots,X_n\) のメディアン
( \(\mathcal{L}\) が \(x=\mu\) に関して対称な場合)</li>
<li>\(X_1\)
(最初の観測データだけ信じる極端な例)</li>

</ul>
</blockquote></li>
<li>不偏推定量の良さを評価する基準が必要</li>
<li><p>
<b>一様最小分散不偏推定量</b> 
</p>
<blockquote>
<p>
\(\theta\) の任意の不偏推定量 \(\hat{\theta}'\) 
に対して推定値のばらつき(分散)が最も小さいもの
</p>
<div>
\begin{equation}
  \mathrm{Var}(\hat{\theta})\le\mathrm{Var}(\hat{\theta}')
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-orge72d024">
<h3 id="orge72d024">Cramér-Rao の不等式</h3>
<ul>
<li><p>
定理
</p>
<blockquote>
<p>
\(\mathcal{L}\) は1次元パラメタ \(\theta\) を含む連続分布とし，
その確率密度関数 \(f_\theta(x)\) は \(\theta\) に関して
偏微分可能であるとする．
このとき，緩やかな仮定の下で，
\(\theta\) の任意の不偏推定量 \(\hat{\theta}\) に対して
以下の不等式が成り立つ．
</p>
<div>
\begin{equation}%\label{cr-bound}
  \mathrm{Var}(\hat{\theta})\ge \frac{1}{nI(\theta)},
\end{equation}

</div>
<p>
ただし
</p>
<div>
\begin{equation}
  I(\theta)=\int_{-\infty}^\infty
  \left(\frac{\partial}{\partial\theta}\log f_\theta(x)\right)^2
  f_\theta(x)dx.
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-orge76f9d5">
<h3 id="orge76f9d5">一様最小分散不偏推定量</h3>
<ul>
<li>用語の定義
<ul>
<li>下界 \(1/nI(\theta)\) : <b>Cramér-Rao 下界</b></li>
<li>\(I(\theta)\) : <b>Fisher 情報量</b></li>

</ul></li>
<li><p>
定理 (Cramér-Rao の不等式の系)
</p>
<blockquote>
<p>
\(\theta\) の不偏推定量 \(\hat{\theta}\) で
分散が Cramér-Rao 下界 \(1/nI(\theta)\) に一致するものが存在すれば，
それは一様最小分散不偏推定量となる．
</p>
</blockquote></li>

</ul>
</section>
<section id="slide-org17a7411">
<h3 id="org17a7411">例 : 正規分布モデルの標本平均</h3>
<ul>
<li>\(\mathcal{L}\) は平均 \(\mu\) , 分散 \(\sigma^2\) の正規分布
<ul>
<li><p>
平均パラメタ \(\mu\) に関するFisher情報量 :
</p>
<blockquote>
<div>
\begin{align}
  I(\mu)=\frac{1}{\sqrt{2\pi\sigma^2}}
  \int_{-\infty}^\infty\frac{(x-\mu)^2}{\sigma^4}
  e^{-\frac{(x-\mu)^2}{2\sigma^2}}dx
  =\frac{1}{\sigma^2}
\end{align}

</div>
</blockquote></li>
<li>Cramér-Rao下界 : \(\sigma^2/n\)</li>
<li>標本平均 \(\bar{X}\) の分散 : \(\sigma^2/n\) (=Cramér-Rao下界)</li>

</ul></li>
<li>\(\bar{X}\) は \(\mu\) の一様最小分散不偏推定量</li>

</ul>
</section>
</section>
<section>
<section id="slide-orge05fcc5" data-background="#fef4f4">
<h2 id="orge05fcc5">実習</h2>
</section>
<section id="slide-org70442fe" data-background="#fef4f4">
<h3 id="org70442fe">練習問題</h3>
<ul>
<li>\(X\) を一様乱数に従う確率変数とし，
平均値の推定量として以下を考える．
それぞれの推定量の分散を比較しなさい．
<ul>
<li>標本平均 (mean)</li>
<li>中央値 (median)</li>
<li>最大値と最小値の平均 ((max+min)/2)</li>

</ul></li>
<li><p>
ヒント : 以下のような関数を作り，Monte-Carlo実験を行えばよい
</p>
<div class="org-src-container">

<pre class="src src-R"><span style="color: #b77fdb; font-weight: bold;">estimate_means</span> <span style="color: #60aa00;">&lt;-</span> <span style="color: #6c9ef8;">function</span>(n, min, max){ <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#35251;&#28204;&#12487;&#12540;&#12479;&#25968;</span>
  x <span style="color: #60aa00;">&lt;-</span> runif(n, min=min, max=max) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#19968;&#27096;&#20081;&#25968;&#12434;&#29983;&#25104;&#65292;&#31684;&#22258;&#12399;&#24341;&#25968;&#12363;&#12425;</span>
  <span style="color: #6c9ef8;">return</span>(c(xbar=mean(x),med=median(x),mid=(max(x)+min(x))/2))
} <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">3&#12388;&#12414;&#12392;&#12417;&#12390;&#35336;&#31639;&#12377;&#12427;&#38306;&#25968;</span>
</pre>
</div></li>

</ul>
</section>
</section>
<section>
<section id="slide-org2ff90e6">
<h2 id="org2ff90e6">最尤法</h2>
<div class="outline-text-2" id="text-org2ff90e6">
</div>
</section>
<section id="slide-orgb5bf5b2">
<h3 id="orgb5bf5b2">離散分布の場合</h3>
<ul>
<li>観測値 \(X_1=x_1,X_2=x_2,\dots,X_n=x_n\) の同時確率
<ul>
<li>確率(質量)関数 : \(f_{\boldsymbol{\theta}}(x)\)</li>
<li>確率関数のパラメタ : \(\boldsymbol{\theta}=(\theta_1,\dots,\theta_p)\)</li>
<li><p>
独立な確率変数の同時確率 :
</p>
<blockquote>
<div>
\begin{align}
  & P(X_1=x_1,X_2=x_2,\dots,X_n=x_n)
    =\prod_{i=1}^nP(X_i=x_i)\\
  &=
    \prod_{i=1}^nf_{\boldsymbol{\theta}}(x_i)
    =f_{\boldsymbol{\theta}}(x_1)\cdot
    f_{\boldsymbol{\theta}}(x_2)\cdots
    f_{\boldsymbol{\theta}}(x_n)
\end{align}

</div>
</blockquote></li>

</ul></li>

</ul>
</section>
<section id="slide-org0b56fb1">
<h3 id="org0b56fb1">尤度関数</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
パラメタ \(\boldsymbol{\theta}\) に対して
観測データ \(X_1,X_2,\dots,X_n\) が得られる理論上の確率
</p>
<div>
\begin{equation}
  L(\boldsymbol{\theta})
  =\prod_{i=1}^nf_{\boldsymbol{\theta}}(X_i)
\end{equation}

</div>
<p>
を
\(\boldsymbol{\theta}\) の 
<b>尤度</b> と言い，
\(\boldsymbol{\theta}\) の関数 \(L\) を <b>尤度関数</b> と呼ぶ．
</p>
</blockquote>
<ul>
<li>観測データ 
\(X_1,X_2,\dots,X_n\) 
が現れるのにパラメタ 
\(\boldsymbol{\theta}\) 
の値がどの程度尤もらしいかを測る尺度</li>

</ul></li>

</ul>
</section>
<section id="slide-org71243da">
<h3 id="org71243da">最尤法</h3>
<ul>
<li><p>
最尤法
</p>
<blockquote>
<p>
観測データに対して「最も尤もらしい」パラメタ値
を \(\boldsymbol{\theta}\) の推定量として採用する方法
を最尤法という．
</p>
</blockquote></li>
<li><p>
最尤推定量
</p>
<blockquote>
<p>
\(\Theta\) を尤度関数の定義域として，
尤度関数を最大とする  \(\hat{\boldsymbol{\theta}}\) 
</p>
<div>
\begin{equation}
  L(\hat{\boldsymbol{\theta}})
  =\max_{\boldsymbol{\theta}\in\Theta}L(\boldsymbol{\theta}).
\end{equation}

</div>
<p>
を 
\(\boldsymbol{\theta}\) 
の <b>最尤推定量</b> という．以下のように書くこともある．
</p>
<div>
\begin{equation}
  \hat{\boldsymbol{\theta}}
  =\arg\max_{\boldsymbol{\theta}\in\Theta}L(\boldsymbol{\theta}).
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-org08965d7">
<h3 id="org08965d7">最尤推定量の計算</h3>
<ul>
<li><p>
<b>対数尤度関数</b>
</p>
<blockquote>
<div>
\begin{equation}
  \ell(\boldsymbol{\theta})
  =\log L(\boldsymbol{\theta})
  =\sum_{i=1}^n\log f_{\boldsymbol{\theta}}(X_i).
\end{equation}

</div>
</blockquote>
<ul>
<li>対数関数は狭義単調増加</li>
<li>\(\ell(\boldsymbol{\theta})\) の最大化と \(L(\boldsymbol{\theta})\) の最大化は同義</li>
<li>扱い易い和の形なのでこちらを用いることが多い</li>
<li>大数の法則を用いて対数尤度関数の収束が議論できる</li>

</ul></li>
<li><p>
最尤推定量の性質
</p>
<blockquote>
<p>
広い範囲の確率分布に対して最尤推定量は <b>一致性</b> を持つ
</p>
</blockquote></li>

</ul>
</section>
<section id="slide-org4de351f">
<h3 id="org4de351f">連続分布の場合</h3>
<ul>
<li><b>確率密度関数</b> \(f_{\boldsymbol{\theta}}(x)\) を用いて尤度を定義</li>
<li><p>
<b>尤度関数</b>
</p>
<blockquote>
<div>
\begin{equation}
  L(\boldsymbol{\theta})
  =\prod_{i=1}^nf_{\boldsymbol{\theta}}(x_i)
  =f_{\boldsymbol{\theta}}(x_1)\cdot
  f_{\boldsymbol{\theta}}(x_2)\cdots
  f_{\boldsymbol{\theta}}(x_n)
\end{equation}

</div>
</blockquote></li>
<li><p>
<b>対数尤度関数</b>
</p>
<blockquote>
<div>
\begin{equation}
  \ell(\boldsymbol{\theta})
  =\log L(\boldsymbol{\theta})
  =\sum_{i=1}^n\log f_{\boldsymbol{\theta}}(X_i)
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-org90806fe">
<h3 id="org90806fe">例 : Poisson 分布の最尤推定</h3>
<ul>
<li>\(\mathcal{L}\) をパラメタ \(\lambda>0\) のPoisson分布でモデル化
<ul>
<li><p>
確率質量関数
</p>
<blockquote>
<div>
\begin{equation}
  f(x)=\frac{\lambda^x}{x!}e^{-\lambda},\quad x=0,1,\dotsc
\end{equation}

</div>
</blockquote></li>
<li><p>
対数尤度関数 (未知パラメタ : \(\lambda\) )
</p>
<blockquote>
<div>
\begin{equation}
  \ell(\lambda)=\sum_{i=1}^n\log\frac{\lambda^{X_i}}{X_i!}e^{-\lambda}
  =\sum_{i=1}^n(X_i\log\lambda-\log X_i!)-n\lambda
\end{equation}

</div>
</blockquote></li>
<li>少なくとも1つの \(i\) について \(X_i>0\) を仮定する</li>

</ul></li>

</ul>

</section>
<section>
<ul>
<li>(Poisson分布のつづき)
<ul>
<li><p>
\(\ell(\lambda)\) の微分
</p>
<blockquote>
<div>
\begin{equation}
  \ell'(\lambda)=\frac{1}{\lambda}\sum_{i=1}^nX_i-n,\quad
  \ell''(\lambda)=-\frac{1}{\lambda^2}\sum_{i=1}^nX_i<0
\end{equation}

</div>
</blockquote></li>
<li>方程式 \(\ell'(\lambda)=0\) の解が \(\ell(\lambda)\) を最大化</li>
<li><p>
\(\lambda\) の最尤推定量
</p>
<blockquote>
<div>
\begin{equation}
  \hat{\lambda}=\frac{1}{n}\sum_{i=1}^nX_i
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>
</section>
<section id="slide-orgcf1be61">
<h3 id="orgcf1be61">例 : 指数分布の最尤推定</h3>
<ul>
<li>\(\mathcal{L}\) をパラメタ \(\lambda>0\) の指数分布でモデル化
<ul>
<li><p>
確率密度関数
</p>
<blockquote>
<div>
\begin{equation}
  f(x)=
  \begin{cases}
    \lambda e^{-\lambda x}&(x>0)\\
    0&(x\leq0)
  \end{cases}
\end{equation}

</div>
</blockquote></li>
<li><p>
対数尤度関数 (未知パラメタ : \(\lambda\) )
</p>
<blockquote>
<div>
\begin{equation}
  \ell(\lambda)=\sum_{i=1}^n\log\lambda e^{-\lambda X_i}
  =n\log\lambda-\lambda\sum_{i=1}^nX_i
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>

</section>
<section>
<ul>
<li>(指数分布のつづき)
<ul>
<li><p>
\(\ell(\lambda)\) の微分
</p>
<blockquote>
<div>
\begin{equation}
  \ell'(\lambda)=\frac{n}{\lambda}-\sum_{i=1}^nX_i,\quad
  \ell''(\lambda)=-\frac{n}{\lambda^2}<0
\end{equation}

</div>
</blockquote></li>
<li>方程式 \(\ell'(\lambda)=0\) の解が \(\ell(\lambda)\) を最大化</li>
<li><p>
\(\lambda\) の最尤推定量
</p>
<blockquote>
<div>
\begin{equation}
  \hat{\lambda}=\frac{1}{\frac{1}{n}\sum_{i=1}^nX_i}
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>
</section>
<section id="slide-orgba8b72f">
<h3 id="orgba8b72f">例 : ガンマ分布の最尤推定</h3>
<ul>
<li>\(\mathcal{L}\) をパラメタ \(\nu,\alpha>0\) のガンマ分布でモデル化
<ul>
<li><p>
確率密度関数
</p>
<blockquote>
<div>
\begin{equation}
  f(x)=
  \begin{cases}
    \frac{\alpha^\nu }{\Gamma(\nu)}
    x^{\nu-1}e^{-\alpha x}&(x>0)\\
    0&(x\leq0)
  \end{cases}
\end{equation}

</div>
</blockquote>
<p>
ただしガンマ関数 \(\Gamma(\nu)\) は以下で定義される
</p>
<blockquote>
<div>
\begin{equation}
  \Gamma(\nu)=\int_0^\infty x^{\nu-1}e^{-x}dx
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>

</section>
<section>
<ul>
<li>(ガンマ分布のつづき)
<ul>
<li><p>
対数尤度関数 (未知パラメタ : \(\nu,\alpha\) )
</p>
<blockquote>
<div>
\begin{align}
  \ell(\nu,\alpha)
  &=\sum_{i=1}^n\log\frac{\alpha^\nu}{\Gamma(\nu)}X_i^{\nu-1}e^{-\alpha X_i}\\
  &=n\nu\log\alpha-n\log\Gamma(\nu)+\sum_{i=1}^n\{(\nu-1)\log X_i-\alpha X_i\}
\end{align}

</div>
</blockquote></li>
<li>\(\ell(\nu,\alpha)\) を最大化する \(\nu,\alpha\) は解析的に求まらないので実際の計算では数値的に求める</li>

</ul></li>

</ul>

</section>
<section>
<ul>
<li><p>
<span style="color:green;">Rでの計算例</span> (ガンマ分布の最尤推定量)
</p>
<div class="org-src-container">

<pre class="src src-R"><span style="color: #60aa00;">library</span>(<span style="color: #d08928;">"stats4"</span>) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#38306;&#25968;mle&#12434;&#21033;&#29992;&#12377;&#12427;&#12383;&#12417;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> &#25968;&#20516;&#26368;&#36969;&#21270;&#12398;&#12383;&#12417;&#12395;&#12399;&#23588;&#24230;&#38306;&#25968;&#12434;&#26368;&#21021;&#12395;&#35413;&#20385;&#12377;&#12427;&#21021;&#26399;&#20516;&#12364;&#24517;&#35201;</span>
<span style="color: #b77fdb; font-weight: bold;">mle.gamma</span> <span style="color: #60aa00;">&lt;-</span> <span style="color: #6c9ef8;">function</span>(x, <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#35251;&#28204;&#12487;&#12540;&#12479;</span>
                      nu0 = 1, alpha0 = 1){ <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">nu, alpha&#12398;&#21021;&#26399;&#20516;</span>
    <span style="color: #808080; font-style: italic;">## </span><span style="color: #808080; font-style: italic;">&#36000;&#12398;&#23550;&#25968;&#23588;&#24230;&#38306;&#25968;&#12434;&#23450;&#32681; (&#26368;&#23567;&#21270;&#12434;&#32771;&#12360;&#12427;&#12383;&#12417;)</span>
    <span style="color: #b77fdb; font-weight: bold;">ll</span> <span style="color: #60aa00;">&lt;-</span> <span style="color: #6c9ef8;">function</span>(nu, alpha) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">nu&#12392;alpha&#12398;&#38306;&#25968;&#12392;&#12375;&#12390;&#23450;&#32681; </span>
        suppressWarnings(-sum(dgamma(x, nu, alpha, log = <span style="color: #00aa80;">TRUE</span>)))
    <span style="color: #808080; font-style: italic;">## </span><span style="color: #808080; font-style: italic;">suppressWarnings &#12399;&#23450;&#32681;&#22495;&#22806;&#12391;&#35413;&#20385;&#12373;&#12428;&#12383;&#38555;&#12398;&#35686;&#21578;&#12434;&#34920;&#31034;&#12373;&#12379;&#12394;&#12356;</span>
    <span style="color: #808080; font-style: italic;">## </span><span style="color: #808080; font-style: italic;">&#26368;&#23588;&#25512;&#23450;(&#36000;&#12398;&#23588;&#24230;&#12398;&#26368;&#23567;&#21270;)</span>
    est <span style="color: #60aa00;">&lt;-</span> mle(minuslogl = ll,   <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#36000;&#12398;&#23550;&#25968;&#23588;&#24230;&#38306;&#25968;</span>
               start = list(nu = nu0, alpha = alpha0), <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#21021;&#26399;&#20516;</span>
               method = <span style="color: #d08928;">"BFGS"</span>,  <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#26368;&#36969;&#21270;&#26041;&#27861; (&#36984;&#25246;&#21487;&#33021;)</span>
               nobs = length(x)) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#35251;&#28204;&#12487;&#12540;&#12479;&#25968;</span>
    <span style="color: #6c9ef8;">return</span>(coef(est)) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#25512;&#23450;&#20516;&#12398;&#12415;&#36820;&#12377;</span>
}
</pre>
</div></li>

</ul>
</section>
</section>
<section>
<section id="slide-orgab810b0" data-background="#fef4f4">
<h2 id="orgab810b0">演習</h2>
</section>
<section id="slide-orgc1c5f7f" data-background="#fef4f4">
<h3 id="orgc1c5f7f">練習問題</h3>
<ul>
<li>東京都の気候データ (<code>tokyo_weather.csv</code>) の
風速 (<code>wind</code>) の項目について以下の問に答えよ．

<ul>
<li>全データを用いてヒストグラム(密度)を作成しなさい．</li>
<li>ガンマ分布でモデル化して最尤推定を行いなさい．</li>
<li>推定した結果をヒストグラムに描き加えて比較しなさい．</li>

</ul></li>
<li>自身で収集したデータを用いて，モデル化と最尤推定を試みよ．</li>

</ul>
</section>
</section>
<section>
<section id="slide-org58996aa">
<h2 id="org58996aa">区間推定</h2>
<div class="outline-text-2" id="text-org58996aa">
</div>
</section>
<section id="slide-org7fe62ec">
<h3 id="org7fe62ec">推定誤差</h3>
<ul>
<li>推定量 \(\hat{\theta}\) には推定誤差が必ず存在</li>
<li>推定結果の定量評価には推定誤差の評価が重要
<ul>
<li><p>
&ldquo;誤差 \(\hat{\theta}-\theta\) が
区間 \([l,u]\) の内側にある確率が \(1{-}\alpha\) 以上 &rdquo; <br />
</p>
<blockquote>
<div>
\begin{equation}
  P(l\le\hat{\theta}-\theta\le u)\ge 1{-}\alpha
\end{equation}

</div>
</blockquote></li>
<li>&ldquo;外側にある確率が \(\alpha\) 以下&rdquo; と言い換えてもよい</li>

</ul></li>
<li>パラメタの範囲の推定に書き換え
<ul>
<li><p>
&ldquo; \(\theta\) が含まれる確率が \(1{-}\alpha\) 以上となる区間
\([\hat{\theta}-u,\hat{\theta}-l]\) &rdquo;
</p>
<blockquote>
<div>
\begin{equation}
  P(\hat{\theta}-u\le\theta\le \hat{\theta}-l)\ge 1{-}\alpha
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>
</section>
<section id="slide-orgcb2bb80">
<h3 id="orgcb2bb80">区間推定</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
区間推定とは
未知パラメタ \(\theta\) とある値 \(\alpha\in(0,1)\) に対して
以下を満たす確率変数 \(L,U\) を観測データから求めることをいう．
</p>
<div>
\begin{equation}
  P(L\le\theta\le U)\ge 1{-}\alpha
\end{equation}

</div>
</blockquote>
<ul>
<li>区間 \([L,U]\) : \(1{-}\alpha\) <b>信頼区間</b> (\(100(1{-}\alpha)\) % と書くことも多い)</li>
<li>\(L\) : \(1{-}\alpha\) <b>下側信頼限界</b></li>
<li>\(U\) : \(1{-}\alpha\) <b>上側信頼限界</b></li>
<li>\(1{-}\alpha\) : <b>信頼係数</b>
(\(\alpha=0.01,0.05,0.1\) とすることが多い)</li>

</ul></li>

</ul>
</section>
<section id="slide-orgd008efc">
<h3 id="orgd008efc">信頼区間の性質</h3>
<ul>
<li>信頼区間は幅が狭いほど推定精度が良い
<ul>
<li>真のパラメタが取りうる値の範囲を限定することになるため</li>

</ul></li>
<li><p>
最も推定精度の良い \(1{-}\alpha\) 信頼区間 \([L,U]\)
</p>
<blockquote>
<div>
\begin{equation}
  P(L\le\theta\le U)=1{-}\alpha
\end{equation}

</div>
</blockquote>
<ul>
<li>信頼区間の幅が狭いほど \(P(L\le\theta\le U)\) は小さくなるため</li>

</ul></li>
<li>実行可能である限り
\(1{-}\alpha\) 信頼区間 \([L,U]\) は上式を満たすように
\(L,U\) を決定する</li>

</ul>
</section>
</section>
<section>
<section id="slide-org4698c08">
<h2 id="org4698c08">正規母集団の区間推定</h2>
<div class="outline-text-2" id="text-org4698c08">
</div>
</section>
<section id="slide-org549ccf5">
<h3 id="org549ccf5">平均の区間推定 (分散既知)</h3>
<ul>
<li>正規分布に従う独立な確率変数の重み付き和は正規分布に従う</li>
<li><p>
一般の場合
</p>
<blockquote>
<p>
\(Z_1,Z_2,\dots,Z_k\) を独立な確率変数列とし，
各 \(i=1,2,\dots,k\) に対して \(Z_i\) は平均 \(\mu_i\) ，
分散 \(\sigma_i^2\) の正規分布に従うとする．
このとき \(a_0,a_1,\dots,a_k\) を \((k+1)\) 個の0でない実数とすると，
\(a_0+\sum_{i=1}^ka_iZ_i\) は
平均 \(a_0+\sum_{i=1}^ka_i\mu_i\) ，
分散 \(\sum_{i=1}^ka_i^2\sigma_i^2\) の正規分布に従う．
</p>
</blockquote></li>

</ul>

</section>
<section>
<ul>
<li><p>
同分布の場合
</p>
<blockquote>
<p>
\(k=n\), \(\mu_i=\mu\), \(\sigma_i^2=\sigma^2\), \(a_0=0\),
\(a_i=1/n\;(i=1,\dots,n)\)
</p>
<div>
\begin{equation}
  \bar{X}=\frac{1}{n}\sum_{i=1}^nX_i \quad\text{(標本平均)}
\end{equation}

</div>
<p>
は平均 \(\mu\) , 分散 \(\sigma^2/n\) の正規分布に従う．
</p>
</blockquote></li>

</ul>

</section>
<section>
<ul>
<li><p>
同分布を標準化した場合
</p>
<blockquote>
<p>
\(k=1\) , \(\mu_1=\mu\) , \(\sigma_1^2=\sigma^2/n\) ,
\(a_0=-\sqrt{n}\mu/\sigma\) , \(a_1=\sqrt{n}/\sigma\)
</p>
<div>
\begin{equation}
  Z=\frac{\sqrt{n}(\bar{X}-\mu)}{\sigma}
\end{equation}

</div>
<p>
は標準正規分布に従う．
</p>
</blockquote></li>
<li><p>
標準正規分布の \(\alpha\) 分位点
</p>
<blockquote>
<p>
\(0<\alpha<1\) に対して，標準正規分布に従う確率変数を \(X\) としたとき，
</p>
<div>
\begin{equation}
  P(X\leq z_\alpha)=\alpha
\end{equation}

</div>
<p>
を満たす実数 \(z_{\alpha}\) のこと．
</p>
</blockquote></li>

</ul>

</section>
<section>

<div id="org6d3ab9d" class="figure">
<p><img src="figs/z_quantile.png" alt="z_quantile.png" height="100%" />
</p>
</div>

</section>
<section>
<ul>
<li><p>
標準化した確率変数の確率
</p>
<blockquote>
<p>
\(z_{1{-}\alpha/2}\) を標準正規分布の
\(1{-}\alpha/2\) 分位点とすれば
</p>
<div>
\begin{equation}
  P\Bigl(-z_{1{-}\alpha/2}\le\frac{\sqrt{n}(\bar{X}-\mu)}{\sigma}
  \le z_{1{-}\alpha/2}\Bigr)=1{-}\alpha
\end{equation}

</div>
</blockquote>
<ul>
<li>区間の外側(正負両側にある)の確率が\(\alpha\)となる</li>

</ul></li>

</ul>

</section>
<section>

<div id="org3329e90" class="figure">
<p><img src="figs/z_conf.png" alt="z_conf.png" height="100%" />
</p>
</div>

</section>
<section>
<ul>
<li><p>
信頼区間の構成
</p>
<blockquote>
<p>
\(\mu\) について解くと
</p>
<div>
\begin{equation}
  P\left(\bar{X}-z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}}\le\mu
    \le\bar{X}+z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}}\right)=1{-}\alpha
\end{equation}

</div>
<p>
となるので，
\(\sigma\) が既知の場合の平均 \(\mu\) の \(1{-}\alpha\) <b>信頼区間</b> は
以下で構成される．
</p>
<div>
\begin{equation}
  \left[\bar{X}-z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}},\;
    \bar{X}+z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}}\right]
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-org63f3fd9">
<h3 id="org63f3fd9">平均の区間推定 (分散未知)</h3>
<ul>
<li><p>
\(\chi^2\) 分布の特徴付け
</p>
<blockquote>
<p>
標準正規分布に従う \(k\) 個の独立な確率変数の
二乗和は自由度 \(k\) の \(\chi^2\) 分布に従う
</p>
</blockquote></li>
<li><p>
\(t\) 分布の特徴付け
</p>
<blockquote>
<p>
\(Z\) を標準正規分布に従う確率変数，
\(Y\) を自由度 \(k\) の \(\chi^2\) 分布に従う確率変数とし，
\(Z,Y\) は独立であるとする．
このとき確率変数
</p>
<div>
\begin{equation}
  \frac{Z}{\sqrt{Y/k}}
\end{equation}

</div>
<p>
は自由度 \(k\) の \(t\) 分布に従う
</p>
</blockquote></li>

</ul>

</section>
<section>
<ul>
<li>\(\chi^{2}\) 分布</li>

</ul>
<div class="leftcol" id="org79076b7">

<div id="org76de153" class="figure">
<p><img src="figs/pdf_chisq.png" alt="pdf_chisq.png" width="100%" />
</p>
<p><span class="figure-number">Figure 1: </span>\(\chi^{2}\) 分布 (自由度\(3\))</p>
</div>

</div>
<div class="rightcol" id="orgf0af3a5">
<blockquote>
<ul>
<li>見本空間 : \([0,\infty)\)</li>
<li>母数 : 自由度 \(\nu\)</li>
<li><p>
密度関数 :
</p>
<div>
\begin{multline}
  f(x)=
  \frac{1}{2^{\nu/2}\Gamma(\frac{\nu}{2})}x^{\nu/2-1}e^{-x/2}\\
  \Gamma(z)=\int_0^\infty e^{-t}t^{z-1}dt
\end{multline}

</div>
<ul>
<li>備考 : \(\nu\) 個の標準正規分布に従う確率変数の2乗和の分布で，
区間推定や検定に利用される．</li>

</ul></li>

</ul>
</blockquote>

</div>

</section>
<section>
<ul>
<li>\(t\) 分布</li>

</ul>
<div class="leftcol" id="org4cae237">

<div id="orge900840" class="figure">
<p><img src="figs/pdf_t.png" alt="pdf_t.png" width="100%" />
</p>
<p><span class="figure-number">Figure 2: </span>\(t\) 分布 (自由度\(3\))</p>
</div>

</div>
<div class="rightcol" id="org5fbea91">
<blockquote>
<ul>
<li>見本空間 : \((-\infty,\infty)\)</li>
<li>母数 : 自由度 \(\nu\)</li>
<li><p>
密度関数 :
</p>
<div>
\begin{equation}
  f(x)=
  \frac{\Gamma\left(\frac{\nu+1}{2}\right)}
  {\sqrt{\nu\pi}\;\Gamma\left(\frac{\nu}{2}\right)}
  \left(1+\frac{x^{2}}{\nu}\right)^{-\frac{1}{2}(\nu+1)}
\end{equation}

</div>
<ul>
<li>備考 : 標準正規分布と
自由度 \(\nu\) の \(\chi^{2}\) 分布
に従う確率変数の比に関する分布で，
区間推定や検定に利用される．</li>

</ul></li>

</ul>
</blockquote>

</div>

</section>
<section>
<ul>
<li><p>
標本平均と不偏分散の性質
</p>
<blockquote>
<p>
\(X_1,X_2,\dots,X_n\) は独立同分布な確率変数列で，
平均 \(\mu\) ，分散 \(\sigma^2\) の正規分布に従うとする．
不偏分散を
</p>
<div>
\begin{equation}
  s^2=\frac{1}{n{-}1}\sum_{i=1}^n(X_i-\bar{X})^2
\end{equation}

</div>
<p>
とすると， \(\bar{X}\) と \(s^2\) は独立であり，
確率変数 \((n{-}1)s^2/\sigma^2\) は自由度 \(n{-}1\) の \(\chi^2\) 分布に従う．
</p>
</blockquote></li>

</ul>

</section>
<section>
<ul>
<li><p>
標準化した確率変数の性質
</p>
<blockquote>
<p>
前の命題と \(\sqrt{n}(\bar{X}-\mu)/\sigma\) が標準正規分布に従うこ
とから，
確率変数
</p>
<div>
\begin{equation}
  T=
  \frac{\sqrt{n}(\bar{X}-\mu)}{s}
  =\frac{\sqrt{n}(\bar{X}-\mu)/\sigma}
  {\sqrt{(n{-}1)s^2/\sigma^2\big/(n{-}1)}}
  % =\frac{\sqrt{n}(\bar{X}-\mu)/\sigma}
  % {\sqrt{\frac{(n{-}1)s^2}{\sigma^2}\Big/(n{-}1)}}
\end{equation}

</div>
<p>
は自由度 \(n{-}1\) の \(t\) 分布に従う．
</p>
</blockquote></li>

</ul>

</section>
<section>
<ul>
<li><p>
信頼区間の構成
</p>
<blockquote>
<p>
\(t_{1{-}\alpha/2}(n{-}1)\) を自由度 \(n{-}1\) の \(t\) 分布の
\(1{-}\alpha/2\) 分位点とすれば
</p>
<div>
\begin{equation}
  P\left(-t_{1{-}\alpha/2}(n{-}1)\le\frac{\sqrt{n}(\bar{X}-\mu)}{s}
    \le t_{1{-}\alpha/2}(n{-}1)\right)=1{-}\alpha
\end{equation}

</div>
<p>
となるので，
分散が未知の場合の平均 \(\mu\) の \(1{-}\alpha\) <b>信頼区間</b> は
以下で構成される．
</p>
<div>
\begin{equation}
  \left[\bar{X}-t_{1{-}\alpha/2}(n{-}1)\cdot\frac{s}{\sqrt{n}},\;
    \bar{X}+t_{1{-}\alpha/2}(n{-}1)\cdot\frac{s}{\sqrt{n}}\right]
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-org73074d8">
<h3 id="org73074d8">分散の区間推定</h3>
<ul>
<li><p>
不偏分散の性質
</p>
<blockquote>
<p>
\((n{-}1)s^2/\sigma^2\) は自由度 \(n{-}1\) の \(\chi^2\) 分布に従う
</p>
</blockquote></li>
<li><p>
不偏分散の確率
</p>
<blockquote>
<p>
\(\chi^2_{\alpha/2}(n{-}1)\) ,  \(\chi^2_{1{-}\alpha/2}(n{-}1)\) を
それぞれ自由度 \(n{-}1\) の \(\chi^2\) 分布の
\(\alpha/2, 1{-}\alpha/2\) 分位点とすれば
</p>
<div>
\begin{equation}
  P\left(\chi^2_{\alpha/2}(n{-}1)\le\frac{(n{-}1)s^2}{\sigma^2}
    \le\chi^2_{1{-}\alpha/2}(n{-}1)\right)
  =1{-}\alpha
\end{equation}

</div>
</blockquote>
<ul>
<li>左右非対称なので，2つの分位点が必要となる</li>

</ul></li>

</ul>

</section>
<section>
<ul>
<li><p>
信頼区間の構成
</p>
<blockquote>
<p>
\(\sigma^2\) について解くと
</p>
<div>
\begin{equation}
  P\left(\frac{(n{-}1)s^2}{\chi^2_{1{-}\alpha/2}(n{-}1)}
    \le\sigma^2\le\frac{(n{-}1)s^2}{\chi^2_{\alpha/2}(n{-}1)}\right)
  =1{-}\alpha
\end{equation}

</div>
<p>
となるので，
\(\sigma^2\) の \(1{-}\alpha\) <b>信頼区間</b> は以下で構成される．
</p>
<div>
\begin{equation}
  \left[\frac{(n{-}1)s^2}{\chi^2_{1{-}\alpha/2}(n{-}1)},
    \frac{(n{-}1)s^2}{\chi^2_{\alpha/2}(n{-}1)}\right]
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
</section>
<section>
<section id="slide-org6f63f6d">
<h2 id="org6f63f6d">漸近正規性にもとづく区間推定</h2>
<div class="outline-text-2" id="text-org6f63f6d">
</div>
</section>
<section id="slide-orgd22b770">
<h3 id="orgd22b770">推定量の漸近正規性</h3>
<ul>
<li><p>
<b>漸近正規性</b>
</p>
<blockquote>
<p>
多くの推定量 \(\hat{\theta}\) の分布は正規分布で近似できる
</p>
</blockquote>
<ul>
<li>モーメントに基づく記述統計量は漸近正規性をもつ</li>
<li>最尤推定量は広い範囲の確率分布に対して漸近正規性をもつ</li>
<li>いずれも中心極限定理にもとづく</li>

</ul></li>
<li>正規分布を用いて近似的に信頼区間を構成することができる</li>

</ul>
</section>
<section id="slide-orge4bf78f">
<h3 id="orge4bf78f">標本平均の漸近正規性</h3>
<ul>
<li><p>
定理
</p>
<blockquote>
<p>
確率分布 \(\mathcal{L}\) が2次のモーメントを持てば，
\(\mathcal{L}\) の平均 \(\mu\) の推定量である標本平均
は漸近正規性をもつ．
</p>
<div>
\begin{equation}
  \bar{X}=\frac{1}{n}\sum_{i=1}^nX_i
\end{equation}

</div>
<p>
\(\mathcal{L}\) の標準偏差を \(\sigma\) とすれば, 
任意の \(a\le b\) に対して以下が成立する．
(\(\phi\) は標準正規分布の確率密度関数)
</p>
<div>
\begin{equation}
  P\left(a\le\frac{\sqrt{n}(\bar{X}-\mu)}{\sigma}
    \le b\right)\to\int_a^b\phi(x)dx\quad(n\to\infty)
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-orgd0eaacd">
<h3 id="orgd0eaacd">平均の区間推定 (分散既知)</h3>
<ul>
<li><p>
標本平均の確率
</p>
<blockquote>
<p>
\(z_{1{-}\alpha/2}\) を標準正規分布の
\(1{-}\alpha/2\) 分位点とすれば
</p>
<div>
\begin{equation}
  P\left(-z_{1{-}\alpha/2}\le\frac{\sqrt{n}(\bar{X}-\mu)}{\sigma}
    \le z_{1{-}\alpha/2}\right)\to1{-}\alpha\quad(n\to\infty)
\end{equation}

</div>
<p>
となるので，
\(\mu\) について解くと以下が成り立つ．
</p>
<div>
\begin{multline}
  P\left(\bar{X}-z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}}
    \le\mu \le\bar{X}+z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}}\right)\\
  \to1{-}\alpha\quad(n\to\infty)
\end{multline}

</div>
</blockquote></li>

</ul>

</section>
<section>
<ul>
<li><p>
信頼区間の構成
</p>
<blockquote>
<p>
\(\sigma\) が既知の場合の平均 \(\mu\) の \(1{-}\alpha\) <b>信頼区間</b>
は以下で構成される．
</p>
<div>
\begin{equation}
  \left[\bar{X}-z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}},\;
    \bar{X}+z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}}\right]
\end{equation}

</div>
<p>
(サンプル数 \(n\) が十分大きい場合に近似的に正しい)
</p>
</blockquote></li>

</ul>
</section>
<section id="slide-org23d2fd6">
<h3 id="org23d2fd6">平均の区間推定 (分散未知)</h3>
<ul>
<li>\(\sigma\) をその一致推定量 \(\hat{\sigma}\) で置き換えてもそのまま成立する
<ul>
<li><p>
\(\hat{\sigma}\) としては例えば不偏分散の平方根を用いる
</p>
<blockquote>
<div>
\begin{equation}
  \hat{\sigma}=\sqrt{\frac{1}{n{-}1}\sum_{i=1}^n(X_i-\bar{X})^2}
\end{equation}

</div>
</blockquote></li>
<li>実問題で平均はわからないが，分散はわかるという場合はあまりない</li>
<li>\(t\) 分布は自由度 \(n\to\infty\) で標準正規分布になる</li>

</ul></li>

</ul>

</section>
<section>
<ul>
<li><p>
信頼区間の構成
</p>
<blockquote>
<p>
\(\sigma\) が未知の場合の平均 \(\mu\) の \(1{-}\alpha\) <b>信頼区間</b>
は以下で構成される．
</p>
<div>
\begin{equation}
  \left[\bar{X}-z_{1{-}\alpha/2}\cdot\frac{\hat{\sigma}}{\sqrt{n}},\;
    \bar{X}+z_{1{-}\alpha/2}\cdot\frac{\hat{\sigma}}{\sqrt{n}}\right]
\end{equation}

</div>
</blockquote>
<ul>
<li>サンプル数 \(n\) が十分大きい場合に近似的に正しい</li>

</ul></li>

</ul>
</section>
<section id="slide-org71aaa23">
<h3 id="org71aaa23">最尤推定量の区間推定</h3>
<ul>
<li><p>
定理 (最尤推定量の漸近正規性)
</p>
<blockquote>
<p>
\(\mathcal{L}\) が1次元パラメタ \(\theta\) を含む連続分布とするとき，
最尤推定量 \(\hat\theta\) は
平均 \(\theta\) (真の値)，
分散 \(1/(nI(\hat\theta))\) の正規分布で近似できる．
</p>
</blockquote></li>
<li><p>
信頼区間の構成
</p>
<blockquote>
<p>
\(\theta\) の \(1{-}\alpha\) <b>信頼区間</b> は以下で構成される．
</p>
<div>
\begin{equation}
  \left[\hat{\theta}-z_{1{-}\alpha/2}\cdot\frac{1}{\sqrt{nI(\hat\theta)}},\;
    \hat{\theta}+z_{1{-}\alpha/2}\cdot\frac{1}{\sqrt{nI(\hat\theta)}}\right]  
\end{equation}

</div>
</blockquote>
<ul>
<li>サンプル数 \(n\) が十分大きい場合に近似的に正しい</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-org84d0cfe" data-background="#fef4f4">
<h2 id="org84d0cfe">実習</h2>
</section>
<section id="slide-orgc714b20" data-background="#fef4f4">
<h3 id="orgc714b20">練習問題</h3>
<ul>
<li>東京都の気候データ (<code>tokyo_weather.csv</code>) の
日射量 (<code>solar</code>) の項目について以下の問に答えよ．
<ul>
<li>全データによる平均値を計算しなさい．</li>
<li>ランダムに抽出した50点を用いて，平均値の0.9(90%)信頼区間を求めなさい．</li>
<li>上記の推定を100回繰り返した際，真の値(全データによる平均値)が信頼区間に何回含まれるか確認しなさい．</li>

</ul></li>
<li>自身で収集したデータで区間推定を試みよ．</li>

</ul>
</section>
</section>
<section>
<section id="slide-orge299b96">
<h2 id="orge299b96">次回の予定</h2>
<ul>
<li>検定
<ul>
<li>帰無仮説と対立仮説</li>
<li>棄却域</li>
<li>\(p\)-値</li>

</ul></li>
<li>平均の検定</li>
<li>分散の検定</li>
<li>平均の差の検定</li>
<li>分散の比の検定</li>

</ul>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/menu/menu.js"></script>
<script src="./reveal.js/plugin/spotlight/spotlight.js"></script>
<script src="./reveal.js/plugin/chalkboard/plugin.js"></script>
<script src="./reveal.js/dist/theme/hidelinks.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,
overview: true,

transition: 'fade',
transitionSpeed: 'default',
showNotes: window.location.search.match( /print-pdf/gi ) ? 'separate-page' : false,
spotlight: { size: 80, initialPresentationMode: false, }, keyboard: { 81: function() { RevealSpotlight.toggleSpotlight()}, 87: function() { RevealSpotlight.togglePresentationMode();}, },

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealMenu, RevealSpotlight, RevealChalkboard ],

// Optional libraries used to extend reveal.js
dependencies: [
]

});
</script>
</body>
</html>
