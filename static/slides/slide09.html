<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>推定</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/mycourse.css"/>
<link rel="stylesheet" href="./reveal.js/plugin/highlight/zenburn.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">推定</h1>
</div>
<div class="talk-subtitle">
    <p>確率分布を推定する</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  2020.06.19</p>
</div>

</section>

<section>
<section id="slide-orgd408a9c">
<h2 id="orgd408a9c">推定とは</h2>
<div class="outline-text-2" id="text-orgd408a9c">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org3e633d6">
<h3 id="org3e633d6">統計解析の目的</h3>
<ul>
<li>観測データを確率変数の実現値と考えてモデル化</li>
<li>観測データの背後の確率分布を <b>推定</b>
<ul>
<li>分布のもつ特性量(平均や分散など)を評価する</li>
<li>分布そのもの(確率関数や確率密度)を決定する</li>

</ul></li>
<li>統計学で広く利用されている推定方法を説明
<ul>
<li>点推定</li>
<li>区間推定</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org84821e5">
<h3 id="org84821e5">推定の標準的な枠組</h3>
<ul>
<li>観測データは独立同分布な確率変数列 \(X_1,X_2,\dots,X_n\)</li>
<li>\(X_i\) の従う共通の法則 \(\mathcal{L}\) を想定
<ul>
<li>\(\mathcal{L}\) として全ての分布を考察対象とすることは困難
<ul>
<li>対象とする範囲が広くなりすぎる</li>
<li>データ数 \(n\) が大きくないと意味のある結論を導き出せない</li>

</ul></li>
<li>確率分布 \(\mathcal{L}\) を特徴づけるパラメタ \(\theta\) を考察対象
<ul>
<li>\(\mathcal{L}\) の平均・分散・歪度・尖度など</li>
<li>\(\mathcal{L}\) の確率関数・確率密度関数のパラメタ</li>

</ul></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgb1f0125">
<h2 id="orgb1f0125">点推定</h2>
<div class="outline-text-2" id="text-orgb1f0125">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgaf01bb7">
<h3 id="orgaf01bb7">点推定</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
点推定とは
\(\mathcal{L}\) 
に含まれるパラメタ \(\theta\) を \(X_1,\dotsc,X_n\) の関数
</p>
<div>
\begin{equation}
  \hat{\theta}=\hat{\theta}(X_1,\dots,X_n)
\end{equation}

</div>

<p>
で推定することで，
\(\hat{\theta}\) を \(\theta\) の <b>推定量</b> と呼ぶ．
</p>
</blockquote></li>
<li><p>
記述統計量は分布のパラメタの1つ
</p>
<blockquote>
<p>
例: 
\(\mathcal{L}\) の平均 \(\mu\) を
標本平均 \(\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i\) によって
推定することが点推定であり,
\(\bar{X}\) は \(\mu\) の推定量となる．
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org91d7e70">
<h3 id="org91d7e70">良い推定量</h3>
<ul>
<li>一般に1つのパラメタの推定量は無数に存在</li>
<li><p>
推定量の良さの代表的な基準: <b>不偏性・一致性</b>
</p>
<ul>
<li><p>
\(\hat{\theta}\) が \(\theta\) の不偏推定量:
</p>
<div>
\begin{equation}
  E[\hat{\theta}]=\theta
\end{equation}

</div></li>

<li><p>
\(\hat{\theta}\) が \(\theta\) の(強)一致推定量:
</p>
<div>
\begin{equation}
  \text{$\hat{\theta}$ が $\theta$ に収束する確率が1}\quad (n\to\infty)
\end{equation}

</div></li>

</ul>

<blockquote>
<p>
例: 
標本平均, 不偏分散はそれぞれ
\(\mathcal{L}\) の平均, 分散の不偏かつ一致性をもつ推定量
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org63350fb">
<h3 id="org63350fb">良い不偏推定量</h3>
<ul>
<li><p>
一般に不偏推定量も複数存在
</p>
<blockquote>
<p>
例: \(\mathcal{L}\) の平均 \(\mu\) の不偏推定量:
</p>
<ul>
<li>標本平均 \(\bar{X}\)</li>
<li>\(X_1\)</li>
<li>\(X_1,\dots,X_n\) のメディアン
( \(\mathcal{L}\) が \(x=\mu\) に関して対称な場合)</li>

</ul>
</blockquote></li>
<li>不偏推定量の良さを評価する基準が必要</li>
<li><p>
<b>一様最小分散不偏推定量</b>:
</p>
<blockquote>
<p>
\(\theta\) の任意の不偏推定量 \(\hat{\theta}'\) 
に対して推定値のばらつき(分散)が最も小さいもの
</p>
<div>
\begin{equation}
  \mathrm{Var}(\hat{\theta})\le\mathrm{Var}(\hat{\theta}')
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org3bf2f80">
<h3 id="org3bf2f80">Cramer-Raoの不等式</h3>
<ul>
<li><p>
定理
</p>
<blockquote>
<p>
\(\mathcal{L}\) は1次元パラメタ \(\theta\) を含む連続分布とし，
その確率密度関数 \(f_\theta(x)\) は \(\theta\) に関して
偏微分可能であるとする．
このとき，緩やかな仮定の下で，
\(\theta\) の任意の不偏推定量 \(\hat{\theta}\) に対して
以下の不等式が成り立つ:
</p>
<div>
\begin{equation}%\label{cr-bound}
  \mathrm{Var}(\hat{\theta})\ge \frac{1}{nI(\theta)}.
\end{equation}

</div>

<p>
ただし
</p>
<div>
\begin{equation}
  I(\theta)=\int_{-\infty}^\infty
  \left(\frac{\partial}{\partial\theta}\log f_\theta(x)\right)^2
  f_\theta(x)dx.
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgab76281">
<h3 id="orgab76281">一様最小分散不偏推定量</h3>
<ul>
<li>用語の定義
<ul>
<li>下界 \(1/(nI(\theta))\) : <b>Cramer-Rao下界</b></li>
<li>\(I(\theta)\) : <b>Fisher情報量</b></li>

</ul></li>
<li><p>
定理 (Cramer-Raoの不等式の系)
</p>
<blockquote>
<p>
\(\theta\) の不偏推定量 \(\hat{\theta}\) で
分散がCramer-Rao下界 \(1/(nI(\theta))\) に一致するものが存在すれば，
それは一様最小分散不偏推定量となる．
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org6fa2bd5">
<h3 id="org6fa2bd5">例: 正規分布モデルの標本平均</h3>
<ul>
<li>\(\mathcal{L}\) は平均 \(\mu\) , 分散 \(\sigma^2\) の正規分布
<ul>
<li><p>
平均パラメタ \(\mu\) に関するFisher情報量:
</p>
<div>
\begin{align}
  I(\mu)=\frac{1}{\sqrt{2\pi\sigma^2}}
  \int_{-\infty}^\infty\frac{(x-\mu)^2}{\sigma^4}
  e^{-\frac{(x-\mu)^2}{2\sigma^2}}dx
  =\frac{1}{\sigma^2}
\end{align}

</div></li>

<li>Cramer-Rao下界: \(\sigma^2/n\)</li>
<li>標本平均 \(\bar{X}\) の分散: \(\sigma^2/n\) (=Cramer-Rao下界)</li>

</ul></li>
<li>\(\bar{X}\) は \(\mu\) の一様最小分散不偏推定量</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org8c67b6b" data-background="#fef4f4">
<h2 id="org8c67b6b">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org55b735b" data-background="#fef4f4">
<h3 id="org55b735b">練習問題</h3>
<ul>
<li>\(X\) を一様乱数に従う確率変数とし，
平均値の推定量として以下を考える．
それぞれの推定量の分散を比較しなさい．
<ul>
<li>標本平均 (mean)</li>
<li>中央値 (median)</li>
<li>最大値と最小値の平均 ((max+min)/2)</li>

</ul></li>
<li><p>
ヒント: 以下のような関数を作り，Monte-Carlo実験を行えばよい
</p>
<div class="org-src-container">

<pre><code class=" R" >myMeanEst &lt;- function(n, min, max){ # 観測データ数
    x &lt;- runif(n, min=min, max=max) # 一様乱数を生成，範囲は引数から
    return(c(xbar=mean(x),med=median(x),mid=(max(x)+min(x))/2))
} # 3つまとめて計算する関数
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org862fd3e">
<h2 id="org862fd3e">最尤法</h2>
<div class="outline-text-2" id="text-org862fd3e">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org2b35ba1">
<h3 id="org2b35ba1">離散分布の場合</h3>
<ul>
<li>観測値 \(X_1=x_1,X_2=x_2,\dots,X_n=x_n\) の同時確率
<ul>
<li>確率関数: \(f_{\boldsymbol{\theta}}(x)\)</li>
<li>確率関数のパラメタ: \(\boldsymbol{\theta}:=(\theta_1,\dots,\theta_p)\)</li>
<li><p>
独立な確率変数の同時確率:
</p>
<div>
\begin{align}
  & P(X_1=x_1,X_2=x_2,\dots,X_n=x_n)
    =\prod_{i=1}^nP(X_i=x_i)\\
  &=
     \prod_{i=1}^nf_{\boldsymbol{\theta}}(x_i)
     =f_{\boldsymbol{\theta}}(x_1)\cdot
     f_{\boldsymbol{\theta}}(x_2)\cdots
     f_{\boldsymbol{\theta}}(x_n)
\end{align}

</div></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org36390d4">
<h3 id="org36390d4">尤度関数</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
パラメタ \(\boldsymbol{\theta}\) に対して
観測データ \(X_1,X_2,\dots,X_n\) が得られる理論上の確率
</p>
<div>
\begin{equation}
  L(\boldsymbol{\theta})
  :=\prod_{i=1}^nf_{\boldsymbol{\theta}}(X_i)
\end{equation}

</div>

<p>
を
\(\boldsymbol{\theta}\) の 
<b>尤度</b> と言い，
\(\boldsymbol{\theta}\) の関数 \(L\) を <b>尤度関数</b> と呼ぶ．
</p>
</blockquote>
<ul>
<li>観測データ 
\(X_1,X_2,\dots,X_n\) 
が現れるのにパラメタ 
\(\boldsymbol{\theta}\) 
の値がどの程度尤もらしいかを測る尺度</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org926d2b3">
<h3 id="org926d2b3">最尤法</h3>
<ul>
<li><p>
最尤法: 
</p>
<blockquote>
<p>
観測データに対して「最も尤もらしい」パラメタ値
を \(\boldsymbol{\theta}\) の推定量として採用する方法
を最尤法という．
</p>
</blockquote></li>
<li><p>
最尤推定量:
</p>
<blockquote>
<p>
\(\Theta\) を尤度関数の定義域として，
尤度関数を最大とする  \(\hat{\boldsymbol{\theta}}\) 
</p>
<div>
\begin{equation}
  L(\hat{\boldsymbol{\theta}})
  =\max_{\boldsymbol{\theta}\in\Theta}L(\boldsymbol{\theta}).
\end{equation}

</div>

<p>
を 
\(\boldsymbol{\theta}\) 
の <b>最尤推定量</b> という．
</p>

<p>
以下のように表現することもある．
</p>
<div>
\begin{equation}
  \hat{\boldsymbol{\theta}}
  =\arg\max_{\boldsymbol{\theta}\in\Theta}L(\boldsymbol{\theta}).
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org75821ef">
<h3 id="org75821ef">最尤推定量の計算</h3>
<ul>
<li><p>
<b>対数尤度関数</b>:
</p>
<div>
\begin{equation}
  \ell(\boldsymbol{\theta})
  :=\log L(\boldsymbol{\theta})
  =\sum_{i=1}^n\log f_{\boldsymbol{\theta}}(X_i).
\end{equation}

</div>
<ul>
<li>対数関数は狭義増加</li>
<li>\(\ell(\boldsymbol{\theta})\) の最大化と \(L(\boldsymbol{\theta})\) の最大化は同義</li>
<li>扱い易い和の形なのでこちらを用いることが多い</li>
<li>大数の法則を用いて対数尤度関数の収束が議論できる</li>

</ul></li>
<li><p>
最尤推定量の性質
</p>
<blockquote>
<p>
広い範囲の確率分布に対して最尤推定量は <b>一致性</b> を持つ
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org1f3c94e">
<h3 id="org1f3c94e">連続分布の場合</h3>
<ul>
<li><b>確率密度関数</b> \(f_{\boldsymbol{\theta}}(x)\) を用いて尤度を定義</li>
<li><p>
<b>尤度関数</b>: 
</p>
<div>
\begin{equation}
  L(\boldsymbol{\theta})
  =\prod_{i=1}^nf_{\boldsymbol{\theta}}(x_i)
  =f_{\boldsymbol{\theta}}(x_1)\cdot
  f_{\boldsymbol{\theta}}(x_2)\cdots
  f_{\boldsymbol{\theta}}(x_n)
\end{equation}

</div></li>
<li><p>
<b>対数尤度関数</b>:
</p>
<div>
\begin{equation}
  \ell(\boldsymbol{\theta})
  :=\log L(\boldsymbol{\theta})
  =\sum_{i=1}^n\log f_{\boldsymbol{\theta}}(X_i)
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgceaacd2">
<h3 id="orgceaacd2">例: Poisson分布の最尤推定</h3>
<ul>
<li>\(\mathcal{L}\) をパラメタ \(\lambda>0\) のPoisson分布でモデル化
<ul>
<li><p>
対数尤度関数 (未知パラメタ: \(\lambda\) )
</p>
<div>
\begin{equation}
  \ell(\lambda)=\sum_{i=1}^n\log\frac{\lambda^{X_i}}{X_i!}e^{-\lambda}
  =\sum_{i=1}^n(X_i\log\lambda-\log X_i!)-n\lambda
\end{equation}

</div></li>

<li>少なくとも1つの \(i\) について \(X_i>0\) を仮定する</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>(Poisson分布のつづき)
<ul>
<li><p>
\(\ell(\lambda)\) の微分: 
</p>
<div>
\begin{equation}
  \ell'(\lambda)=\frac{1}{\lambda}\sum_{i=1}^nX_i-n,\quad
  \ell''(\lambda)=-\frac{1}{\lambda^2}\sum_{i=1}^nX_i<0
\end{equation}

</div></li>

<li>方程式 \(\ell'(\lambda)=0\) の解が \(\ell(\lambda)\) を最大化</li>
<li><p>
\(\lambda\) の最尤推定量:
</p>
<div>
\begin{equation}
  \hat{\lambda}=\frac{1}{n}\sum_{i=1}^nX_i
\end{equation}

</div></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org79e17af">
<h3 id="org79e17af">例: 指数分布の最尤推定</h3>
<ul>
<li>\(\mathcal{L}\) をパラメタ \(\lambda>0\) の指数分布でモデル化
<ul>
<li><p>
対数尤度関数 (未知パラメタ: \(\lambda\) )
</p>
<div>
\begin{equation}
  \ell(\lambda)=\sum_{i=1}^n\log\lambda e^{-\lambda X_i}
  =n\log\lambda-\lambda\sum_{i=1}^nX_i
\end{equation}

</div></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>(指数分布のつづき)
<ul>
<li><p>
\(\ell(\lambda)\) の微分: 
</p>
<div>
\begin{equation}
  \ell'(\lambda)=\frac{n}{\lambda}-\sum_{i=1}^nX_i,\quad
  \ell''(\lambda)=-\frac{n}{\lambda^2}<0
\end{equation}

</div></li>

<li>方程式 \(\ell'(\lambda)=0\) の解が \(\ell(\lambda)\) を最大化</li>
<li><p>
\(\lambda\) の最尤推定量:
</p>
<div>
\begin{equation}
  \hat{\lambda}=\frac{1}{\frac{1}{n}\sum_{i=1}^nX_i}
\end{equation}

</div></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org2724bf5">
<h3 id="org2724bf5">例: ガンマ分布の最尤推定</h3>
<ul>
<li>\(\mathcal{L}\) をパラメタ \(\nu,\alpha>0\) のガンマ分布でモデル化
<ul>
<li><p>
対数尤度関数 (未知パラメタ: \(\nu,\alpha\) )
</p>
<div>
\begin{align}
  \ell(\nu,\alpha)
  &=\sum_{i=1}^n\log\frac{\alpha^\nu}{\Gamma(\nu)}X_i^{\nu-1}e^{-\alpha X_i}\\
  &=n\nu\log\alpha-n\log\Gamma(\nu)+\sum_{i=1}^n\{(\nu-1)\log X_i-\alpha X_i\}
\end{align}

</div></li>

<li>\(\ell(\nu,\alpha)\) を最大化する \(\nu,\alpha\) は解析的に求まらないので実際の計算では数値的に求める</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
Rでの計算例 (ガンマ分布の最尤推定量の例)
</p>
<div class="org-src-container">

<pre><code class=" R" >library(stats4) # 関数mleを利用するため
## 数値最適化のためには尤度関数を最初に評価する初期値が必要
mle.gamma &lt;- function(x, # 観測データ
		      nu0=1, alpha0=1){ # nu, alphaの初期値
    ## 負の対数尤度関数を定義 (最小化を考えるため)
    ll &lt;- function(nu, alpha) # nuとalphaの関数として定義 
	suppressWarnings(-sum(dgamma(x, nu, alpha, log=TRUE)))
    ## suppressWarnings は定義域外で評価された際の警告を表示させない
    ## 最尤推定(負の尤度の最小化)
    est &lt;- mle(minuslogl=ll, # 負の対数尤度関数
	       start=list(nu=nu0, alpha=alpha0), # 初期値
	       method="BFGS", # 最適化方法 (選択可能)
	       nobs=length(x)) # 観測データ数
    return(coef(est)) # 推定値のみ返す
}
</code></pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org4c23696" data-background="#fef4f4">
<h2 id="org4c23696">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org428bc5a" data-background="#fef4f4">
<h3 id="org428bc5a">練習問題</h3>
<ul>
<li><p>
東京都の気候データ (<code>tokyo_weather.csv</code>) の
風速の項目について以下の問に答えよ．
</p>
<div class="org-src-container">

<pre><code class=" R" >myData &lt;- read.csv("data/tokyo_weather.csv", fileEncoding="utf8")
</code></pre>
</div>
<ul>
<li>全データを用いてヒストグラム(密度)を作成しなさい．</li>
<li>ガンマ分布でモデル化して最尤推定を行いなさい．</li>
<li>推定した結果をヒストグラムに描き加えて比較しなさい．</li>

</ul></li>
<li>自身で収集したデータを用いて，モデル化と最尤推定を試みよ．</li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org75717be">
<h2 id="org75717be">区間推定</h2>
<div class="outline-text-2" id="text-org75717be">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org9908f1a">
<h3 id="org9908f1a">推定誤差</h3>
<ul>
<li>推定量 \(\hat{\theta}\) には推定誤差が必ず存在</li>
<li>推定結果の定量評価には推定誤差の評価が重要
<ul>
<li><p>
&ldquo;誤差 \(\hat{\theta}-\theta\) が
区間 \([l,u]\) の内側にある確率が \(1{-}\alpha\) 以上 &rdquo; <br />
(&ldquo;外側にある確率が \(\alpha\) 以下&rdquo; と言い換えてもよい)
</p>
<div>
\begin{equation}
  P(l\le\hat{\theta}-\theta\le u)\ge 1{-}\alpha
\end{equation}

</div></li>

</ul></li>

<li>パラメタの範囲の推定に書き換え
<ul>
<li><p>
&ldquo; \(\theta\) が含まれる確率が \(1{-}\alpha\) 以上となるような区間
\([\hat{\theta}-u,\hat{\theta}-l]\) を推定&rdquo;
</p>
<div>
\begin{equation}
  P(\hat{\theta}-u\le\theta\le \hat{\theta}-l)\ge 1{-}\alpha
\end{equation}

</div></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orge26c1a4">
<h3 id="orge26c1a4">区間推定</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
区間推定とは
未知パラメタ \(\theta\) とある値 \(\alpha\in(0,1)\) に対して
以下を満たす確率変数 \(L,U\) を観測データから求めることをいう．
</p>
<div>
\begin{equation}
  P(L\le\theta\le U)\ge 1{-}\alpha
\end{equation}

</div>
</blockquote>
<ul>
<li>区間 \([L,U]\) : \(1{-}\alpha\) <b>信頼区間</b> (\(100(1{-}\alpha)\) % と書くことも多い)</li>
<li>\(L\) : \(1{-}\alpha\) <b>下側信頼限界</b></li>
<li>\(U\) : \(1{-}\alpha\) <b>上側信頼限界</b></li>
<li>\(1{-}\alpha\) : <b>信頼係数</b>
(\(\alpha=0.01,0.05,0.1\) とすることが多い)</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org435f512">
<h3 id="org435f512">信頼区間の性質</h3>
<ul>
<li>信頼区間は幅が狭いほど推定精度が良い
<ul>
<li>真のパラメタが取りうる値の範囲を限定することになるため</li>

</ul></li>
<li><p>
最も推定精度の良い \(1{-}\alpha\) 信頼区間 \([L,U]\)
</p>
<div>
\begin{equation}
  P(L\le\theta\le U)=1{-}\alpha
\end{equation}

</div>

<ul>
<li>信頼区間の幅が狭いほど \(P(L\le\theta\le U)\) は小さくなるため</li>

</ul></li>
<li>実行可能である限り
\(1{-}\alpha\) 信頼区間 \([L,U]\) は上式を満たすように
\(L,U\) を決定する</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org18aaaf2">
<h2 id="org18aaaf2">正規母集団の区間推定</h2>
<div class="outline-text-2" id="text-org18aaaf2">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org000407d">
<h3 id="org000407d">平均の区間推定 (分散既知)</h3>
<ul>
<li>正規分布に従う独立な確率変数の重み付き和は正規分布に従う</li>
<li><p>
一般の場合
</p>
<blockquote>
<p>
\(Z_1,Z_2,\dots,Z_k\) を独立な確率変数列とし，
各 \(i=1,2,\dots,k\) に対して \(Z_i\) は平均 \(\mu_i\) ，
分散 \(\sigma_i^2\) の正規分布に従うとする．
このとき \(a_0,a_1,\dots,a_k\) を \((k+1)\) 個の0でない実数とすると，
\(a_0+\sum_{i=1}^ka_iZ_i\) は
平均 \(a_0+\sum_{i=1}^ka_i\mu_i\) ，
分散 \(\sum_{i=1}^ka_i^2\sigma_i^2\) の正規分布に従う．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
同分布の場合
</p>
<blockquote>
<p>
\(k=n\), \(\mu_i=\mu\), \(\sigma_i^2=\sigma^2\), \(a_0=0\),
\(a_i=1/n\;(i=1,\dots,n)\)
</p>
<div>
\begin{equation}
  \bar{X}=\frac{1}{n}\sum_{i=1}^nX_i \quad\text{(標本平均)}
\end{equation}

</div>

<p>
は平均 \(\mu\) , 分散 \(\sigma^2/n\) の正規分布に従う．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
同分布を標準化した場合
</p>
<blockquote>
<p>
\(k=1\) , \(\mu_1=\mu\) , \(\sigma_1^2=\sigma^2/n\) ,
\(a_0=-\sqrt{n}\mu/\sigma\) , \(a_1=\sqrt{n}/\sigma\)
</p>
<div>
\begin{equation}
  Z=\frac{\sqrt{n}(\bar{X}-\mu)}{\sigma}
\end{equation}

</div>

<p>
は標準正規分布に従う．
</p>
</blockquote></li>
<li><p>
標準化した確率変数の確率
</p>
<blockquote>
<p>
\(z_{1{-}\alpha/2}\) を標準正規分布の
\(1{-}\alpha/2\) 分位点とすれば
</p>
<div>
\begin{equation}
  P\Bigl(-z_{1{-}\alpha/2}\le\frac{\sqrt{n}(\bar{X}-\mu)}{\sigma}
    \le z_{1{-}\alpha/2}\Bigr)=1{-}\alpha
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
信頼区間の構成
</p>
<blockquote>
<p>
\(\mu\) について解くと
</p>
<div>
\begin{equation}
  P\left(\bar{X}-z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}}\le\mu
  \le\bar{X}+z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}}\right)=1{-}\alpha
\end{equation}

</div>

<p>
となるので，
\(\sigma\) が既知の場合の平均 \(\mu\) の \(1{-}\alpha\) <b>信頼区間</b> は
以下で構成される．
</p>
<div>
\begin{equation}
  \left[\bar{X}-z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}},\;
  \bar{X}+z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}}\right]
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org33e39ef">
<h3 id="org33e39ef">平均の区間推定 (分散未知)</h3>
<ul>
<li>\(\chi^2\) 分布の特徴付け
<ul>
<li>標準正規分布に従う \(k\) 個の独立な確率変数の
二乗和は自由度 \(k\) の \(\chi^2\) 分布に従う</li>

</ul></li>
<li>\(t\) 分布の特徴付け
<ul>
<li><p>
\(Z\) を標準正規分布に従う確率変数，
\(Y\) を自由度 \(k\) の \(\chi^2\) 分布に従う確率変数とし，
\(Z,Y\) は独立であるとする．
このとき確率変数
</p>
<div>
\begin{equation}
  \frac{Z}{\sqrt{Y/k}}
\end{equation}

</div>

<p>
は自由度 \(k\) の \(t\) 分布に従う
</p></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
標本平均と不偏分散の性質
</p>
<blockquote>
<p>
\(X_1,X_2,\dots,X_n\) は独立同分布な確率変数列で，
平均 \(\mu\) ，分散 \(\sigma^2\) の正規分布に従うとする．
不偏分散を
</p>
<div>
\begin{equation}
  s^2=\frac{1}{n{-}1}\sum_{i=1}^n(X_i-\bar{X})^2
\end{equation}

</div>

<p>
とすると， \(\bar{X}\) と \(s^2\) は独立であり，
確率変数 \((n{-}1)s^2/\sigma^2\) は自由度 \(n{-}1\) の \(\chi^2\) 分布に従う．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
標準化した確率変数の性質
</p>
<blockquote>
<p>
前の命題と \(\sqrt{n}(\bar{X}-\mu)/\sigma\) が標準正規分布に従うこ
とから，
確率変数
</p>
<div>
\begin{equation}
  T=
  \frac{\sqrt{n}(\bar{X}-\mu)}{s}
  =\frac{\sqrt{n}(\bar{X}-\mu)/\sigma}
    {\sqrt{(n{-}1)s^2/\sigma^2\big/(n{-}1)}}
  % =\frac{\sqrt{n}(\bar{X}-\mu)/\sigma}
  %   {\sqrt{\frac{(n{-}1)s^2}{\sigma^2}\Big/(n{-}1)}}
\end{equation}

</div>

<p>
は自由度 \(n{-}1\) の \(t\) 分布に従う．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
信頼区間の構成
</p>
<blockquote>
<p>
\(t_{1{-}\alpha/2}(n{-}1)\) を自由度 \(n{-}1\) の \(t\) 分布の
\(1{-}\alpha/2\) 分位点とすれば
</p>
<div>
\begin{equation}
  P\left(-t_{1{-}\alpha/2}(n{-}1)\le\frac{\sqrt{n}(\bar{X}-\mu)}{s}
  \le t_{1{-}\alpha/2}(n{-}1)\right)=1{-}\alpha
\end{equation}

</div>

<p>
となるので，
分散が未知の場合の平均 \(\mu\) の \(1{-}\alpha\) <b>信頼区間</b> は
以下で構成される．
</p>
<div>
\begin{equation}
  \left[\bar{X}-t_{1{-}\alpha/2}(n{-}1)\cdot\frac{s}{\sqrt{n}},\;
  \bar{X}+t_{1{-}\alpha/2}(n{-}1)\cdot\frac{s}{\sqrt{n}}\right]
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc38e4dc">
<h3 id="orgc38e4dc">分散の区間推定</h3>
<ul>
<li><p>
不偏分散の性質
</p>
<blockquote>
<p>
\((n{-}1)s^2/\sigma^2\) は自由度 \(n{-}1\) の \(\chi^2\) 分布に従う
</p>
</blockquote></li>
<li><p>
不偏分散の確率
</p>
<blockquote>
<p>
\(\chi^2_{\alpha/2}(n{-}1)\) ,  \(\chi^2_{1{-}\alpha/2}(n{-}1)\) を
それぞれ自由度 \(n{-}1\) の \(\chi^2\) 分布の
\(\alpha/2, 1{-}\alpha/2\) 分位点とすれば
</p>
<div>
\begin{equation}
  P\left(\chi^2_{\alpha/2}(n{-}1)\le\frac{(n{-}1)s^2}{\sigma^2}
    \le\chi^2_{1{-}\alpha/2}(n{-}1)\right)
  =1{-}\alpha
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
信頼区間の構成
</p>
<blockquote>
<p>
\(\sigma^2\) について解くと
</p>
<div>
\begin{equation}
  P\left(\frac{(n{-}1)s^2}{\chi^2_{1{-}\alpha/2}(n{-}1)}
    \le\sigma^2\le\frac{(n{-}1)s^2}{\chi^2_{\alpha/2}(n{-}1)}\right)
  =1{-}\alpha
\end{equation}

</div>

<p>
となるので，
\(\sigma^2\) の \(1{-}\alpha\) <b>信頼区間</b> は以下で構成される．
</p>
<div>
\begin{equation}
  \left[\frac{(n{-}1)s^2}{\chi^2_{1{-}\alpha/2}(n{-}1)},
    \frac{(n{-}1)s^2}{\chi^2_{\alpha/2}(n{-}1)}\right]
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org6412567">
<h2 id="org6412567">漸近正規性にもとづく区間推定</h2>
<div class="outline-text-2" id="text-org6412567">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgb9ab451">
<h3 id="orgb9ab451">推定量の漸近正規性</h3>
<ul>
<li><p>
<b>漸近正規性</b>
</p>
<blockquote>
<p>
多くの推定量 \(\hat{\theta}\) の分布は正規分布で近似できる
</p>
</blockquote>
<ul>
<li>モーメントに基づく記述統計量は漸近正規性をもつ</li>
<li>最尤推定量は広い範囲の確率分布に対して漸近正規性をもつ</li>
<li>いずれも中心極限定理にもとづく</li>

</ul></li>
<li>正規分布を用いて近似的に信頼区間を構成することができる</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org7300693">
<h3 id="org7300693">標本平均の漸近正規性</h3>
<ul>
<li><p>
定理
</p>
<blockquote>
<p>
確率分布 \(\mathcal{L}\) が2次のモーメントを持てば，
\(\mathcal{L}\) の平均 \(\mu\) の推定量である標本平均
は漸近正規性をもつ．
</p>
<div>
\begin{equation}
  \bar{X}=\frac{1}{n}\sum_{i=1}^nX_i
\end{equation}

</div>

<p>
\(\mathcal{L}\) の標準偏差を \(\sigma\) とすれば, 
任意の \(a\le b\) に対して以下が成立する．
(\(\phi\) は標準正規分布の確率密度関数)
</p>
<div>
\begin{equation}
  P\left(a\le\frac{\sqrt{n}(\bar{X}-\mu)}{\sigma}
    \le b\right)\to\int_a^b\phi(x)dx\quad(n\to\infty)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgb2e8286">
<h3 id="orgb2e8286">平均の区間推定 (分散既知)</h3>
<ul>
<li><p>
標本平均の確率
</p>
<blockquote>
<p>
\(z_{1{-}\alpha/2}\) を標準正規分布の
\(1{-}\alpha/2\) 分位点とすれば
</p>
<div>
\begin{equation}
  P\left(-z_{1{-}\alpha/2}\le\frac{\sqrt{n}(\bar{X}-\mu)}{\sigma}
    \le z_{1{-}\alpha/2}\right)\to1{-}\alpha\quad(n\to\infty)
\end{equation}

</div>

<p>
となるので，
\(\mu\) について解くと以下が成り立つ．
</p>
<div>
\begin{multline}
  P\left(\bar{X}-z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}}
    \le\mu \le\bar{X}+z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}}\right)\\
  \to1{-}\alpha\quad(n\to\infty)
\end{multline}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
信頼区間の構成
</p>
<blockquote>
<p>
\(\sigma\) が既知の場合の平均 \(\mu\) の \(1{-}\alpha\) <b>信頼区間</b>
は以下で構成される．
</p>
<div>
\begin{equation}
  \left[\bar{X}-z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}},\;
    \bar{X}+z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}}\right]
\end{equation}

</div>

<p>
(サンプル数 \(n\) が十分大きい場合に近似的に正しい)
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org8eaace1">
<h3 id="org8eaace1">平均の区間推定 (分散未知)</h3>
<ul>
<li>\(\sigma\) をその一致推定量 \(\hat{\sigma}\) で置き換えてもそのまま成立する
<ul>
<li><p>
\(\hat{\sigma}\) としては例えば不偏分散の平方根を用いる
</p>
<div>
\begin{equation}
  \hat{\sigma}=\sqrt{\frac{1}{n{-}1}\sum_{i=1}^n(X_i-\bar{X})^2}
\end{equation}

</div></li>

<li>実問題で平均はわからないが，分散はわかるという場合はあまりない</li>
<li>\(t\) -分布は自由度 \(n\to\infty\) で標準正規分布になる</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
信頼区間の構成
</p>
<blockquote>
<p>
\(\sigma\) が未知の場合の平均 \(\mu\) の \(1{-}\alpha\) <b>信頼区間</b>
は以下で構成される．
</p>
<div>
\begin{equation}
  \left[\bar{X}-z_{1{-}\alpha/2}\cdot\frac{\hat{\sigma}}{\sqrt{n}},\;
    \bar{X}+z_{1{-}\alpha/2}\cdot\frac{\hat{\sigma}}{\sqrt{n}}\right]
\end{equation}

</div>

<p>
(サンプル数 \(n\) が十分大きい場合に近似的に正しい)
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org2e906fc">
<h3 id="org2e906fc">最尤推定量の区間推定</h3>
<ul>
<li><p>
定理 (最尤推定量の漸近正規性)
</p>
<blockquote>
<p>
\(\mathcal{L}\) が1次元パラメタ \(\theta\) を含む連続分布とするとき，
最尤推定量 \(\hat\theta\) は
平均 \(\theta\) (真の値)，
分散 \(1/(nI(\hat\theta))\) の正規分布で近似できる．
</p>
</blockquote></li>
<li><p>
信頼区間の構成
</p>
<blockquote>
<p>
\(\theta\) の \(1{-}\alpha\) <b>信頼区間</b> は以下で構成される．
</p>
<div>
\begin{equation}
  \left[\hat{\theta}-z_{1{-}\alpha/2}\cdot\frac{1}{\sqrt{nI(\hat\theta)}},\;
    \hat{\theta}+z_{1{-}\alpha/2}\cdot\frac{1}{\sqrt{nI(\hat\theta)}}\right]  
\end{equation}

</div>

<p>
(サンプル数 \(n\) が十分大きい場合に近似的に正しい)
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org383a8d9" data-background="#fef4f4">
<h2 id="org383a8d9">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org60fd71f" data-background="#fef4f4">
<h3 id="org60fd71f">練習問題</h3>
<ul>
<li>東京都の気候データ (<code>tokyo_weather.csv</code>) の
日射量の項目について以下の問に答えよ．
<ul>
<li>全データによる平均値を計算しなさい．</li>
<li>ランダムに抽出した50点を用いて，平均値の0.9(90%)信頼区間を求めなさい．</li>
<li>上記の推定を100回繰り返した際，真の値(全データによる平均値)が信頼区間に何回含まれるか確認しなさい．</li>

</ul></li>
<li>自身で収集したデータで区間推定を試みよ．</li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/highlight/highlight.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: true,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,

overview: true,

transition: 'fade',
transitionSpeed: 'default',
chalkboard: { toggleChalkboardButton: { left: '80px' }, toggleNotesButton: { left: '130px'}}, keyboard: { 69: function() { RevealChalkboard.toggleNotesCanvas() }, 87: function() { RevealChalkboard.toggleChalkboard() }, 67: function() { RevealChalkboard.clear() }, 82: function() { RevealChalkboard.reset() }, 68: function() { RevealChalkboard.download() }, 88: function() { RevealChalkboard.colorNext() }, 89: function() { RevealChalkboard.colorPrev() }},

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealHighlight ],

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/menu/menu.js'},
{ src: './reveal.js/plugin/chalkboard/chalkboard.js'}]

});
</script>
</body>
</html>
