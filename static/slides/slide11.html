<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>検定</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/mycourse.css"/>
<link rel="stylesheet" href="./reveal.js/plugin/highlight/zenburn.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">検定</h1>
</div>
<div class="talk-subtitle">
    <p>仮説の正当性をデータから検証する</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  </p>
</div>

</section>

<section>
<section id="slide-org10d508c">
<h2 id="org10d508c">講義の内容</h2>
<ul>
<li>検定
<ul>
<li>帰無仮説と対立仮説</li>
<li>棄却域</li>
<li>\(p\)-値</li>

</ul></li>
<li>平均の検定</li>
<li>分散の検定</li>
<li>平均の差の検定</li>
<li>分散の比の検定</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org48ef105">
<h2 id="org48ef105">検定とは</h2>
<div class="outline-text-2" id="text-org48ef105">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org6e49525">
<h3 id="org6e49525">統計的仮説検定</h3>
<ul>
<li><p>
ある現象・母集団に対して仮定された仮説の真偽を
データに基づいて統計的に検証する方法
</p>
<blockquote>
<p>
例: 
新しい薬の効能が古い薬よりも優れていること(仮説)を
薬の治験結果(データ)から検証したい
</p>
</blockquote></li>
<li>推定と大きく異なるのは，
母集団の分布に対して何らかの <b>仮説</b> を考えるところ</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orge0ecfb1">
<h3 id="orge0ecfb1">検定の基本的手続き</h3>
<ol>
<li>仮説を立てる</li>
<li>仮説のもとで <b>検定統計量</b> が従う標本分布を調べる</li>
<li>実際のデータから検定統計量の値を計算する</li>
<li>計算された検定統計量の値が
仮説が正しいときに十分高い確率で
得られるかどうかを判断する</li>

</ol>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orga7b6dbe">
<h3 id="orga7b6dbe">検定における仮説</h3>
<ul>
<li><p>
<b>帰無仮説</b>
</p>
<blockquote>
<p>
検定統計量の分布を予想するために立てる仮説
</p>
</blockquote></li>
<li><p>
<b>対立仮説</b>
</p>
<blockquote>
<p>
&ldquo;帰無仮説が誤っているときに起こりうるシナリオ&rdquo;として想定する仮説
</p>
</blockquote>
<ul>
<li>慣習として
帰無仮説を <b>\(H_0\)</b>, 
対立仮説を <b>\(H_1\)</b> で表す</li>
<li>&ldquo;帰無仮説を捨てて無に帰する&rdquo;ことを期待する場合が多い</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org3b2413f">
<h3 id="org3b2413f">帰無仮説と対立仮説</h3>
<ul>
<li>例: 薬の治験 (単純な場合)
<ul>
<li>帰無仮説 \(H_0\): 新しい薬も古い薬も効能は同じ</li>
<li>対立仮説 \(H_1\): 新しい薬と古い薬の効能は異なる</li>

</ul></li>
<li>例: 薬の治験 (新薬がより良いことを期待する場合)
<ul>
<li>帰無仮説 \(H_0\): 新しい薬も古い薬も効能は同じ</li>
<li>対立仮説 \(H_1\): 新しい薬の方が古い薬より効能が高い</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgb5d8011">
<h3 id="orgb5d8011">検定の用語</h3>
<ul>
<li><p>
帰無分布
</p>
<blockquote>
<p>
帰無仮説が正しい場合に検定統計量が従う分布
</p>
</blockquote></li>
<li><p>
棄却域
</p>
<blockquote>
<p>
帰無仮説の下で統計量の取り得るべき範囲の外の領域
</p>
</blockquote></li>
<li>仮説検定
<ul>
<li>帰無仮説を <b>棄却</b>: 帰無仮説は誤っていると判断すること</li>
<li>帰無仮説を <b>受容</b>: 帰無仮説を積極的に棄却できないこと</li>

</ul></li>
<li>検定の誤り
<ul>
<li><b>第一種過誤</b>: &ldquo;正しい帰無仮説を棄却する&rdquo;誤り</li>
<li><b>第二種過誤</b>: &ldquo;誤った帰無仮説を受容する&rdquo;誤り</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orge5b9374">
<h3 id="orge5b9374">検定の設計指針</h3>
<ul>
<li>検定統計量 \(T\) に対して棄却域 \(R\) を設計
<ul>
<li><p>
<b>サイズ</b>: 第一種過誤が <b>起きる確率</b>
</p>
<blockquote>
<div>
\begin{equation}
  \text{(サイズ)}
  =P(\text{\(T\) が\(R\)に含まれる}|\text{帰無仮説が正しい})
\end{equation}

</div>
</blockquote></li>
<li><p>
<b>検出力</b>: 第二種過誤が <b>起きない確率</b>
</p>
<blockquote>
<div>
\begin{equation}
  \text{(検出力)}
  =P(\text{\(T\) が\(R\)に含まれる}|\text{対立仮説が正しい})
\end{equation}

</div>
</blockquote></li>

</ul></li>
<li><p>
<b>有意水準</b>
</p>
<blockquote>
<p>
第一種過誤が起きる確率(サイズ)として許容する上限
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org2390714">
<h3 id="org2390714">棄却域の決め方</h3>
<ul>
<li>検定を構成する場合の一般的な戦略: <br />
棄却域 \(R_{\alpha}\) は以下のように設定する
<ul>
<li><b>サイズを小さく</b> (有意水準 \(\alpha\) 以下に) 抑える</li>
<li><p>
可能な限り <b>検出力を大きく</b> する
</p>
<blockquote>
<div>
\begin{align}
  P(T \in R_{\alpha}|\text{帰無仮説が正しい})
    &\le\alpha\\
  P(T \in R_{\alpha}|\text{対立仮説が正しい})
    &\to\text{最大化}
\end{align}

</div>
</blockquote></li>

</ul></li>
<li>対立仮説によって棄却域の形は変わり得る</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org0a81b3a">
<h3 id="org0a81b3a">\(p\)-値 (有意確率)</h3>
<ul>
<li><p>
帰無分布における検定統計量の評価:
</p>
<blockquote>
<p>
検定統計量の値が棄却域に含まれる有意水準の最小値を考える
</p>
</blockquote></li>
<li><p>
<b>\(p\)-値 (有意確率)</b>: (検定統計量 \(T\), 棄却域 \(R_{\alpha}\))
</p>
<blockquote>
<div>
\begin{equation}
  \text{(\(p\) 値)}
  =\min\{\alpha\in(0,1)|\text{\(T\) が\(R_{\alpha}\)に含まれる}\}
\end{equation}

</div>
</blockquote></li>
<li>\(p\)-値が有意水準未満のときに帰無仮説を棄却する</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org6f405e4">
<h3 id="org6f405e4">検定に関する注意</h3>
<ul>
<li><p>
帰無仮説の受容の意味:
</p>
<blockquote>
<p>
帰無仮説が正しいと仮定しても矛盾は生じない
</p>

<p>
帰無仮説の正しさを積極的に支持する結果ではない
</p>
</blockquote></li>
<li><p>
第二種過誤:
</p>
<blockquote>
<p>
一般に第二種過誤の起こる確率については何ら仮定がないため，
その確率は非常に大きい可能性がある
</p>
</blockquote></li>

</ul>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orge71ccfc">
<h2 id="orge71ccfc">1標本正規母集団に対する検定</h2>
<div class="outline-text-2" id="text-orge71ccfc">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orga011837">
<h3 id="orga011837">1標本データに対する仮定</h3>
<ul>
<li>観測データは独立同分布な確率変数列
\(X_1,X_2,\dotsc,X_n\)</li>
<li>\(X_{i}\) は平均 \(\mu\), 分散 \(\sigma^2\) の正規分布に従う</li>
<li>以下では \(\mu\) および分散 \(\sigma^2\) に対する検定を説明</li>

</ul>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org51ae25d">
<h2 id="org51ae25d">平均の検定</h2>
<div class="outline-text-2" id="text-org51ae25d">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgae999b9">
<h3 id="orgae999b9">平均の検定</h3>
<ul>
<li><p>
両側検定
</p>
<blockquote>
<p>
\(\mu_0\) を既知の定数として，
平均 \(\mu\) が真の平均 \(\mu_0\) であるか否かを検定する
</p>
</blockquote>
<ul>
<li>帰無仮説: \(\mu=\mu_0\)</li>
<li><p>
対立仮説: \(\mu\neq\mu_0\)
</p>
<blockquote>
<div>
\begin{equation}
  H_0:\mu=\mu_0\quad\text{vs}\quad H_1:\mu\neq\mu_0.
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc46ac11">
<h3 id="orgc46ac11">考え方</h3>
<ul>
<li>標本平均 \(\bar{X}\) が
真の平均 \(\mu_0\) とどの程度離れているかを検証</li>
<li>平均と分散の推定量を用いて検定統計量を構成
<ul>
<li><p>
標本平均: (正規分布に従う)
</p>
<blockquote>
<div>
\begin{equation}
  \bar{X}=\frac{1}{n}\sum_{i=1}^nX_i
\end{equation}

</div>
</blockquote></li>
<li><p>
不偏分散: (\(\chi^2\) 分布に従う)
</p>
<blockquote>
<div>
\begin{equation}
  s^2=\frac{1}{n{-}1}\sum_{i=1}^n(X_i-\bar{X})^2
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
検定統計量:
</p>
<blockquote>
<div>
\begin{equation}
  t=\frac{\sqrt{n}(\bar{X}-\mu_0)}{s}
\end{equation}

</div>
</blockquote></li>
<li>帰無分布 (帰無仮説 \(H_0\) のもとでの検定統計量 \(t\) の分布)
は自由度 \(n{-}1\) の \(t\) 分布</li>
<li><b>Studentの \(t\) 検定</b></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgbac4022">
<h3 id="orgbac4022">棄却域を用いる場合</h3>
<ul>
<li>有意水準を選択: \(\alpha\in(0,1)\)</li>
<li>自由度 \(n{-}1\) の \(t\) 分布の
\(1{-}\alpha/2\) 分位点: \(t_{1{-}\alpha/2}(n{-}1)\)</li>
<li><p>
\(H_0\) の下で以下が成立:
</p>
<blockquote>
<div>
\begin{equation}
  P(|t|>t_{1{-}\alpha/2}(n{-}1))=\alpha
\end{equation}

</div>
</blockquote></li>
<li><p>
第一種過誤の上限が \(\alpha\) の棄却域:
</p>
<blockquote>
<div>
\begin{equation}
  R_{\alpha}=
  \left(-\infty,-t_{1{-}\alpha/2}(n{-}1)\right)
  \cup\left(t_{1{-}\alpha/2}(n{-}1),\infty\right)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>データから検定統計量 \(t\) の値を計算</li>
<li><p>
以下の場合，帰無仮説を棄却:
</p>
<blockquote>
<div>
\begin{equation}
  |t|>t_{1{-}\alpha/2}(n{-}1),\quad
  (t\in R_{\alpha})
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgaed64b7">
<h3 id="orgaed64b7">\(p\)-値を用いる場合</h3>
<ul>
<li><p>
\(p\) 値を計算: ( \(f(x)\):自由度 \(n{-}1\) の \(t\) 分布の密度)
</p>
<blockquote>
<div>
\begin{equation}
  \text{(\(p\) 値)}
  =2\int_{|t|}^\infty f(x)dx
\end{equation}

</div>
</blockquote></li>
<li><p>
\(p\) 値が \(\alpha\) 未満なら帰無仮説を棄却:
</p>
<blockquote>
<div>
\begin{align}
  |t|>t_{1{-}\alpha/2}(n{-}1)
  &\Leftrightarrow
    \int_{-\infty}^{|t|}f(x)dx>1{-}\alpha/2\\
  &\Leftrightarrow
    2\int_{|t|}^\infty f(x)dx < \alpha
\end{align}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org8701d5b">
<h3 id="org8701d5b">対立仮説の違い</h3>
<ul>
<li><p>
例: 薬の治験
</p>
<blockquote>
<p>
観測データ \(X_1,X_2,\dotsc,X_n\) (\(n\) 人の被験者の治験結果)
に対する仮説:
</p>
<ul>
<li>古い薬(高価)と新しい薬(安価)の効能が変わらない (両側検定)</li>
<li>古い薬に比べて新しい薬の効能が改善した</li>

</ul>
</blockquote></li>
<li>対立仮説によって棄却域の形は変わりうる</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org2c1ca13">
<h3 id="org2c1ca13">平均の検定</h3>
<ul>
<li><p>
片側検定
</p>
<blockquote>
<p>
\(\mu_0\) を既知の定数として，
平均 \(\mu\) が真の平均 \(\mu_0\) より大きいかを検定する
</p>
</blockquote>
<ul>
<li>帰無仮説: \(\mu=\mu_0\)</li>
<li><p>
対立仮説: \(\mu>\mu_0\)
</p>
<blockquote>
<div>
\begin{equation}
  H_0:\mu=\mu_0\quad\text{vs}\quad H_1:\mu>\mu_0.
\end{equation}

</div>
</blockquote></li>

</ul></li>
<li>検定統計量の標本分布:
<ul>
<li>帰無仮説は同一なので検定統計量 \(t\) の帰無分布も同一となる</li>
<li>対立仮説の下で \(t\) の値は正の方向に大きくなると期待される</li>

</ul></li>
<li>棄却域 &ldquo;\(t>c\)&rdquo; (\(c\) は正の数) を考えるのが自然</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org77e031c">
<h3 id="org77e031c">棄却域を用いる場合</h3>
<ul>
<li>有意水準を選択: \(\alpha\in(0,1)\)</li>
<li>自由度 \(n{-}1\) の \(t\) 分布の \(1{-}\alpha\) 分位点:
\(t_{1{-}\alpha}(n{-}1)\)</li>
<li><p>
\(H_0\) の下で以下が成立:
</p>
<blockquote>
<div>
\begin{equation}
  P(t>t_{1{-}\alpha}(n{-}1))=\alpha
\end{equation}

</div>
</blockquote></li>
<li><p>
第一種過誤の上限が \(\alpha\) の棄却域:
</p>
<blockquote>
<div>
\begin{equation}
  R_{\alpha}=
  \left(t_{1{-}\alpha}(n{-}1),\infty\right)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>データから検定統計量 \(t\) の値を計算</li>
<li><p>
以下の場合，帰無仮説を棄却:
</p>
<blockquote>
<div>
\begin{equation}
  t>t_{1{-}\alpha}(n{-}1)
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgf24452d">
<h3 id="orgf24452d">\(p\)-値を用いる場合</h3>
<ul>
<li><p>
\(p\)-値を計算: ( \(f(x)\):自由度 \(n{-}1\) の \(t\) 分布の密度)
</p>
<blockquote>
<div>
\begin{equation}
  \text{(\(p\) 値)}=
  \int_{t}^\infty f(x)dx
\end{equation}

</div>
</blockquote></li>
<li>\(p\)-値が \(\alpha\) 未満なら帰無仮説を棄却</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org677a25b">
<h3 id="org677a25b">両側検定と片側検定</h3>
<ul>
<li><b>右片側検定</b>: 棄却域がある定数 \(a\) によって \((a,\infty)\)</li>
<li><b>左片側検定</b>: 棄却域がある定数 \(a\) によって \((-\infty,a)\)
<ul>
<li>右片側検定と左片側検定を合わせて <b>片側検定</b> と呼ぶ</li>

</ul></li>
<li><b>両側検定</b>: 棄却域がある定数 \(a < b\) によって \((-\infty,a)\cup(b,\infty)\)</li>
<li>平均の検定の場合:
<ul>
<li>対立仮説を \(H_1:\mu\neq\mu_0\) にとった場合は両側検定</li>
<li>対立仮説を \(H_1:\mu>\mu_0\) にとった場合は右片側検定</li>
<li>対立仮説を \(H_1:\mu<\mu_0\) にとった場合は左片側検定</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org18c890c">
<h3 id="org18c890c">左片側検定</h3>
<ul>
<li><p>
反対向きの対立仮説 \(\mu < \mu_0\) を考えた検定
</p>
<blockquote>
<div>
\begin{equation}
  H_0:\mu=\mu_0\quad\text{vs}\quad H_1:\mu < \mu_0.
\end{equation}

</div>
</blockquote></li>
<li>自由度 \(n{-}1\) の \(t\) 分布の \(\alpha\) 分位点:
\(t_{\alpha}(n{-}1)\)</li>
<li>検定の手続き
<ul>
<li><p>
以下の場合，帰無仮説を棄却:
</p>
<blockquote>
<div>
\begin{equation}
  t < t_{\alpha}(n{-}1)
\end{equation}

</div>
</blockquote></li>
<li><p>
以下の \(p\) 値が \(\alpha\) 未満なら帰無仮説を棄却:
</p>
<blockquote>
<div>
\begin{equation}
  \text{(\(p\) 値)}
  =\int_{-\infty}^t f(x)dx
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org790722b">
<h3 id="org790722b">\(t\)-検定の関数</h3>
<ul>
<li><p>
基本書式 
</p>
<div class="org-src-container">

<pre><code class=" R" >t.test(x, # 1標本の場合
       alternative = c("two.sided", "less", "greater"),
       mu = 0, conf.level = 0.95, ...)
## x : ベクトル． 
## alternative: 対立仮説 (両側，左片側，右片側)
## mu: 検定対象の平均値
## conf.level: 信頼区間の水準 (点推定・区間推定も行ってくれる)
## ...: 他のオプション．詳細は help(t.test) を参照
</code></pre>
</div></li>

</ul>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org3c8d011" data-background="#fef4f4">
<h2 id="org3c8d011">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgcd5c334" data-background="#fef4f4">
<h3 id="orgcd5c334">練習問題</h3>
<ul>
<li><p>
適当な正規乱数を用いてMonte-Carlo実験を行い，
t検定の過誤について調べなさい．
</p>
<div class="org-src-container">

<pre><code class=" R" >## 例えば適当な数値を指定して以下のような実験を行えばよい
myTrial &lt;- function(n){ 
    result &lt;- t.test(rnorm(n,mean=mu0,sd=sd0),mu=mu0)
    return(result\(p.value)}
myData &lt;- replicate(mc, myTrial(n))
hist(myData) # p.valueの分布を見る
table(myData&lt;alpha)/mc # alpha以下のデータの数を調べる
</code></pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
ある番組の視聴率が2桁に達したかどうか知りたいとする．
\(n\) 人を対象にその番組を観たかどうか確認したところ
</p>
<div>
\begin{equation}
  X_{i}=
  \begin{cases}
    1,&\text{番組を観た}\\
    0,&\text{番組を観ていない}
  \end{cases},\;
  i=1,2,\dotsc,n
\end{equation}

</div>

<p>
という結果が得られたとする．
これを検定するにはどうしたらよいか考えてみよ．
</p>
<div class="org-src-container">

<pre><code class=" R" >## Xの生成は例えば mu1 を真の視聴率として以下のようにすればよい
x &lt;- sample(0:1,n,replace=TRUE,prob=c(1-mu1,mu1))
</code></pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgd9264e0">
<h2 id="orgd9264e0">分散の検定</h2>
<div class="outline-text-2" id="text-orgd9264e0">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org68c6efa">
<h3 id="org68c6efa">分散の検定</h3>
<ul>
<li><p>
両側検定
</p>
<blockquote>
<p>
\(\sigma_0^2\) を既知の定数として，
分散 \(\sigma^2\) が \(\sigma_0^2\) であるか否かを検定する
</p>
</blockquote>
<ul>
<li>帰無仮説: \(\sigma^2=\sigma_0^2\)</li>
<li><p>
対立仮説: \(\sigma^2\neq\sigma_0^2\)
</p>
<blockquote>
<div>
\begin{equation}
  H_0:\sigma^2=\sigma_0^2\quad\text{vs}\quad H_1:\sigma^2\neq\sigma_0^2
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org0adc96e">
<h3 id="org0adc96e">考え方</h3>
<ul>
<li>不偏分散 \(s^2\) が
真の分散 \(\sigma_{0}^{2}\) とどの程度離れているかを検証</li>
<li>分散の推定量の性質を用いて検定統計量を構成
<ul>
<li><p>
不偏分散: (\(\chi^2\) 分布に従う)
</p>
<blockquote>
<div>
\begin{equation}
  s^2=\frac{1}{n{-}1}\sum_{i=1}^n(X_i-\bar{X})^2 
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
検定統計量:
</p>
<blockquote>
<div>
\begin{equation}
  \chi^2=\frac{(n{-}1)s^2}{\sigma_0^2}
\end{equation}

</div>
</blockquote></li>
<li>帰無分布は自由度 \(n{-}1\) の \(\chi^2\) 分布</li>
<li><b>\(\chi^2\) 検定</b></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org3e7ce59">
<h3 id="org3e7ce59">棄却域を用いる場合</h3>
<ul>
<li>有意水準を選択: \(\alpha\in(0,1)\)</li>
<li>自由度 \(n{-}1\) の \(\chi^2\) 分布の
\(\alpha/2\), \(1{-}\alpha/2\) 分位点:
\(\chi^2_{\alpha/2}(n{-}1)\),
\(\chi^2_{1{-}\alpha/2}(n{-}1)\)</li>
<li><p>
\(H_0\) の下で以下が成立:
</p>
<blockquote>
<div>
\begin{equation}
  P(\chi^2 < \chi^2_{\alpha/2}(n{-}1)
  \text{ または }\chi^2>\chi^2_{1{-}\alpha/2}(n{-}1))
  =\alpha
\end{equation}

</div>
</blockquote></li>
<li><p>
第一種過誤の上限が \(\alpha\) となる棄却域:
</p>
<blockquote>
<div>
\begin{equation}
  R_{\alpha}=
  \left(-\infty,\chi^2_{\alpha/2}(n{-}1)\right)
  \cup\left(\chi^2_{1{-}\alpha/2}(n{-}1),\infty\right)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>データから検定統計量 \(\chi^2\) の値を計算</li>
<li><p>
以下の場合，帰無仮説を棄却:
</p>
<blockquote>
<div>
\begin{equation}
  \chi^2 < \chi^2_{\alpha/2}(n{-}1)
  \text{ または }\chi^2>\chi^2_{1{-}\alpha/2}(n{-}1)
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgf625a12">
<h3 id="orgf625a12">\(p\)-値を用いる場合</h3>
<ul>
<li><p>
\(p\)-値を計算: ( \(f(x)\): 自由度 \(n{-}1\) の \(\chi^2\) 分布の密度)
</p>
<blockquote>
<div>
\begin{equation}
  \text{(\(p\) 値)}
  =2\min\left\{\int_0^{\chi^2}f(x)dx,\int_{\chi^2}^\infty f(x)dx\right\}
\end{equation}

</div>
</blockquote></li>
<li>\(p\)-値が \(\alpha\) 未満なら帰無仮説を棄却</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orge6e1010">
<h3 id="orge6e1010">片側検定</h3>
<ul>
<li>対立仮説が片側 (右側対立仮説) の場合:
<ul>
<li>帰無仮説: \(\sigma^2=\sigma_0^2\)</li>
<li><p>
対立仮説: \(\sigma^2>\sigma_0^2\)
</p>
<blockquote>
<div>
\begin{equation}%\label{two-side}
  H_0:\sigma^2=\sigma_0^2\quad
  \text{vs}\quad H_1:\sigma^2>\sigma_0^2
\end{equation}

</div>
</blockquote></li>

</ul></li>
<li>(左側対立仮説 \(H_1:\sigma^2 < \sigma_0^2\) も以下の議論は同様)</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org3a56f17">
<h3 id="org3a56f17">棄却域を用いる場合</h3>
<ul>
<li>自由度 \(n{-}1\) の \(\chi^2\) 分布の \(1{-}\alpha\) 分位点:
\(\chi^2_{1{-}\alpha}(n{-}1)\)</li>
<li><p>
以下の場合，帰無仮説を棄却:
</p>
<blockquote>
<div>
\begin{equation}
  \chi^2>\chi^2_{1{-}\alpha}(n{-}1)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org757c8a6">
<h3 id="org757c8a6">\(p\) 値を用いる場合</h3>
<ul>
<li><p>
\(p\) 値を計算: ( \(f(x)\):自由度 \(n{-}1\) の \(\chi^2\) 分布の密度)
</p>
<blockquote>
<div>
\begin{equation}
  \text{(\(p\) 値)}
  =\int_{\chi^2}^\infty f(x)dx
\end{equation}

</div>
</blockquote></li>
<li>\(p\) 値が \(\alpha\) 未満なら帰無仮説を棄却</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org42d1774">
<h3 id="org42d1774">\(\chi^2\) 検定の関数</h3>
<ul>
<li>関数 <code>chisq.test</code> はあるが目的が違うので注意</li>
<li><p>
以下のように計算できる
</p>
<div class="org-src-container">

<pre><code class=" R" >x # 観測データ
sigma0 # 帰無仮説で用いる標準偏差
n &lt;- length(x) # データ数
chi2 &lt;- (n-1)*var(x)/sigma0^2 # 検定統計量
p0 &lt;- pchisq(chi2, df=n-1)
2*min(p0, 1-p0) # p値 (両側検定の場合)
</code></pre>
</div></li>

</ul>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org40d265b" data-background="#fef4f4">
<h2 id="org40d265b">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc3b4ffd" data-background="#fef4f4">
<h3 id="orgc3b4ffd">練習問題</h3>
<ul>
<li><p>
東京の気象データの気温の項目を用いて，
6月の気温の分散が，
月毎に計算した気温の分散の平均値より大きいかどうか検定せよ．
</p>
<div class="org-src-container">

<pre><code class=" R" >myData &lt;- read.csv("data/tokyo_weather.csv",
		   fileEncoding="utf8")
## 月毎の気温の分散は以下で計算できる
aggregate(気温~月,data=myData,FUN=var)
## この平均値は以下のように計算される
mean(aggregate(気温~月,data=myData,FUN=var)\(気温)
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org3e8bf9f">
<h2 id="org3e8bf9f">2標本正規母集団に対する検定</h2>
<div class="outline-text-2" id="text-org3e8bf9f">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc382740">
<h3 id="orgc382740">2標本データに対する仮定</h3>
<ul>
<li>2種類の観測データ:
<ul>
<li>\(X_1,X_2,\dotsc,X_m\)</li>
<li>\(Y_1,Y_2,\dotsc,Y_n\)</li>

</ul></li>
<li>3つの条件を仮定:
<ul>
<li>\(X_1,X_2,\dotsc,X_m,Y_1,Y_2,\dotsc,Y_n\) は
独立な確率変数列</li>
<li>\(X_1,\dotsc,X_m\) は同分布で，
平均 \(\mu_1\), 分散 \(\sigma_1^2\) の正規分布に従う</li>
<li>\(Y_1,\dotsc,Y_n\) は同分布で，
平均 \(\mu_2\), 分散 \(\sigma_2^2\) の正規分布に従う</li>

</ul></li>
<li>両者の平均や分散が一致するかどうかを検定する問題を考える</li>

</ul>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org186dbf3">
<h2 id="org186dbf3">平均の差の検定</h2>
<div class="outline-text-2" id="text-org186dbf3">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgfd285cf">
<h3 id="orgfd285cf">平均の差の検定</h3>
<ul>
<li><p>
2種類のデータの平均が等しいか否かを検定する
</p>
<blockquote>
<div>
\begin{equation}%\label{mean-equal}
  H_0:\mu_1=\mu_2\quad\text{vs}\quad H_1:\mu_1\neq\mu_2
\end{equation}

</div>
</blockquote></li>
<li><b>Behrens-Fisher問題</b> 
<ul>
<li>正確かつ適切な検定を導出することは難しい</li>

</ul></li>
<li><b>Welch(またはSatterthwaite)の近似法</b>
<ul>
<li>\(\chi^2\) 分布に従う独立確率変数列の一次結合の分布を，
1つの \(\chi^2\) 分布に従う確率変数の定数倍の分布で近似する方法</li>
<li>平均と分散が元の確率変数と一致するように近似</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org3eb14c8">
<h3 id="org3eb14c8">考え方</h3>
<ul>
<li><p>
\(X_1,\dotsc,X_m\) および \(Y_1,\dotsc,Y_m\) の不偏分散:
\(s_1^2\),\(s_2^2\)
</p>
<div>
\begin{equation}
  s_1^2=\frac{1}{m{-}1}\sum_{i=1}^m(X_i-\bar{X})^2,\quad
  s_2^2=\frac{1}{n{-}1}\sum_{i=1}^n(Y_i-\bar{Y})^2.
\end{equation}

</div></li>
<li>標本平均と不偏分散の性質:
<ul>
<li>\(\bar{X}-\bar{Y},s_1^2,s_2^2\) は独立となる</li>
<li>\((m{-}1)s_1^2/\sigma_1^2\)
は自由度 \(m{-}1\) の \(\chi^2\) 分布に従う</li>
<li>\((n{-}1)s_2^2/\sigma_2^2\)
は自由度 \(n{-}1\) の \(\chi^2\) 分布に従う</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org7b221c0">
<h3 id="org7b221c0">Welchの近似法</h3>
<ul>
<li><b>詳細は資料を参照</b></li>
<li>確率変数 \(s_1^2/m+s_2^2/n\) の分布を \(c\chi^2_\nu\) の分布で近似</li>
<li><p>
\(\chi^2_\nu\) は自由度 \(\nu\) の \(\chi^2\) 分布に従う確率変数
</p>
<blockquote>
<div>
\begin{equation}
  c=\frac{\frac{(\sigma_1^2/m)^2}{m{-}1}
    +\frac{(\sigma_2^2/n)^2}{n{-}1}}{\sigma_1^2/m+\sigma_2^2/n},\quad
  \nu=\frac{(\sigma_1^2/m+\sigma_2^2/n)^2}{\frac{(\sigma_1^2/m)^2}{m{-}1}
    +\frac{(\sigma_2^2/n)^2}{n{-}1}}
\end{equation}

</div>
</blockquote>
<ul>
<li>平均と分散を合わせる</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
検定統計量:
</p>
<blockquote>
<div>
\begin{equation}
  t=\frac{\bar{X}-\bar{Y}}{\sqrt{s_1^2/m+s_2^2/n}}
  \simeq\frac{\bar{X}-\bar{Y}}{\sqrt{c\chi^2_\nu}}
\end{equation}

</div>
</blockquote></li>
<li>\(\bar{X}-\bar{Y},s_1^2/m+s_2^2/n\) は独立</li>
<li>\(\bar{X}-\bar{Y},c\chi^2_\nu\) も独立と考える</li>
<li>\(t\) の分布は \((\bar{X}-\bar{Y})/\sqrt{c\chi^2_\nu}\) で近似できる</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org7f0a73b">
<h3 id="org7f0a73b">帰無分布の近似</h3>
<ul>
<li><p>
データの正規性から以下は標準正規分布に従う
</p>
<blockquote>
<div>
\begin{equation}
  \frac{(\bar{X}-\bar{Y})-(\mu_1{-}\mu_2)}
  {\sqrt{\sigma_1^2/m+\sigma_2^2/n}}
\end{equation}

</div>
</blockquote></li>
<li><p>
\(H_0\) の下で以下は自由度 \(\nu\) の \(t\) 分布に従う
</p>
<blockquote>
<div>
\begin{equation}
  t\simeq
  \frac{\bar{X}-\bar{Y}}{\sqrt{c\chi^2_\nu}}
  =\frac{(\bar{X}-\bar{Y})/\sqrt{\sigma_1^2/m+\sigma_2^2/n}}
    {\sqrt{\frac{c}{\sigma_1^2/m+\sigma_2^2/n}\chi^2_\nu}}
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>検定統計量 \(t\) の帰無分布は自由度 \(\nu\) の \(t\) 分布で近似できる</li>
<li><p>
\(\nu\) は未知の分散 \(\sigma_1^2,\sigma_2^2\) を含むので
不偏推定量 \(s_1^2,s_2^2\) で代用して, 
次式で与えられる自由度 \(\hat{\nu}\) を用いる:
</p>
<blockquote>
<div>
\begin{equation}
  \hat{\nu}
  =\frac{(s_1^2/m+s_2^2/n)^2}
  {\frac{(s_1^2/m)^2}{m{-}1}+\frac{(s_2^2/n)^2}{n{-}1}}.
\end{equation}

</div>
</blockquote></li>
<li><b>Welchの \(t\) 検定</b></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org5fdc0cf">
<h3 id="org5fdc0cf">棄却域を用いる場合</h3>
<ul>
<li>有意水準を選択: \(\alpha\in(0,1)\)</li>
<li>自由度 \(\hat{\nu}\) の \(t\) 分布の \(1{-}\alpha/2\) 分位点:
\(t_{1{-}\alpha/2}(\hat{\nu})\)</li>
<li><p>
棄却域:
</p>
<blockquote>
<div>
\begin{equation}
  \left(-\infty,-t_{1{-}\alpha/2}(\hat{\nu})\right)
  \cup\left(t_{1{-}\alpha/2}(\hat{\nu}),\infty\right)
\end{equation}

</div>
</blockquote></li>
<li><p>
検定統計量 \(t\) の値を計算し，以下の場合は帰無仮説を棄却:
</p>
<blockquote>
<div>
\begin{equation}
  |t|>t_{1{-}\alpha/2}(\hat{\nu})
\end{equation}

</div>
</blockquote></li>
<li>(\(p\) 値の計算や片側対立仮説への対応は前と同様)</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgf97e306">
<h3 id="orgf97e306">対応がある場合の平均の差の検定</h3>
<ul>
<li><p>
対応がある観測データの平均の差の検定では
2種類のデータ間の自然な対応を考慮することがある
</p>
<blockquote>
<p>
薬の投薬の例:
</p>
<ul>
<li>2種類の薬の効能を比較するために被験者に両方の薬を投与</li>
<li>被験者 \(i\) にそれぞれの薬を投与した場合の治験結果: \(X_i,Y_i\)</li>
<li>\(X_i\) と \(Y_i\) には&ldquo;同一の被験者に対する治験結果&rdquo;という意味で対応がある</li>

</ul>
</blockquote></li>
<li>&ldquo;対応がある観測値の差の平均が0&rdquo;
という帰無仮説を考える</li>
<li>\(Z_i=X_i-Y_i\) \((i=1,\dotsc,n)\) として，
\(Z_1,\dotsc,Z_n\) の平均が0か否かを検定すれば良い</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgb60bd0d">
<h3 id="orgb60bd0d">\(t\) 検定の関数</h3>
<ul>
<li><p>
基本書式 
</p>
<div class="org-src-container">

<pre><code class=" R" >t.test(x, y = NULL, # 2標本の場合
       alternative = c("two.sided", "less", "greater"),
       mu = 0, paired = FALSE, var.equal = FALSE,
       conf.level = 0.95, ...)
## x,y: ベクトル．2標本の場合はyを指定する
## alternative: 対立仮説 (両側，左片側，右片側)
## mu: 検定対象の平均値
## paired: 対応ありの場合は TRUE
## var.equal: 2標本の分散を同じとして良い場合は TRUE
</code></pre>
</div></li>

</ul>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org28ad100">
<h2 id="org28ad100">分散の比の検定</h2>
<div class="outline-text-2" id="text-org28ad100">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orge43f672">
<h3 id="orge43f672">分散の比の検定</h3>
<ul>
<li><p>
2種類のデータの分散が等しいか否かを検定する
</p>
<blockquote>
<div>
\begin{equation}
  H_0:\sigma_1^2=\sigma_2^2\quad\text{vs}\quad H_1:\sigma_1^2\neq\sigma_2^2
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgcb9a919">
<h3 id="orgcb9a919">考え方</h3>
<ul>
<li>\(X_1,\dotsc,X_m\) の不偏分散: \(s_1^2\)</li>
<li>\(Y_1,\dotsc,Y_n\) の不偏分散: \(s_2^2\)</li>
<li>このとき \(s_1^2,s_2^2\) は独立でそれぞれ
<ul>
<li>\((m{-}1)s_1^2/\sigma_1^2\)
自由度 \(m{-}1\) の \(\chi^2\) 分布に従う</li>
<li>\((n{-}1)s_2^2/\sigma_2^2\)
は自由度 \(n{-}1\) の \(\chi^2\) 分布に従う</li>

</ul></li>
<li><p>
検定統計量:
</p>
<blockquote>
<div>
\begin{equation}
  F=\frac{s_1^2}{s_2^2}
\end{equation}

</div>
</blockquote></li>
<li>帰無分布は自由度 \(m{-}1,n{-}1\) の \(F\) 分布</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgd54d988">
<h3 id="orgd54d988">棄却域を用いる場合</h3>
<ul>
<li>有意水準を選択: \(\alpha\in(0,1)\)</li>
<li>自由度 \(m{-}1,n{-}1\) の \(F\) 分布の
\(\alpha/2,\,1{-}\alpha/2\) 分位点:
\(F_{\alpha/2}(m{-}1,n{-}1)\),
\(F_{1{-}\alpha/2}(m{-}1,n{-}1)\)</li>
<li><p>
\(H_0\) の下では以下が成立:
</p>
<blockquote>
<div>
\begin{equation}
  P(F < F_{\alpha/2}(m{-}1,n{-}1)
  \text{ または }F > F_{1{-}\alpha/2}(m{-}1,n{-}1))=\alpha
\end{equation}

</div>
</blockquote></li>
<li><p>
第一種過誤の上限が \(\alpha\) の棄却域:
</p>
<blockquote>
<div>
\begin{equation}
  R_{\alpha}=
  \left(-\infty,F_{\alpha/2}(m{-}1,n{-}1)\right)
  \cup\left(F_{1{-}\alpha/2}(m{-}1,n{-}1),\infty\right)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>データから検定統計量 \(F\) の値を計算</li>
<li><p>
以下の場合，帰無仮説を棄却
</p>
<blockquote>
<div>
\begin{equation}
  F < F_{\alpha/2}(m{-}1,n{-}1)
  \text{ または }F>F_{1{-}\alpha/2}(m{-}1,n{-}1)
\end{equation}

</div>
</blockquote></li>
<li>(\(p\) 値の計算や片側対立仮説への対応は前と同様)</li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org2cb1f34">
<h3 id="org2cb1f34">F検定の関数</h3>
<ul>
<li><p>
基本書式 
</p>
<div class="org-src-container">

<pre><code class=" R" >var.test(x, y, ratio = 1,
	 alternative = c("two.sided", "less", "greater"),
	 conf.level = 0.95, ...)
## x,y: ベクトル． 
## ratio: 検定する比率(1は同じかどうか)
## alternative: 対立仮説 (両側，左片側，右片側)
## conf.level: 信頼区間の水準 (点推定・区間推定も行ってくれる)
</code></pre>
</div></li>

</ul>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org8410caf" data-background="#fef4f4">
<h2 id="org8410caf">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org4ba747e" data-background="#fef4f4">
<h3 id="org4ba747e">練習問題</h3>
<ul>
<li>東京の気象データの気温の項目を用いて，
7月と8月の気温の平均が同じかどうか検定しなさい．</li>
<li>同様に3月と6月の気温の分散が同じかどうか検定しなさい．</li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/highlight/highlight.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,

overview: true,

transition: 'fade',
transitionSpeed: 'default',
spotlight: { size: 90, initialPresentationMode: false }, chalkboard: { toggleChalkboardButton: { left: '80px' }, toggleNotesButton: { left: '130px'}}, keyboard: { 69: function() { RevealChalkboard.toggleNotesCanvas() }, 87: function() { RevealChalkboard.toggleChalkboard() }, 67: function() { RevealChalkboard.clear() }, 82: function() { RevealChalkboard.reset() }, 68: function() { RevealChalkboard.download() }, 88: function() { RevealChalkboard.colorNext() }, 89: function() { RevealChalkboard.colorPrev() }, 84: function() { RevealSpotlight.toggleSpotlight() }, 81: function() { RevealSpotlight.togglePresentationMode()}},

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealHighlight ],

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/menu/menu.js'},
{ src: './reveal.js/plugin/chalkboard/chalkboard.js'},
{ src: './reveal.js/plugin/spotlight/spotlight.js'}]

});
</script>
</body>
</html>
