<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>確率分布</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/menu/menu.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/menu/font-awesome/css/fontawesome.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/chalkboard/style.css"/>

<link rel="stylesheet" href="./reveal.js/local/mycourse.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">確率分布</h1>
</div>
<div class="talk-subtitle">
    <p>第8講 - いろいろな離散分布と連続分布</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  </p>
</div>

</section>
<section>
<section id="slide-org212961b">
<h2 id="org212961b">講義概要</h2>
<ul>
<li>一般の確率変数</li>
<li>離散分布
<ul>
<li>離散一様分布・二項分布</li>
<li>Poisson 分布・幾何分布</li>

</ul></li>
<li>連続分布
<ul>
<li>一様分布・正規分布</li>
<li>ガンマ分布・\(t\) 分布・\(F\) 分布</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-org99e658b">
<h2 id="org99e658b">一般の確率変数</h2>
<div class="outline-text-2" id="text-org99e658b">
</div>
</section>
<section id="slide-orgc0fa945">
<h3 id="orgc0fa945">確率分布</h3>
<ul>
<li>確率変数 \(X\) 
<ul>
<li>値がランダムに決定される変数</li>
<li>任意の区間 \([a,b]\) に含まれる確率が定められている</li>

</ul></li>
<li>確率分布 \(P\) (または単に分布) 
<ul>
<li><p>
区間 \([a,b]\) \((a\leq b)\) に \(X\) が含まれる確率
</p>
<blockquote>
<div>
\begin{equation}
  P(a\leq X\leq b)
\end{equation}

</div>
</blockquote></li>
<li>「確率変数 \(X\) は確率分布 \(P\) に従う」という</li>
<li>現象の理解のためには実現値より確率分布にこそ興味がある</li>

</ul></li>

</ul>
</section>
<section id="slide-orgd6e41a6">
<h3 id="orgd6e41a6">極限定理</h3>
<ul>
<li>大数の法則，
中心極限定理，
少数の法則など</li>
<li>緩やかな条件のもとで一般の確率変数の列についても成立する
<ul>
<li>大数の強法則は平均が存在すれば成立する <br />
(平均と分散は後に定義する)</li>
<li>2次のモーメントをもたない(計算できない)場合には
中心極限定理は成立しない <br />
(そもそも分散が定義できない)</li>

</ul></li>

</ul>
</section>
<section id="slide-org5c6546e">
<h3 id="org5c6546e">確率変数列の独立性</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
\(n\) 個の確率変数 \(X_{1},X_{2},\dotsc,X_n\) が <b>独立</b> であるとは，
\(a_i\leq b_i\) \((i=1,\dots,n)\) なる
任意の実数 \(a_{1},b_{1},\dots,a_n,b_n\) に対して
</p>
<div>
\begin{multline}
  P(a_{1}\leq X_{1}\leq b_{1},a_{2}\leq X_{2}\leq b_{2},\dots,a_n\leq X_n\leq b_n)\\
  =P(a_{1}\leq X_{1}\leq b_{1})P(a_{2}\leq X_{2}\leq b_{2})\cdots P(a_n\leq X_n\leq b_n)
\end{multline}

</div>
<p>
が成り立つことをいう．
</p>
</blockquote></li>

</ul>
</section>
<section id="slide-org57452d5">
<h3 id="org57452d5">確率変数列の同分布性</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
\(n\) 個の確率変数 \(X_{1},X_{2},\dotsc,X_n\) が <b>同分布</b> であるとは，
\(a\leq b\) なる任意の実数 \(a,b\) に対して
</p>
<div>
\begin{equation}
  P(a\leq X_{1}\leq b)=P(a\leq X_{2}\leq b)=\cdots=P(a\leq X_n\leq b)
\end{equation}

</div>
<p>
が成り立つことをいう．
</p>
</blockquote></li>

</ul>
</section>
</section>
<section>
<section id="slide-org1338f74">
<h2 id="org1338f74">離散分布</h2>
<div class="outline-text-2" id="text-org1338f74">
</div>
</section>
<section id="slide-orgf6f402b">
<h3 id="orgf6f402b">離散分布</h3>
<ul>
<li>離散型確率変数 
<ul>
<li>取りうる値が有限個 <br />
もしくは可算無限個 (例えば整数値のみとる場合)</li>

</ul></li>
<li>離散分布 
<ul>
<li>離散型確率変数の確率分布</li>
<li>\(X=x\) となる確率 \(P(X=x)\) で完全に決定される</li>
<li>関数 \(f(x)=P(X=x)\) を 
<b>確率質量関数</b> (<b>確率関数</b>)
と呼ぶ</li>

</ul></li>

</ul>
</section>
<section id="slide-orgbaddcfb">
<h3 id="orgbaddcfb">離散分布の平均</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
以下の右辺が定義できる(絶対収束する)とき
離散型の確率変数 
\(X\) の <b>平均</b> (または <b>期待値</b> )を
</p>
<div>
\begin{equation}
  \mathbb{E}[X]=\sum_{x\in\mathcal{X}}xP(X=x)
\end{equation}

</div>
<p>
で定義する．
</p>

<p>
ただし 
\(\mathcal{X}\) は \(X\) の取りうる値(無限個も可)の集合
</p>
</blockquote>
<ul>
<li>級数 \(\sum_{x\in\mathcal{X}}xP(X=x)\) が
定義できない場合は
\(X\) は <b>平均をもたない</b> とする</li>

</ul></li>

</ul>

</section>
<section>
<ul>
<li><p>
確率変数の変換 \(\varphi(X)\) の期待値
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}[\varphi(X)]=\sum_{x\in\mathcal{X}}\varphi(x)P(X=x)
\end{equation}

</div>
</blockquote></li>
<li><p>
\(p\) 次の <b>モーメント</b> (あるいは <b>積率</b> )
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}[X^p]=\sum_{x\in\mathcal{X}}x^pP(X=x)
\end{equation}

</div>
</blockquote>
<ul>
<li>\(X\) が正整数 \(p\) 次のモーメントをもてば，
\(q\leq p\) なるすべての正整数 \(q\) 次のモーメントをもつ</li>

</ul></li>

</ul>
</section>
<section id="slide-org6fc14bf">
<h3 id="org6fc14bf">離散分布の分散</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<div>
\begin{align}
  \mathrm{Var}(X)
  =&\mathbb{E}[(X-\mathbb{E}[X])^2]\\
  =&\sum_{x\in\mathcal{X}}(x-\mathbb{E}[X])^2P(X=x)
\end{align}

</div>
</blockquote>
<ul>
<li>\(X\) が <b>2次のモーメントをもつ</b> ときのみ定義できる</li>
<li>分散の平方根\(\sqrt{\mathrm{Var}(X)}\) を <b>標準偏差</b> と呼ぶ</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-orga521f9b">
<h2 id="orga521f9b">離散一様分布</h2>
</section>
<section id="slide-org92b59e7">
<h3 id="org92b59e7">離散一様分布の確率質量関数</h3>
<ul>
<li><p>
集合 \(\{x_{1},\dotsc,x_n\}\) 上の離散一様分布
</p>
<blockquote>
<p>
相異なる実数
\(x_{1},\dotsc,x_n\) 
を壺から無作為に取り出す試行
</p>
</blockquote></li>
<li><p>
確率質量関数 
</p>
<blockquote>
<div>
\begin{equation}
  f(x)=\frac{1}{n},\quad
  x\in\{x_{1},\dots,x_n\}
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-org0bb58b4">
<h3 id="org0bb58b4">離散一様分布の平均と分散</h3>
<ul>
<li><p>
平均
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}[X]
  =\sum_{i=1}^nx_if(x_i)
  =\frac{1}{n}\sum_{i=1}^nx_i=\bar{x}
\end{equation}

</div>
</blockquote></li>
<li><p>
分散
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{Var}(X)
  =\sum_{i=1}^n(x_i-\mathbb{E}[X])^2f(x_i)
  =\frac{1}{n}\sum_{i=1}^n(x_i-\bar{x})^2
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-orge194aa6">
<h3 id="orge194aa6">離散一様分布に従う乱数</h3>
<ul>
<li>歪みのないサイコロを1回投げたときに出る目の分布は, 
集合 \(\{1,\dots,6\}\) 上の離散一様分布に従う</li>
<li>乱数の発生は
関数 <code>sample()</code> が利用できる</li>
<li><p>
復元抽出はオプション <code>replace=TRUE</code> を指定
</p>
<pre class="example">
a &lt;- 1:6 # サンプリング対象の集合をベクトルとして定義(文字列でも構わない)
sample(a, size=20, replace=TRUE) # 離散一様分布(20個)
</pre></li>

</ul>
</section>
</section>
<section>
<section id="slide-orgcf0a4be">
<h2 id="orgcf0a4be">二項分布</h2>
</section>
<section id="slide-org581dacc">
<h3 id="org581dacc">二項分布の確率質量関数</h3>
<ul>
<li><p>
試行回数 \(n\) , 成功確率 \(p\) の二項分布
</p>
<blockquote>
<p>
確率 \(p\) で成功する試行を \(n\) 回行った総成功回数
</p>
</blockquote></li>
<li><p>
確率質量関数
</p>
<blockquote>
<div>
\begin{equation}
  f(x)=\Bigl({n\atop x}\Bigr)p^x(1-p)^{n-x},\quad x=0,1,\dots,n
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-orgb3acdbb">
<h3 id="orgb3acdbb">二項分布の平均</h3>
<ul>
<li><p>
平均
</p>
<blockquote>
<div>
\begin{align}
  \mathbb{E}[X]
  &=\sum_{x=0}^nxf(x)=\sum_{x=0}^nx\Bigl({n\atop x}\Bigr)p^x(1-p)^{n-x}\\
  &=\sum_{x=1}^n\frac{n!}{(x-1)!(n-x)!}p^x(1-p)^{n-x}\\
  % &=\sum_{x=0}^{n-1}\frac{n!}{x!(n-x-1)!}p^{x+1}(1-p)^{n-x-1}\\
  &=np\sum_{x=0}^{n-1}\Bigl({n-1\atop x}\Bigr)p^{x}(1-p)^{n-1-x}\\
  &=np
\end{align}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-org410eb33">
<h3 id="org410eb33">二項分布の分散</h3>
<ul>
<li><p>
2次モーメント 
</p>
<blockquote>
<div>
\begin{align}
  \mathbb{E}[X^2]
  &=\sum_{x=0}^nx^2f(x)
    =\sum_{x=0}^nx(x-1)\Bigl({n\atop x}\Bigr)p^x(1-p)^{n-x}+\mathbb{E}[X]\\
    % &=\sum_{x=2}^n\frac{n!}{(x-2)!(n-x)!}p^x(1-p)^{n-x}+np\\
    % &=\sum_{x=0}^{n-2}\frac{n!}{x!(n-x-2)!}p^{x+2}(1-p)^{n-x-2}+np\\
  &=n(n-1)p^2\sum_{x=0}^{n-2}\Bigl({n-2\atop x}\Bigr)p^{x}(1-p)^{n-2-x}+np\\
  &=n(n-1)p^2+np
    =(np)^2+np(1-p)
\end{align}

</div>
</blockquote></li>
<li><p>
分散 
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{Var}(X)
  =\mathbb{E}[X^2]-\mathbb{E}[X]^2
  =np(1-p)
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-org1f41a54">
<h3 id="org1f41a54">二項分布に従う乱数</h3>
<ul>
<li>表が出る確率が \(p\) のコインを \(n\) 回投げたときに表が出る回数は，
試行回数 \(n\) ，成功確率 \(p\) の二項分布に従う</li>
<li>試行回数1の二項分布を <b>Bernoulli分布</b> と呼ぶ</li>
<li><p>
乱数の発生は関数 <code>rbinom()</code> を用いる
</p>
<div class="org-src-container">

<pre class="src src-R">rbinom(10, size=1, prob=0.2) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">Bernoulli&#20998;&#24067;(10&#20491;)</span>
rbinom(20, size=5, prob=0.6) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#20108;&#38917;&#20998;&#24067;(20&#20491;)</span>
</pre>
</div>

<pre class="example">
 [1] 1 0 1 1 0 0 0 1 1 0
[1] 2 1 3 2 2 2 4 3 2 2 2 2 4 5 2 2 2 3 4 1
</pre></li>

<li>確率質量関数は関数 <code>dbinom()</code> で計算できる</li>

</ul>
</section>
</section>
<section>
<section id="slide-org663c028" data-background="#fef4f4">
<h2 id="org663c028">実習</h2>
</section>
<section id="slide-orgeb30ce4">
<h3 id="orgeb30ce4">数値実験の雛形(離散分布)</h3>
<ul>
<li>人工的に生成した乱数と理論曲線(確率質量関数)との比較を行う</li>
<li><p>
数値実験の雛形は以下のようになる
</p>
<div class="org-src-container">

<pre class="src src-R">mc <span style="color: #60aa00;">&lt;-</span> 10000 <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#23455;&#39443;&#22238;&#25968;&#12434;&#25351;&#23450;</span>
<span style="color: #b77fdb; font-weight: bold;">my_random</span> <span style="color: #60aa00;">&lt;-</span> <span style="color: #6c9ef8;">function</span>(){...} <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#20081;&#25968;&#29983;&#25104;&#12398;&#12503;&#12525;&#12464;&#12521;&#12512;</span>
<span style="color: #b77fdb; font-weight: bold;">my_dist</span> <span style="color: #60aa00;">&lt;-</span> <span style="color: #6c9ef8;">function</span>(){...} <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#24517;&#35201;&#12391;&#12354;&#12428;&#12400;&#29702;&#35542;&#26354;&#32218;&#12434;&#23450;&#32681;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> &#12383;&#12384;&#12375;&#22810;&#12367;&#12398;&#22580;&#21512; d"&#20081;&#25968;&#21517;"&#12391;&#23450;&#32681;&#12373;&#12428;&#12390;&#12356;&#12427;&#12398;&#12391;&#12381;&#12428;&#12425;&#12434;&#29992;&#12356;&#12428;&#12400;&#12424;&#12356;</span>
my_data <span style="color: #60aa00;">&lt;-</span> replicate(mc, my_random()) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">Monte-Carlo&#23455;&#39443;</span>
my_table <span style="color: #60aa00;">&lt;-</span> table(my_data)/mc <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#21516;&#12376;&#20516;&#12398;&#38971;&#24230;&#12363;&#12425;&#30906;&#29575;&#12434;&#35336;&#31639;</span>
tibble(count = as.numeric(names(my_table)),
       observation = as.numeric(my_table),
       theory = dbinom(&#20516;, size = n, prob = p)) |&gt;
  pivot_longer(!count, values_to = <span style="color: #d08928;">"probability"</span>) |&gt;
  ggplot(aes(x = count, y = probability, fill = name)) +
  geom_bar(stat = <span style="color: #d08928;">"identity"</span>, width = 0.8, position = <span style="color: #d08928;">"dodge"</span>)
</pre>
</div></li>

</ul>
</section>
<section id="slide-org635f32e" data-background="#fef4f4">
<h3 id="org635f32e">練習問題</h3>
<ul>
<li>二項分布に関して以下を考察せよ．
<ul>
<li>平均と分散の計算を確認しなさい．</li>
<li>\(X_{1},\dotsc,X_n\) を成功確率 \(p\) の
Bernoulli 分布に従う独立同分布な確率変数列とする．
このとき \(\sum_{i=1}^nX_i\) の分布は，
試行回数 \(n\) , 成功確率 \(p\) の二項分布に従う．
これをグラフに描画して確認しなさい．</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-orgcea9a9b">
<h2 id="orgcea9a9b">Poisson 分布</h2>
</section>
<section id="slide-org5353621">
<h3 id="org5353621">Poisson 分布の確率質量関数</h3>
<ul>
<li><p>
強度 \(\lambda\) の Poisson 分布
\(Po(\lambda)\) (\(\lambda > 0\))
</p>
<blockquote>
<p>
少数の法則に現れた滅多に起こらない事象の起こる回数の分布
</p>
</blockquote></li>
<li><p>
確率質量関数
</p>
<blockquote>
<div>
\begin{equation}
  f(x)=\frac{\lambda^x}{x!}e^{-\lambda},\quad x=0,1,\dotsc
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-org02d4274">
<h3 id="org02d4274">Poisson 分布の平均</h3>
<ul>
<li><p>
平均
</p>
<blockquote>
<div>
\begin{align}
  \mathbb{E}[X]
  &=\sum_{x=0}^\infty xf(x)=\sum_{x=0}^\infty x\frac{\lambda^x}{x!}e^{-\lambda}
    =e^{-\lambda}\sum_{x=1}^\infty\frac{\lambda^x}{(x-1)!}\\
  &=\lambda e^{-\lambda}\sum_{x=0}^\infty\frac{\lambda^x}{x!}
    =\lambda
\end{align}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-org7195c6c">
<h3 id="org7195c6c">Poisson 分布の分散</h3>
<ul>
<li><p>
2次モーメント
</p>
<blockquote>
<div>
\begin{align}
  \mathbb{E}[X^2]
  &=\sum_{x=0}^\infty x^2f(x)
    =\sum_{x=0}^\infty x(x-1)\frac{\lambda^x}{x!}e^{-\lambda}+\mathbb{E}[X]\\
  &=e^{-\lambda}\sum_{x=2}^\infty\frac{\lambda^x}{(x-2)!}+\lambda
    =\lambda^2 e^{-\lambda}\sum_{x=0}^\infty\frac{\lambda^x}{x!}+\lambda\\
  &=\lambda^2+\lambda
\end{align}

</div>
</blockquote></li>
<li><p>
分散
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{Var}(X)
  =\mathbb{E}[X^2]-\mathbb{E}[X]^2=\lambda
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-org1339e4d">
<h3 id="org1339e4d">Poisson 分布に従う乱数</h3>
<ul>
<li>発生確率が低い事象が十分長い期間で起こる回数の分布は
Poisson 分布で近似できる (<b>少数の法則</b>)
<ul>
<li><span style="color:green;">一定時間に放射性物質から放射される粒子の数</span></li>
<li><span style="color:green;">一定時間に発生する交通事故の件数</span></li>

</ul></li>
<li><p>
乱数の発生は関数 <code>rpois()</code> を用いる
</p>
<div class="org-src-container">

<pre class="src src-R">rpois(15, lambda=1) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#24375;&#24230;1&#12398; Poisson &#20998;&#24067;(15&#20491;)</span>
rpois(15, lambda=10) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#24375;&#24230;10&#12398; Poisson &#20998;&#24067;(15&#20491;)</span>
</pre>
</div>

<pre class="example">
 [1] 1 1 1 1 0 2 1 1 0 0 2 1 1 3 2
[1] 10 14 15 11 12  9  6  7  6 11  8 12 14  7  8
</pre></li>

<li>確率質量関数は関数 <code>dpois()</code> で計算できる</li>

</ul>
</section>
</section>
<section>
<section id="slide-orga7ce431" data-background="#fef4f4">
<h2 id="orga7ce431">実習</h2>
</section>
<section id="slide-orge86bb07" data-background="#fef4f4">
<h3 id="orge86bb07">練習問題</h3>
<ul>
<li>Poisson 分布に関して以下を考察せよ．
<ul>
<li>平均と分散の計算を確認しなさい．</li>
<li>\(X,Y\) を独立な2つの確率変数とし，
それぞれ強度 \(\lambda_{1},\lambda_{2}\) の Poisson 分布に従うとする．
このとき, 和 \(X+Y\) の分布は
強度 \(\lambda_{1}+\lambda_{2}\) の Poisson 分布に従う．
これをグラフに描画して確認しなさい．</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-org873a564">
<h2 id="org873a564">幾何分布</h2>
</section>
<section id="slide-org6909f4c">
<h3 id="org6909f4c">幾何分布の確率質量関数</h3>
<ul>
<li><p>
成功確率 \(p\) の幾何分布 
\((0 < p\leq 1)\)
</p>
<blockquote>
<p>
成功するまでの失敗の回数の分布
</p>
</blockquote></li>
<li><p>
確率質量関数 
</p>
<blockquote>
<div>
\begin{equation}
  f(x)=p(1-p)^x,\quad x=0,1,\dots
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-orgbdc9c87">
<h3 id="orgbdc9c87">幾何分布の平均</h3>
<ul>
<li><p>
平均 
</p>
<blockquote>
<div>
\begin{align}
  \mathbb{E}[X]
  &=\sum_{x=0}^\infty xf(x)=\sum_{x=0}^\infty xp(1-p)^x
    =p(1-p)\sum_{x=1}^\infty x(1-p)^{x-1}\\
  &=-p(1-p)\frac{d}{dp}\sum_{x=1}^\infty(1-p)^x
    =-p(1-p)\frac{d}{dp}\frac{1-p}{p}\\
  &=-p(1-p)\cdot\Bigl(-\frac{1}{p^2}\Bigr)
    =\frac{1-p}{p}
\end{align}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-org3b114cd">
<h3 id="org3b114cd">幾何分布の分散</h3>
<ul>
<li><p>
2次モーメント
</p>
<blockquote>
<div>
\begin{align}
  \mathbb{E}[X^2]
  &=\sum_{x=0}^\infty x^2f(x)=\sum_{x=0}^\infty x(x-1)p(1-p)^x+\mathbb{E}[X]\\
  % &=p(1-p)^2\sum_{x=2}^\infty x(x-1)p(1-p)^{x-2}+\frac{1-p}{p}\\
  % &=p(1-p)^2\frac{d^2}{dp^2}\sum_{x=2}^\infty (1-p)^{x}+\frac{1-p}{p}\\
  % &=p(1-p)^2\frac{d^2}{dp^2}\frac{(1-p)^2}{p}+\frac{1-p}{p}\\
  % &=p(1-p)^2\frac{2}{p^3}+\frac{1-p}{p}
    &=2\Bigl(\frac{1-p}{p}\Bigr)^2+\frac{1-p}{p}
\end{align}

</div>
</blockquote></li>
<li><p>
分散
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{Var}(X)
  =\mathbb{E}[X^2]-\mathbb{E}[X]^2
  =\frac{1-p}{p^2}
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-org892e3d8">
<h3 id="org892e3d8">幾何分布に従う乱数</h3>
<ul>
<li>表が出る確率が \(p\) のコインを投げ続けて，
初めて表が出るまでに出た裏の回数は，
成功確率 \(p\) の幾何分布に従う</li>
<li><p>
乱数の発生は関数 <code>rgeom()</code> を用いる
</p>
<div class="org-src-container">

<pre class="src src-R">rgeom(15, prob=0.1) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#25104;&#21151;&#30906;&#29575;0.1&#12398;&#24190;&#20309;&#20998;&#24067;(15&#20491;)</span>
</pre>
</div>

<pre class="example">
[1]  7  7 34  1 34  0  0  2  0  4  7 23  1  6 27
</pre></li>

<li>確率質量関数は関数 <code>dgeom()</code> で計算できる</li>

</ul>
</section>
</section>
<section>
<section id="slide-org46e6dac">
<h2 id="org46e6dac">連続分布</h2>
<div class="outline-text-2" id="text-org46e6dac">
</div>
</section>
<section id="slide-org9d731f0">
<h3 id="org9d731f0">連続分布</h3>
<ul>
<li>連続型確率変数
<ul>
<li>取りうる値が任意の実数またはある範囲の実数<br />
取りうる値のパターンが数多いため実数で近似</li>

</ul></li>
<li>連続分布
<ul>
<li>連続型の確率変数の確率分布</li>
<li><p>
非負の値をとる実数上の関数 \(f\) の積分で表される
</p>
<blockquote>
<div>
\begin{equation}
  P(a\leq X\leq b)=\int_{a}^b f(x)dx \quad(a < b)
\end{equation}

</div>
</blockquote></li>
<li>関数 \(f\) を <b>確率密度関数</b> (または <b>密度</b>)と呼ぶ</li>

</ul></li>

</ul>
</section>
<section id="slide-org62d1b7c">
<h3 id="org62d1b7c">連続分布の平均</h3>
<ul>
<li><p>
連続型の確率変数 \(X\) の平均 <br />
</p>
<blockquote>
<p>
積分 \(\int_{-\infty}^\infty xf(x)dx\) が絶対収束するとき
\(X\) の <b>平均</b> (または <b>期待値</b>)を
</p>
<div>
\begin{equation}
  \mathbb{E}[X]=\int_{-\infty}^\infty xf(x)dx
\end{equation}

</div>
<p>
で定義する．
</p>
</blockquote></li>
<li>右辺の積分が絶対収束しない場合は
\(X\) は <b>平均をもたない</b> とする</li>

</ul>

</section>
<section>
<ul>
<li><p>
確率変数の変換 \(\varphi(X)\) の期待値
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}[\varphi(X)]=\int_{-\infty}^\infty\varphi(x)f(x)dx
\end{equation}

</div>
</blockquote></li>
<li><p>
\(p\) 次の <b>モーメント</b> (あるいは <b>積率</b> )
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}[X^p]=\int_{-\infty}^\infty x^pf(x)dx
\end{equation}

</div>
</blockquote></li>
<li>\(X\) が正整数 \(p\) 次のモーメントをもてば，
\(q\leq p\) なるすべての正整数 \(q\) 次のモーメントをもつ</li>

</ul>
</section>
<section id="slide-org26eb560">
<h3 id="org26eb560">連続分布の分散</h3>
<ul>
<li><p>
分散
</p>
<blockquote>
<div>
\begin{align}
  \mathrm{Var}(X)=& \mathbb{E}[(X-\mathbb{E}[X])^2]=\mathbb{E}[X^2]-\mathbb{E}[X]^2\\
  =&\int_{-\infty}^\infty(x-\mathbb{E}[X])^2f(x)dx
\end{align}

</div>
</blockquote></li>
<li>\(X\) が <b>2次のモーメントをもつ</b> ときのみ定義できる</li>
<li>分散の平方根 \(\sqrt{\mathrm{Var}(X)}\) を <b>標準偏差</b> と呼ぶ</li>

</ul>
</section>
</section>
<section>
<section id="slide-org470b42b">
<h2 id="org470b42b">一様分布</h2>
</section>
<section id="slide-org6b5dd5a">
<h3 id="org6b5dd5a">一様分布の確率密度関数</h3>
<ul>
<li><p>
区間 \((a,b)\) 上の一様分布
\(U(a,b)\)
</p>
<blockquote>
<p>
区間 \((a,b)\) のランダムな値の選択を表す分布
</p>
</blockquote></li>
<li><p>
確率密度関数
</p>
<blockquote>
<div>
\begin{equation}
  f(x)=
  \begin{cases}
    \frac{1}{b-a} & (a < x < b)\\
    0 & (\text{上記以外のとき})
  \end{cases}
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-orgeb8171a">
<h3 id="orgeb8171a">一様分布の平均</h3>
<ul>
<li><p>
平均
</p>
<blockquote>
<div>
\begin{align}
  \mathbb{E}[X]
  &=\int_{-\infty}^\infty xf(x)dx
    =\frac{1}{b-a}\int_a^bxdx\\
  &=\frac{b^2-a^2}{2(b-a)}
    =\frac{a+b}{2}
\end{align}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-org36cc500">
<h3 id="org36cc500">一様分布の分散</h3>
<ul>
<li><p>
2次モーメント
</p>
<blockquote>
<div>
\begin{align}
  \mathbb{E}[X^2]
  &=\int_{-\infty}^\infty x^2f(x)dx
    =\frac{1}{b-a}\int_a^bx^2dx\\
  &=\frac{b^3-a^3}{3(b-a)}
    =\frac{a^2+ab+b^2}{3}
\end{align}

</div>
</blockquote></li>
<li><p>
分散
</p>
<blockquote>
<div>
\begin{align}
  \mathrm{Var}(X)
  &=\mathbb{E}[X^2]-\mathbb{E}[X]^2
  % =\frac{a^2+ab+b^2}{3}-\frac{a^2+2ab+b^2}{4}\\
  % &=\frac{a^2-2ab+b^2}{12}
      =\frac{(b-a)^2}{12}
\end{align}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-orgfad2a99">
<h3 id="orgfad2a99">一様分布に従う乱数</h3>
<ul>
<li><p>
乱数の発生は関数 <code>runif()</code> を用いる
</p>
<div class="org-src-container">

<pre class="src src-R">runif(8) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#21306;&#38291;(0,1)&#19978;&#12398;&#19968;&#27096;&#20081;&#25968;(8&#20491;)</span>
runif(8,min=-1,max=1) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#21306;&#38291;(-1,1)&#19978;&#12398;&#19968;&#27096;&#20081;&#25968;(8&#20491;)</span>
</pre>
</div>

<pre class="example">
[1] 0.38751279 0.30222437 0.06829675 0.83015825 0.67550257 0.08425570
[7] 0.10768942 0.59537554
[1]  0.80842313  0.42843902 -0.36962290  0.66995898 -0.22299579  0.05969768
[7] -0.58449364 -0.94449989
</pre></li>

<li>確率密度関数は関数 <code>dunif()</code> で計算できる</li>

</ul>
</section>
</section>
<section>
<section id="slide-org901cb30">
<h2 id="org901cb30">正規分布</h2>
</section>
<section id="slide-orga6f17ed">
<h3 id="orga6f17ed">正規分布の確率密度関数</h3>
<ul>
<li>平均 \(\mu\) , 分散 \(\sigma^2\) の正規分布
\(N(\mu,\sigma^2)\) <br />
(\(\mu\) は実数, \(\sigma\) は正の実数)</li>
<li><p>
確率密度関数
</p>
<blockquote>
<div>
\begin{equation}
  f(x)=\frac{1}{\sqrt{2\pi\sigma^2}}\exp\Bigl(-\frac{(x-\mu)^2}{2\sigma^2}\Bigr)
\end{equation}

</div>
</blockquote></li>
<li>平均0, 分散1の正規分布を <b>標準正規分布</b> と呼ぶ</li>
<li><b>Gauss分布</b> と呼ぶこともある</li>

</ul>
</section>
<section id="slide-orgf7e621c">
<h3 id="orgf7e621c">正規分布の特徴付け</h3>
<ul>
<li>物理実験等の観測誤差の分布はしばしば正規分布でモデル化される</li>
<li>真の平均を標本平均で推定した際の推定誤差の確率分布は，
サンプル数が大きくなるに従って正規分布に近づいていく
(<b>中心極限定理</b>)</li>

</ul>

</section>
<section>
<ul>
<li>中心極限定理の特殊な形 (de Moivre-Laplaceの定理)
<ul>
<li>\(X_{1},\dotsc,X_n\) を成功確率 \(p\) のBernoulli分布に従う
独立同分布な確率変数列とする</li>
<li>\(Y=\sum_{i=1}^nX_i\) は試行回数 \(n\) , 成功確率 \(p\) の二項分布に従う</li>
<li>Bernoulli分布は平均 \(p\) , 分散 \(p(1-p)\) である</li>
<li><p>
中心極限定理により
</p>
<blockquote>
<div>
\begin{equation}
  \frac{\sum_{i=1}^nX_i-np}{\sqrt{np(1-p)}}
  =\frac{\sqrt{n}(\frac{1}{n}\sum_{i=1}^nX_i-p)}{\sqrt{p(1-p)}}
  =\frac{Y-np}{\sqrt{np(1-p)}}
\end{equation}

</div>
</blockquote>
<p>
の分布は標準正規分布で近似できる
</p></li>
<li>\(p\) が非常に小さい場合，
特に \(np\) がそれほど大きくならない程度に \(p\) が小さい場合は，
\((Y-np)/\sqrt{np(1-p)}\) の分布の正規近似よりも，
\(Y\) の分布は強度 \(np\) の Poisson 分布による近似の方が精度がよい (<b>少数の法則</b>)</li>

</ul></li>

</ul>
</section>
<section id="slide-orged2a85b">
<h3 id="orged2a85b">正規分布に従う乱数</h3>
<ul>
<li><p>
乱数の発生は関数 <code>rnorm()</code> を用いる
</p>
<div class="org-src-container">

<pre class="src src-R">rnorm(8) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#27161;&#28310;&#27491;&#35215;&#20081;&#25968;(8&#20491;)</span>
rnorm(8,mean=1,sd=2) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#24179;&#22343;1&#20998;&#25955;4=2^2&#12398;&#27491;&#35215;&#20081;&#25968;</span>
</pre>
</div>

<pre class="example">
[1] -0.71668143  0.89544359  0.48992133  0.51115494  1.88522166 -0.08382194
[7] -0.13133869 -0.11907783
[1]  5.1155229  1.1670716 -0.5715320  0.1779828  2.1809831  3.5575088
[7]  2.8494001  4.2634010
</pre></li>

<li>確率密度関数は関数 <code>dnorm()</code> で計算できる</li>

</ul>
</section>
</section>
<section>
<section id="slide-org7506bd5" data-background="#fef4f4">
<h2 id="org7506bd5">実習</h2>
</section>
<section id="slide-orgd31a308">
<h3 id="orgd31a308">数値実験の雛形(連続)</h3>
<ul>
<li>人工的に生成した乱数と理論曲線(確率密度)との比較を行う</li>
<li><p>
数値実験の雛形は以下のようになる
</p>
<div class="org-src-container">

<pre class="src src-R">mc <span style="color: #60aa00;">&lt;-</span> 10000 <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#23455;&#39443;&#22238;&#25968;&#12434;&#25351;&#23450;</span>
<span style="color: #b77fdb; font-weight: bold;">my_random</span> <span style="color: #60aa00;">&lt;-</span> <span style="color: #6c9ef8;">function</span>(){...} <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#20081;&#25968;&#29983;&#25104;&#12398;&#12503;&#12525;&#12464;&#12521;&#12512;</span>
<span style="color: #b77fdb; font-weight: bold;">my_dist</span> <span style="color: #60aa00;">&lt;-</span> <span style="color: #6c9ef8;">function</span>(){...} <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#24517;&#35201;&#12391;&#12354;&#12428;&#12400;&#29702;&#35542;&#26354;&#32218;&#12434;&#23450;&#32681;</span>
<span style="color: #808080; font-weight: bold; font-style: italic;">#</span><span style="color: #808080; font-weight: bold; font-style: italic;">'</span><span style="color: #808080; font-style: italic;"> &#12383;&#12384;&#12375;&#22810;&#12367;&#12398;&#22580;&#21512; d"&#20081;&#25968;&#21517;"&#12391;&#23450;&#32681;&#12373;&#12428;&#12390;&#12356;&#12427;&#12398;&#12391;&#12381;&#12428;&#12425;&#12434;&#29992;&#12356;&#12428;&#12400;&#12424;&#12356;</span>
my_data <span style="color: #60aa00;">&lt;-</span> replicate(mc, my_random()) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">Monte-Carlo&#23455;&#39443;</span>
tibble(x = my_data) |&gt;
  ggplot(aes(x = x)) +
  geom_histogram(aes(y = after_stat(density))) + <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#20081;&#25968;&#12398;&#20998;&#24067;(&#23494;&#24230;)&#12398;&#34920;&#31034;</span>
  geom_function(fun = my_dist) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#29702;&#35542;&#26354;&#32218;(&#30906;&#29575;&#23494;&#24230;)</span>
</pre>
</div></li>

</ul>
</section>
<section id="slide-org8e83410" data-background="#fef4f4">
<h3 id="org8e83410">練習問題</h3>
<ul>
<li>正規分布に関して以下を考察せよ．
<ul>
<li><p>
\(U_{1},U_{2}\) を \((0,1)\) 上の
一様分布に従う独立な確率変数とする．
このとき
</p>
<div>
\begin{align}
  X_{1}&=\sqrt{-2\log(U_{1})}\cos(2\pi U_{2}),\\
  X_{2}&=\sqrt{-2\log(U_{1})}\sin(2\pi U_{2})
\end{align}

</div>
<p>
とおくと，
\(X_{1},X_{2}\) は独立かつともに標準正規分布に従う．
これをグラフに描画して確認せよ. <br />
(この変換を Box-Muller 変換と呼ぶ)
</p></li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-org8908f53">
<h2 id="org8908f53">ガンマ分布</h2>
</section>
<section id="slide-org38dbcec">
<h3 id="org38dbcec">ガンマ分布の確率密度関数</h3>
<ul>
<li>パラメータ \(\nu\) , \(\alpha\) のガンマ分布 <br />
\(\Gamma(\nu,\alpha)\) または \(G(\alpha,\nu)\) 
(\(\nu > 0\) , \(\alpha > 0\))</li>
<li><p>
確率密度関数
</p>
<blockquote>
<div>
\begin{equation}
  f(x)=
  \begin{cases}
    \frac{\alpha^\nu }{\Gamma(\nu)}
    x^{\nu-1}e^{-\alpha x}&(x>0)\\
    0&(x\leq0)
  \end{cases}
\end{equation}

</div>
</blockquote>
<p>
ただしガンマ関数 \(\Gamma(\nu)\) は以下で定義される :
</p>
<blockquote>
<div>
\begin{equation}
  \Gamma(\nu)=\int_0^\infty x^{\nu-1}e^{-x}dx
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-orgff67a0d">
<h3 id="orgff67a0d">ガンマ分布の性質</h3>
<ul>
<li>\(\nu,\alpha\) はそれぞれ <b>形状パラメータ</b> ， <b>レート</b> と呼ばれることがある</li>
<li>平均は \(\nu/\alpha\) , 分散は \(\nu/\alpha^2\) で与えられる</li>
<li>ガンマ分布は応用上重要な確率分布を含む
<ul>
<li>指数分布</li>
<li>\(\chi^2\) 分布</li>

</ul></li>

</ul>
</section>
<section id="slide-orga21e4ea">
<h3 id="orga21e4ea">ガンマ分布に従う乱数</h3>
<ul>
<li><p>
乱数の発生は <code>rgamma()</code> を用いる
</p>
<div class="org-src-container">

<pre class="src src-R">rgamma(8, shape=3, rate=1) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#12460;&#12531;&#12510;&#20998;&#24067;(8&#20491;)</span>
rgamma(8, shape=1, rate=3) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#30064;&#12394;&#12427;&#12497;&#12521;&#12513;&#12479;&#12398;&#12460;&#12531;&#12510;&#20998;&#24067;(8&#20491;)</span>
</pre>
</div>

<pre class="example">
[1] 3.4023501 3.6306335 3.6469440 0.5808054 2.7037517 3.3022527 2.0585425
[8] 3.1122727
[1] 0.303475669 0.447978086 0.319710430 0.185434338 0.043713723 0.078426957
[7] 0.704110546 0.002177825
</pre>


<ul>
<li>確率密度関数は <code>dgamma()</code> で計算できる</li>

</ul></li>

</ul>
</section>
<section id="slide-org9a9d13a">
<h3 id="org9a9d13a">指数分布の確率密度関数</h3>
<ul>
<li><p>
パラメタ \(\lambda\) の指数分布
\(\mathrm{Exp}(\lambda)\) (\(\lambda > 0\))
</p>
<blockquote>
<div>
\begin{equation}
  f(x)=\Gamma(1,\lambda)=
  \begin{cases}
    \lambda e^{-\lambda x}&(x>0)\\
    0&(x\leq0)
  \end{cases}
\end{equation}

</div>
</blockquote></li>
<li>\(\lambda\) は <b>レート</b> と呼ばれることがある</li>
<li>平均，分散はそれぞれ \(\lambda^{-1}\) , \(\lambda^{-2}\) で与えられる</li>

</ul>
</section>
<section id="slide-orge6b53a9">
<h3 id="orge6b53a9">指数分布に従う乱数</h3>
<ul>
<li><p>
乱数の発生は関数 <code>rexp()</code> を用いる
</p>
<div class="org-src-container">

<pre class="src src-R">rexp(8) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#12524;&#12540;&#12488;1&#12398;&#25351;&#25968;&#20998;&#24067;(8&#20491;)</span>
rexp(8, rate=0.5) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#12524;&#12540;&#12488;0.5&#12398;&#25351;&#25968;&#20998;&#24067;(8&#20491;)</span>
</pre>
</div>

<pre class="example">
[1] 2.9103513 1.2560190 2.7683087 1.2797876 1.0965795 1.0216147 0.5029382
[8] 0.6295330
[1] 10.8914432  2.4472805  3.3723084  0.3095520  5.1354296  1.4551304
[7]  0.8877565  2.9132515
</pre></li>

</ul>
</section>
<section id="slide-org814e3c2">
<h3 id="org814e3c2">\(\chi^2\) 分布の確率密度関数</h3>
<ul>
<li><p>
自由度 \(k\) の \(\chi^2\) 分布 
\(\chi^2(k)\) (\(k > 0\))
</p>
<blockquote>
<div>
\begin{equation}
  f(x)=\Gamma(k/2,1/2)=
  \begin{cases}
    \frac{1}{2^{k/2}\Gamma(k/2)}
    x^{k/2-1}e^{-x/2}&(x>0)\\
    0&(x\leq0)
  \end{cases}
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-org898ff82">
<h3 id="org898ff82">\(\chi^2\) 分布の平均と分散</h3>
<ul>
<li><p>
平均
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}[X]
  =k
\end{equation}

</div>
</blockquote></li>
<li><p>
分散
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{Var}(X)
  =2k
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-orgecb7802">
<h3 id="orgecb7802">\(\chi^2\) 分布の特徴付け</h3>
<ul>
<li>\(\chi^2\) は <b>カイ二乗</b> と読む</li>
<li>標準正規分布に従う \(k\) 個の独立な確率変数の
二乗和は自由度 \(k\) の \(\chi^2\) 分布に従う</li>

</ul>
</section>
<section id="slide-org749e1d4">
<h3 id="org749e1d4">\(\chi^2\) 分布に従う乱数</h3>
<ul>
<li><p>
乱数の発生は関数 <code>rchisq()</code> を用いる
</p>
<div class="org-src-container">

<pre class="src src-R">rchisq(8, df=1) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#33258;&#30001;&#24230;1&#12398;&#12459;&#12452;&#20108;&#20055;&#20998;&#24067;(8&#20491;)</span>
rchisq(8, df=4) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#33258;&#30001;&#24230;4&#12398;&#12459;&#12452;&#20108;&#20055;&#20998;&#24067;(8&#20491;)</span>
</pre>
</div>

<pre class="example">
[1] 1.5492633 1.0311878 0.5730046 0.3210647 3.4826029 0.3867041 1.4727438
[8] 1.8102124
[1]  4.362031  2.610825  1.600799  2.257753  6.307876  4.290416 10.434826
[8]  5.864355
</pre></li>

<li>確率密度関数は関数 <code>dchisq()</code> で計算できる</li>

</ul>
</section>
</section>
<section>
<section id="slide-org5780d44" data-background="#fef4f4">
<h2 id="org5780d44">実習</h2>
</section>
<section id="slide-orgfa94d9f" data-background="#fef4f4">
<h3 id="orgfa94d9f">練習問題</h3>
<ul>
<li>\(\chi^2\) 分布に関して以下を考察せよ．
<ul>
<li>標準正規分布に従う \(k\) 個の独立な確率変数の
二乗和は自由度 \(k\) の \(\chi^2\) 分布に従うことを
確認しなさい．</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-org335c2e0">
<h2 id="org335c2e0">\(t\) 分布</h2>
</section>
<section id="slide-orge4dd0cb">
<h3 id="orge4dd0cb">\(t\) 分布の確率密度関数</h3>
<ul>
<li>自由度 \(\nu\) の(Studentの) \(t\) 分布
\(t(\nu)\) (\(\nu > 0\))</li>
<li><p>
確率密度関数
</p>
<blockquote>
<div>
\begin{equation}
  f(x)=
  \frac{1}{\sqrt{\pi \nu}}
  \frac{\Gamma((\nu+1)/2)}{\Gamma(\nu/2)}
  \left(1+\frac{x^2}{\nu}\right)^{-(\nu+1)/2}
\end{equation}

</div>
</blockquote>
<ul>
<li><b>Student</b> は \(t\) 分布を導入した統計学者Gossetのペンネーム</li>

</ul></li>

</ul>
</section>
<section id="slide-orga2fd262">
<h3 id="orga2fd262">\(t\) 分布の平均と分散</h3>
<ul>
<li><p>
平均
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}[X]
  =0 \quad\text{(ただし\(\nu>1\))}
\end{equation}

</div>
</blockquote></li>
<li><p>
分散
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{Var}(X)
  =\frac{\nu}{\nu-2} \quad\text{(ただし \(\nu>2\))}
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-org1d6e387">
<h3 id="org1d6e387">\(t\) 分布の特徴付け</h3>
<ul>
<li><p>
\(Z\) を標準正規分布に従う確率変数，
\(Y\) を自由度 \(k\) の \(\chi^2\) 分布に従う確率変数とし，
\(Z,Y\) は独立であるとする．
このとき確率変数
</p>
<blockquote>
<div>
\begin{equation}
  \frac{Z}{\sqrt{Y/k}}
\end{equation}

</div>
</blockquote>
<p>
は自由度 \(k\) の \(t\) 分布に従う
</p></li>

</ul>
</section>
<section id="slide-org6db2831">
<h3 id="org6db2831">\(t\) 分布に従う乱数</h3>
<ul>
<li><p>
乱数の発生は関数 <code>rt()</code> を用いる
</p>
<div class="org-src-container">

<pre class="src src-R">rt(8, df=1) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#33258;&#30001;&#24230;1&#12398;t&#20998;&#24067;(8&#20491;)</span>
rt(8, df=4) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#33258;&#30001;&#24230;4&#12398;t&#20998;&#24067;(8&#20491;)</span>
</pre>
</div>

<pre class="example">
[1] -2.12345176  0.46531542 -0.97734393 -0.25526606 -6.80959537 -0.09021367
[7] -0.07124738 -0.46400280
[1] -0.1815505  1.4009682 -0.5463940  1.0056205 -0.2851987 -0.3052288
[7] -0.3566465 -1.9048051
</pre>


<ul>
<li>確率密度関数は関数 <code>dt()</code> で計算できる</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-orgaf4bb57" data-background="#fef4f4">
<h2 id="orgaf4bb57">実習</h2>
</section>
<section id="slide-org3bad482" data-background="#fef4f4">
<h3 id="org3bad482">練習問題</h3>
<ul>
<li>\(t\) 分布に関して以下を考察せよ．
<ul>
<li><p>
\(Z\) を標準正規分布に従う確率変数，
\(Y\) を自由度 \(k\) の \(\chi^2\) 分布に従う確率変数とし，
\(Z,Y\) は独立であるとする．
このとき確率変数
</p>
<blockquote>
<div>
\begin{equation}
  \frac{Z}{\sqrt{Y/k}}
\end{equation}

</div>
</blockquote>
<p>
は自由度 \(k\) の \(t\) 分布に従うことを確認しなさい．
</p></li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-org3fc7c68">
<h2 id="org3fc7c68">\(F\) 分布</h2>
</section>
<section id="slide-org5df8d87">
<h3 id="org5df8d87">\(F\) 分布の確率密度関数</h3>
<ul>
<li>自由度 \(\nu_{1},\nu_{2}\) の \(F\) 分布
\(F(\nu_{1},\nu_{2})\) (\(\nu_{1} > 0, \nu_{2} > 0\))</li>
<li><p>
確率密度関数
</p>
<blockquote>
<div>
\begin{equation}
  f(x)=
  \begin{cases}
    \frac{(\nu_{1}/\nu_{2})^{\nu_{1}/2}}{B(\nu_{1}/2,\nu_{2}/2)}
    \frac{x^{\nu_{1}/2-1}}{(1+\nu_{1}x/\nu_{2})^{(\nu_{1}+\nu_{2})/2}}&(x>0)\\
    0&(x\leq0)
  \end{cases}
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-org1ce98c5">
<h3 id="org1ce98c5">\(F\) 分布の平均と分散</h3>
<ul>
<li><p>
平均
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}[X]
  =\frac{\nu_{2}}{\nu_{2}-2} \quad \text{(ただし\(\nu_{2}>2\))}
\end{equation}

</div>
</blockquote></li>
<li><p>
分散
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{Var}(X)
  =\frac{2\nu_{2}^2(\nu_{1}+\nu_{2}-2)}{\nu_{1}(\nu_{2}-2)^2(\nu_{2}-4)}
  \quad\text{(ただし\(\nu_{2}>4\))}
\end{equation}

</div>
</blockquote></li>

</ul>
</section>
<section id="slide-org797c40a">
<h3 id="org797c40a">\(F\) 分布の特徴付け</h3>
<ul>
<li><p>
\(Y_{1},Y_{2}\) をそれぞれ自由度 \(k_{1},k_{2}\) の \(\chi^2\) 分布に従う独立な
確率変数とする．このとき, 確率変数
</p>
<blockquote>
<div>
\begin{equation}
  \frac{Y_{1}/k_{1}}{Y_{2}/k_{2}}
\end{equation}

</div>
</blockquote>
<p>
は自由度 \(k_{1},k_{2}\) の \(F\) 分布に従う
</p></li>

</ul>
</section>
<section id="slide-orgd08d444">
<h3 id="orgd08d444">\(F\) 分布に従う乱数</h3>
<ul>
<li><p>
乱数の発生は関数 <code>rf()</code> を用いる
</p>
<div class="org-src-container">

<pre class="src src-R">rf(10, df1=4, df2=7) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#33258;&#30001;&#24230;4,7&#12398;F&#20998;&#24067;(10&#20491;)</span>
rf(10, df1=7, df2=12) <span style="color: #808080; font-style: italic;"># </span><span style="color: #808080; font-style: italic;">&#33258;&#30001;&#24230;7,12&#12398;F&#20998;&#24067;(10&#20491;)</span>
</pre>
</div>

<pre class="example">
 [1] 1.4744266 1.1737716 5.0728849 0.1858272 4.4003451 0.1615950 4.2237953
 [8] 0.2048677 0.8943012 1.9694392
[1] 0.8065490 1.1430727 0.9565232 0.7488964 0.6905875 0.6047086 0.8542193
 [8] 1.8349279 0.4946922 0.3944779
</pre>


<ul>
<li>確率密度関数は関数 <code>df()</code> で計算できる</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-orga7359cd" data-background="#fef4f4">
<h2 id="orga7359cd">実習</h2>
</section>
<section id="slide-orgdaa3fdd" data-background="#fef4f4">
<h3 id="orgdaa3fdd">練習問題</h3>
<ul>
<li>\(F\) 分布に関して以下を考察せよ．
<ul>
<li><p>
\(Y_{1},Y_{2}\) をそれぞれ
自由度 \(k_{1},k_{2}\) の \(\chi^2\) 分布に従う
独立な確率変数とする．
このとき, 確率変数
</p>
<div>
\begin{equation}
  \frac{Y_{1}/k_{1}}{Y_{2}/k_{2}}
\end{equation}

</div>
<p>
は自由度 \(k_{1},k_{2}\) の \(F\) 分布に従うことを確認しなさい．
</p></li>

</ul></li>

</ul>
</section>
<section id="slide-org50bd383">
<h3 id="org50bd383">参考</h3>
<ul>
<li>練習用に興味のあるデータを収集しておくと良い
<ul>
<li>データ収集・整理の方法の復習になる</li>
<li>統計量の計算やモデルのあてはめの練習になる</li>

</ul></li>
<li>参考となるサイト
<ul>
<li>e-Stat (総務省) <a href="https://www.e-stat.go.jp">https://www.e-stat.go.jp</a></li>
<li>気象庁 <a href="http://www.jma.go.jp/jma/index.html">http://www.jma.go.jp/jma/index.html</a></li>
<li>World Bank <a href="https://data.worldbank.org">https://data.worldbank.org</a></li>
<li>Yahoo! finance <a href="https://finance.yahoo.com">https://finance.yahoo.com</a></li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-org0fed868">
<h2 id="org0fed868">次回の予定</h2>
<ul>
<li>基本的な記述統計量</li>
<li>&ldquo;モーメント&rdquo;に基づく記述統計量
<ul>
<li>歪度と尖度</li>
<li>相関と共分散</li>

</ul></li>
<li>&ldquo;順序&rdquo;に基づく統計量</li>
<li>&ldquo;頻度&rdquo;に基づく統計量</li>

</ul>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/menu/menu.js"></script>
<script src="./reveal.js/plugin/spotlight/spotlight.js"></script>
<script src="./reveal.js/plugin/chalkboard/plugin.js"></script>
<script src="./reveal.js/dist/theme/hidelinks.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,
overview: true,

transition: 'fade',
transitionSpeed: 'default',
showNotes: window.location.search.match( /print-pdf/gi ) ? 'separate-page' : false,
spotlight: { size: 80, initialPresentationMode: false, }, keyboard: { 81: function() { RevealSpotlight.toggleSpotlight()}, 87: function() { RevealSpotlight.togglePresentationMode();}, },

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealMenu, RevealSpotlight, RevealChalkboard ],

// Optional libraries used to extend reveal.js
dependencies: [
]

});
</script>
</body>
</html>
